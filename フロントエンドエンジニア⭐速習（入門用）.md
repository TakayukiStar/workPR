# ğŸš€ 7æ—¥é–“ãƒã‚¹ã‚¿ãƒ¼ãƒ—ãƒ­ã‚°ãƒ©ãƒ 
## AIç”»åƒãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒªã‚’ä¸€äººã§ä½œã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã¾ã§ã®æœ€çŸ­ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

---

## ğŸ“‹ äº‹å‰æº–å‚™ï¼ˆ30åˆ†ï¼‰

### å¿…è¦ãªãƒ„ãƒ¼ãƒ«

```bash
# Python 3.8ä»¥ä¸ŠãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
python --version

# VSCodeã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆæ¨å¥¨ï¼‰
# https://code.visualstudio.com/

# VSCodeæ‹¡å¼µæ©Ÿèƒ½ï¼ˆæ¨å¥¨ï¼‰
# - Python
# - Pylance
# - Live Server
```

### ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼æ§‹æˆã‚’ä½œæˆ

```bash
mkdir flask-learning
cd flask-learning
```

---

## ğŸ“… Day 1: FlaskåŸºç¤ï¼ˆ2æ™‚é–“ï¼‰

### ğŸ¯ ç›®æ¨™
- Flaskã®åŸºæœ¬ã‚’ç†è§£
- ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç¿’å¾—
- ã‚·ãƒ³ãƒ—ãƒ«ãªWebã‚¢ãƒ—ãƒªã‚’ä½œæˆ

### ã‚¹ãƒ†ãƒƒãƒ—1.1: Hello Worldï¼ˆ15åˆ†ï¼‰

**app.py**
```python
from flask import Flask

app = Flask(__name__)

@app.route('/')
def hello():
    return "Hello, Flask!"

if __name__ == '__main__':
    app.run(debug=True)
```

```bash
pip install flask
python app.py
# ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:5000 ã‚’é–‹ã
```

**ç†è§£ã™ã¹ããƒã‚¤ãƒ³ãƒˆ:**
- `@app.route('/')` = URLãƒ‘ã‚¹ã‚’æŒ‡å®š
- `def hello()` = ãã®URLã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã¨ãã®å‡¦ç†
- `debug=True` = ã‚³ãƒ¼ãƒ‰å¤‰æ›´ã‚’è‡ªå‹•åæ˜ 

---

### ã‚¹ãƒ†ãƒƒãƒ—1.2: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ä½¿ç”¨ï¼ˆ30åˆ†ï¼‰

**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ**
```
flask-learning/
â”œâ”€â”€ app.py
â””â”€â”€ templates/
    â””â”€â”€ index.html
```

**app.py**
```python
from flask import Flask, render_template

app = Flask(__name__)

@app.route('/')
def index():
    message = "Flaskã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"
    return render_template('index.html', message=message)

if __name__ == '__main__':
    app.run(debug=True)
```

**templates/index.html**
```html
<!DOCTYPE html>
<html>
<head>
    <title>Flaskå­¦ç¿’</title>
</head>
<body>
    <h1>{{ message }}</h1>
    <p>ã“ã‚Œã¯Flaskã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ã™</p>
</body>
</html>
```

**ç†è§£ã™ã¹ããƒã‚¤ãƒ³ãƒˆ:**
- `render_template()` = HTMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿”ã™
- `{{ message }}` = Pythonã®å¤‰æ•°ã‚’HTMLã«åŸ‹ã‚è¾¼ã‚€
- `templates/` ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã¯å¿…é ˆ

---

### ã‚¹ãƒ†ãƒƒãƒ—1.3: POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å‡¦ç†ï¼ˆ45åˆ†ï¼‰

**app.py**
```python
from flask import Flask, render_template, request

app = Flask(__name__)

@app.route('/')
def index():
    return render_template('form.html')

@app.route('/submit', methods=['POST'])
def submit():
    name = request.form.get('name')
    message = request.form.get('message')
    return f"ã“ã‚“ã«ã¡ã¯ã€{name}ã•ã‚“ï¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: {message}"

if __name__ == '__main__':
    app.run(debug=True)
```

**templates/form.html**
```html
<!DOCTYPE html>
<html>
<head>
    <title>ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡</title>
</head>
<body>
    <h1>ãƒ•ã‚©ãƒ¼ãƒ ã‚’é€ä¿¡</h1>
    <form action="/submit" method="POST">
        <input type="text" name="name" placeholder="åå‰">
        <textarea name="message" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"></textarea>
        <button type="submit">é€ä¿¡</button>
    </form>
</body>
</html>
```

**ç†è§£ã™ã¹ããƒã‚¤ãƒ³ãƒˆ:**
- `methods=['POST']` = POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ä»˜ã‘ã‚‹
- `request.form.get()` = ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
- `action="/submit"` = é€ä¿¡å…ˆã®URL

---

### ã‚¹ãƒ†ãƒƒãƒ—1.4: JSONãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆ30åˆ†ï¼‰

**app.py**
```python
from flask import Flask, jsonify, request

app = Flask(__name__)

@app.route('/api/hello', methods=['GET'])
def api_hello():
    return jsonify({
        'message': 'Hello, API!',
        'status': 'success'
    })

@app.route('/api/echo', methods=['POST'])
def api_echo():
    data = request.json
    return jsonify({
        'received': data,
        'status': 'success'
    })

if __name__ == '__main__':
    app.run(debug=True)
```

**ãƒ†ã‚¹ãƒˆï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ï¼‰**
```javascript
// GET ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
fetch('/api/hello')
    .then(res => res.json())
    .then(data => console.log(data));

// POST ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
fetch('/api/echo', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({message: 'ãƒ†ã‚¹ãƒˆ'})
})
    .then(res => res.json())
    .then(data => console.log(data));
```

**ç†è§£ã™ã¹ããƒã‚¤ãƒ³ãƒˆ:**
- `jsonify()` = Pythonã®dictã‚’JSONã«å¤‰æ›
- `request.json` = JSONãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
- APIã¯HTMLã§ã¯ãªãJSONã‚’è¿”ã™

---

### ğŸ“ Day 1 ãƒãƒ£ãƒ¬ãƒ³ã‚¸

ä»¥ä¸‹ã®ã‚¢ãƒ—ãƒªã‚’ä½œæˆã—ã¦ã¿ã‚ˆã†ï¼š

**ä»•æ§˜:**
1. ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã§ãã‚‹ãƒ•ã‚©ãƒ¼ãƒ 
2. é€ä¿¡ã™ã‚‹ã¨æ–‡å­—æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã—ã¦è¡¨ç¤º
3. `/api/count` ã§JSONå½¢å¼ã§ã‚‚è¿”ã™

**ãƒ’ãƒ³ãƒˆ:**
```python
text = request.form.get('text')
count = len(text)
```

---

## ğŸ“… Day 2: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰åŸºç¤ï¼ˆ2.5æ™‚é–“ï¼‰

### ğŸ¯ ç›®æ¨™
- HTML/CSS/JavaScriptã®é€£æºã‚’ç†è§£
- Fetch APIã§ã‚µãƒ¼ãƒãƒ¼ã¨é€šä¿¡
- å‹•çš„ã«ãƒšãƒ¼ã‚¸ã‚’æ›´æ–°

### ã‚¹ãƒ†ãƒƒãƒ—2.1: åŸºæœ¬æ§‹é€ ï¼ˆ30åˆ†ï¼‰

**templates/chat.html**
```html
<!DOCTYPE html>
<html>
<head>
    <title>ãƒãƒ£ãƒƒãƒˆç·´ç¿’</title>
    <style>
        body {
            font-family: sans-serif;
            max-width: 600px;
            margin: 50px auto;
        }
        #messages {
            border: 1px solid #ccc;
            height: 300px;
            overflow-y: auto;
            padding: 10px;
            margin-bottom: 10px;
        }
        .message {
            padding: 5px;
            margin: 5px 0;
            border-radius: 5px;
        }
        .user {
            background: #e3f2fd;
            text-align: right;
        }
        .bot {
            background: #f5f5f5;
        }
        #input-area {
            display: flex;
            gap: 10px;
        }
        #input-area input {
            flex: 1;
            padding: 10px;
        }
        #input-area button {
            padding: 10px 20px;
        }
    </style>
</head>
<body>
    <h1>ãƒãƒ£ãƒƒãƒˆç·´ç¿’</h1>
    <div id="messages"></div>
    <div id="input-area">
        <input type="text" id="messageInput" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›...">
        <button onclick="sendMessage()">é€ä¿¡</button>
    </div>

    <script>
        function addMessage(text, type) {
            const messagesDiv = document.getElementById('messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message ' + type;
            messageDiv.textContent = text;
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value;
            
            if (!message) return;
            
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
            addMessage(message, 'user');
            input.value = '';
            
            // ãƒœãƒƒãƒˆã®è¿”ä¿¡ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
            setTimeout(() => {
                addMessage('ã‚ãªãŸã¯ã€Œ' + message + 'ã€ã¨è¨€ã„ã¾ã—ãŸ', 'bot');
            }, 500);
        }

        // Enterã‚­ãƒ¼ã§é€ä¿¡
        document.getElementById('messageInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });
    </script>
</body>
</html>
```

**app.py**
```python
from flask import Flask, render_template

app = Flask(__name__)

@app.route('/')
def chat():
    return render_template('chat.html')

if __name__ == '__main__':
    app.run(debug=True)
```

**ç†è§£ã™ã¹ããƒã‚¤ãƒ³ãƒˆ:**
- `document.getElementById()` = HTMLè¦ç´ ã‚’å–å¾—
- `createElement()` = æ–°ã—ã„è¦ç´ ã‚’ä½œæˆ
- `appendChild()` = è¦ç´ ã‚’è¿½åŠ 
- `addEventListener()` = ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç›£è¦–

---

### ã‚¹ãƒ†ãƒƒãƒ—2.2: Fetch APIã§ã‚µãƒ¼ãƒãƒ¼ã¨é€šä¿¡ï¼ˆ1æ™‚é–“ï¼‰

**app.py**
```python
from flask import Flask, render_template, jsonify, request

app = Flask(__name__)

@app.route('/')
def chat():
    return render_template('chat_api.html')

@app.route('/api/chat', methods=['POST'])
def api_chat():
    data = request.json
    user_message = data.get('message', '')
    
    # ã‚·ãƒ³ãƒ—ãƒ«ãªãƒœãƒƒãƒˆãƒ­ã‚¸ãƒƒã‚¯
    if 'ã“ã‚“ã«ã¡ã¯' in user_message:
        response = 'ã“ã‚“ã«ã¡ã¯ï¼å…ƒæ°—ã§ã™ã‹ï¼Ÿ'
    elif 'å¤©æ°—' in user_message:
        response = 'ä»Šæ—¥ã¯è‰¯ã„å¤©æ°—ã§ã™ã­ï¼'
    else:
        response = f'ã€Œ{user_message}ã€ã¨è¨€ã„ã¾ã—ãŸã­ã€‚'
    
    return jsonify({
        'response': response,
        'status': 'success'
    })

if __name__ == '__main__':
    app.run(debug=True)
```

**templates/chat_api.html**
```html
<!DOCTYPE html>
<html>
<head>
    <title>APIãƒãƒ£ãƒƒãƒˆ</title>
    <style>
        /* å‰ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ */
    </style>
</head>
<body>
    <h1>APIãƒãƒ£ãƒƒãƒˆ</h1>
    <div id="messages"></div>
    <div id="input-area">
        <input type="text" id="messageInput" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›...">
        <button onclick="sendMessage()">é€ä¿¡</button>
    </div>

    <script>
        function addMessage(text, type) {
            const messagesDiv = document.getElementById('messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message ' + type;
            messageDiv.textContent = text;
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value;
            
            if (!message) return;
            
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
            addMessage(message, 'user');
            input.value = '';
            
            try {
                // ã‚µãƒ¼ãƒãƒ¼ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({message: message})
                });
                
                const data = await response.json();
                
                // ãƒœãƒƒãƒˆã®è¿”ä¿¡ã‚’è¡¨ç¤º
                addMessage(data.response, 'bot');
            } catch (error) {
                console.error('Error:', error);
                addMessage('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ', 'bot');
            }
        }

        document.getElementById('messageInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });
    </script>
</body>
</html>
```

**ç†è§£ã™ã¹ããƒã‚¤ãƒ³ãƒˆ:**
- `async/await` = éåŒæœŸå‡¦ç†ã‚’åŒæœŸçš„ã«æ›¸ã
- `fetch()` = ã‚µãƒ¼ãƒãƒ¼ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹
- `JSON.stringify()` = JavaScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’JSONã«å¤‰æ›
- `try/catch` = ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

---

### ã‚¹ãƒ†ãƒƒãƒ—2.3: ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºï¼ˆ30åˆ†ï¼‰

**chat_api.html ã«è¿½åŠ **
```html
<style>
    .loading {
        color: #999;
        font-style: italic;
    }
</style>

<script>
    function showLoading() {
        const messagesDiv = document.getElementById('messages');
        const loadingDiv = document.createElement('div');
        loadingDiv.className = 'message bot loading';
        loadingDiv.id = 'loading';
        loadingDiv.textContent = 'å…¥åŠ›ä¸­...';
        messagesDiv.appendChild(loadingDiv);
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    function hideLoading() {
        const loadingDiv = document.getElementById('loading');
        if (loadingDiv) {
            loadingDiv.remove();
        }
    }

    async function sendMessage() {
        const input = document.getElementById('messageInput');
        const message = input.value;
        
        if (!message) return;
        
        addMessage(message, 'user');
        input.value = '';
        
        showLoading();  // â† è¿½åŠ 
        
        try {
            const response = await fetch('/api/chat', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({message: message})
            });
            
            const data = await response.json();
            
            hideLoading();  // â† è¿½åŠ 
            addMessage(data.response, 'bot');
        } catch (error) {
            hideLoading();  // â† è¿½åŠ 
            console.error('Error:', error);
            addMessage('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ', 'bot');
        }
    }
</script>
```

---

### ğŸ“ Day 2 ãƒãƒ£ãƒ¬ãƒ³ã‚¸

ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ã¿ã‚ˆã†ï¼š

1. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹ãƒœã‚¿ãƒ³
2. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€ä¿¡æ™‚åˆ»ã‚’è¡¨ç¤º
3. é€ä¿¡ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–ï¼ˆé€ä¿¡ä¸­ã¯æŠ¼ã›ãªã„ã‚ˆã†ã«ï¼‰

---

## ğŸ“… Day 3: Gemini APIé€£æºï¼ˆ2æ™‚é–“ï¼‰

### ğŸ¯ ç›®æ¨™
- å¤–éƒ¨APIã®ä½¿ã„æ–¹ã‚’ç†è§£
- Gemini APIã§ä¼šè©±ã‚’ç”Ÿæˆ
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’å®Ÿè£…

### ã‚¹ãƒ†ãƒƒãƒ—3.1: APIã‚­ãƒ¼ã®å–å¾—ï¼ˆ10åˆ†ï¼‰

1. [Google AI Studio](https://makersuite.google.com/app/apikey) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€ŒCreate API Keyã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. APIã‚­ãƒ¼ã‚’ã‚³ãƒ”ãƒ¼

**.env ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ**
```bash
GOOGLE_AI_API_KEY=ã‚ãªãŸã®APIã‚­ãƒ¼
```

**ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**
```bash
pip install google-genai python-dotenv
```

---

### ã‚¹ãƒ†ãƒƒãƒ—3.2: Gemini APIã®åŸºæœ¬ï¼ˆ30åˆ†ï¼‰

**test_gemini.py**
```python
import os
from dotenv import load_dotenv
from google import genai
from google.genai import types

# ç’°å¢ƒå¤‰æ•°ã‚’èª­ã¿è¾¼ã¿
load_dotenv()
API_KEY = os.getenv("GOOGLE_AI_API_KEY")

# ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–
client = genai.Client(api_key=API_KEY)

# ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ
response = client.models.generate_content(
    model="gemini-2.0-flash-exp",
    contents="ã“ã‚“ã«ã¡ã¯ï¼",
    config=types.GenerateContentConfig(
        temperature=0.7,
        max_output_tokens=1024,
    )
)

print(response.text)
```

```bash
python test_gemini.py
```

**ç†è§£ã™ã¹ããƒã‚¤ãƒ³ãƒˆ:**
- `load_dotenv()` = .envãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ç’°å¢ƒå¤‰æ•°ã‚’èª­ã¿è¾¼ã¿
- `os.getenv()` = ç’°å¢ƒå¤‰æ•°ã‚’å–å¾—
- `temperature` = å¿œç­”ã®ãƒ©ãƒ³ãƒ€ãƒ æ€§ï¼ˆ0-1ï¼‰
- `max_output_tokens` = æœ€å¤§å¿œç­”é•·

---

### ã‚¹ãƒ†ãƒƒãƒ—3.3: Flaskã‚¢ãƒ—ãƒªã«Geminiã‚’çµ±åˆï¼ˆ1æ™‚é–“ï¼‰

**app.py**
```python
import os
from flask import Flask, render_template, jsonify, request
from dotenv import load_dotenv
from google import genai
from google.genai import types

load_dotenv()
API_KEY = os.getenv("GOOGLE_AI_API_KEY")
client = genai.Client(api_key=API_KEY)

app = Flask(__name__)

@app.route('/')
def chat():
    return render_template('gemini_chat.html')

@app.route('/api/chat', methods=['POST'])
def api_chat():
    try:
        data = request.json
        user_message = data.get('message', '')
        
        # Gemini APIã§å¿œç­”ç”Ÿæˆ
        response = client.models.generate_content(
            model="gemini-2.0-flash-exp",
            contents=user_message,
            config=types.GenerateContentConfig(
                temperature=0.7,
                max_output_tokens=1024,
            )
        )
        
        return jsonify({
            'response': response.text,
            'status': 'success'
        })
    
    except Exception as e:
        print(f"Error: {e}")
        return jsonify({
            'response': 'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
            'status': 'error'
        }), 500

if __name__ == '__main__':
    app.run(debug=True)
```

**templates/gemini_chat.html**
```html
<!-- chat_api.html ã¨åŒã˜ -->
```

---

### ã‚¹ãƒ†ãƒƒãƒ—3.4: ä¼šè©±å±¥æ­´ã®ä¿æŒï¼ˆ30åˆ†ï¼‰

**app.pyï¼ˆæ”¹è‰¯ç‰ˆï¼‰**
```python
import os
from flask import Flask, render_template, jsonify, request, session
from dotenv import load_dotenv
from google import genai
from google.genai import types

load_dotenv()
API_KEY = os.getenv("GOOGLE_AI_API_KEY")
client = genai.Client(api_key=API_KEY)

app = Flask(__name__)
app.secret_key = 'your-secret-key'  # æœ¬ç•ªç’°å¢ƒã§ã¯å®‰å…¨ãªéµã‚’ä½¿ç”¨

# ãƒ¡ãƒ¢ãƒªå†…ã§ä¼šè©±å±¥æ­´ã‚’ä¿æŒ
conversations = {}

@app.route('/')
def chat():
    return render_template('gemini_chat.html')

@app.route('/api/chat', methods=['POST'])
def api_chat():
    try:
        data = request.json
        user_message = data.get('message', '')
        session_id = data.get('session_id', 'default')
        
        # ä¼šè©±å±¥æ­´ã‚’å–å¾—ã¾ãŸã¯ä½œæˆ
        if session_id not in conversations:
            conversations[session_id] = []
        
        # ä¼šè©±å±¥æ­´ã«è¿½åŠ 
        conversations[session_id].append(user_message)
        
        # å±¥æ­´ã‚’å«ã‚ã¦ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½œæˆ
        full_prompt = "\n".join(conversations[session_id])
        
        # Gemini APIã§å¿œç­”ç”Ÿæˆ
        response = client.models.generate_content(
            model="gemini-2.0-flash-exp",
            contents=full_prompt,
            config=types.GenerateContentConfig(
                temperature=0.7,
                max_output_tokens=1024,
            )
        )
        
        # å¿œç­”ã‚‚å±¥æ­´ã«è¿½åŠ 
        conversations[session_id].append(response.text)
        
        return jsonify({
            'response': response.text,
            'status': 'success'
        })
    
    except Exception as e:
        print(f"Error: {e}")
        return jsonify({
            'response': 'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
            'status': 'error'
        }), 500

if __name__ == '__main__':
    app.run(debug=True)
```

---

### ğŸ“ Day 3 ãƒãƒ£ãƒ¬ãƒ³ã‚¸

ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ã¿ã‚ˆã†ï¼š

1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ¸©åº¦ï¼ˆtemperatureï¼‰ã‚’èª¿æ•´ã§ãã‚‹ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
2. ä¼šè©±å±¥æ­´ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹æ©Ÿèƒ½
3. ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ã«è¡¨ç¤º

---

## ğŸ“… Day 4: ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆ2.5æ™‚é–“ï¼‰

### ğŸ¯ ç›®æ¨™
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã®ä»•çµ„ã¿ã‚’ç†è§£
- ç”»åƒã‚’ä¿å­˜ãƒ»è¡¨ç¤º
- ç”»åƒã¨ãƒ†ã‚­ã‚¹ãƒˆã‚’ä¸€ç·’ã«é€ä¿¡

### ã‚¹ãƒ†ãƒƒãƒ—4.1: åŸºæœ¬çš„ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆ45åˆ†ï¼‰

**app.py**
```python
from flask import Flask, render_template, request, jsonify
from werkzeug.utils import secure_filename
import os

app = Flask(__name__)
app.config['UPLOAD_FOLDER'] = 'uploads'
app.config['MAX_CONTENT_LENGTH'] = 16 * 1024 * 1024  # 16MBåˆ¶é™

ALLOWED_EXTENSIONS = {'png', 'jpg', 'jpeg', 'gif'}

# uploadsãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ
os.makedirs(app.config['UPLOAD_FOLDER'], exist_ok=True)

def allowed_file(filename):
    return '.' in filename and \
           filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS

@app.route('/')
def upload_form():
    return render_template('upload.html')

@app.route('/api/upload', methods=['POST'])
def upload_file():
    if 'file' not in request.files:
        return jsonify({'error': 'ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“'}), 400
    
    file = request.files['file']
    
    if file.filename == '':
        return jsonify({'error': 'ãƒ•ã‚¡ã‚¤ãƒ«åãŒç©ºã§ã™'}), 400
    
    if file and allowed_file(file.filename):
        filename = secure_filename(file.filename)
        filepath = os.path.join(app.config['UPLOAD_FOLDER'], filename)
        file.save(filepath)
        
        return jsonify({
            'message': 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æˆåŠŸ',
            'filename': filename
        })
    
    return jsonify({'error': 'ç„¡åŠ¹ãªãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã§ã™'}), 400

if __name__ == '__main__':
    app.run(debug=True)
```

**templates/upload.html**
```html
<!DOCTYPE html>
<html>
<head>
    <title>ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</title>
</head>
<body>
    <h1>ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</h1>
    <input type="file" id="fileInput" accept="image/*">
    <button onclick="uploadFile()">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</button>
    <div id="result"></div>

    <script>
        async function uploadFile() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„');
                return;
            }
            
            const formData = new FormData();
            formData.append('file', file);
            
            try {
                const response = await fetch('/api/upload', {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    document.getElementById('result').innerHTML = 
                        `ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æˆåŠŸ: ${data.filename}`;
                } else {
                    document.getElementById('result').innerHTML = 
                        `ã‚¨ãƒ©ãƒ¼: ${data.error}`;
                }
            } catch (error) {
                console.error('Error:', error);
                alert('ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼');
            }
        }
    </script>
</body>
</html>
```

**ç†è§£ã™ã¹ããƒã‚¤ãƒ³ãƒˆ:**
- `FormData` = ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã®ç‰¹åˆ¥ãªå½¢å¼
- `secure_filename()` = ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å®‰å…¨ã«ã™ã‚‹
- `request.files` = ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—
- `file.save()` = ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜

---

### ã‚¹ãƒ†ãƒƒãƒ—4.2: ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆ30åˆ†ï¼‰

**upload.html ã«è¿½åŠ **
```html
<style>
    #preview {
        margin-top: 20px;
    }
    #preview img {
        max-width: 300px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }
</style>

<div id="preview"></div>

<script>
    // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠæ™‚ã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
    document.getElementById('fileInput').addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = (event) => {
                document.getElementById('preview').innerHTML = 
                    `<img src="${event.target.result}" alt="ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼">`;
            };
            reader.readAsDataURL(file);
        }
    });
</script>
```

**ç†è§£ã™ã¹ããƒã‚¤ãƒ³ãƒˆ:**
- `FileReader` = ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§èª­ã¿è¾¼ã‚€
- `readAsDataURL()` = ç”»åƒã‚’Base64å½¢å¼ã«å¤‰æ›
- `event.target.result` = èª­ã¿è¾¼ã¾ã‚ŒãŸãƒ‡ãƒ¼ã‚¿

---

### ã‚¹ãƒ†ãƒƒãƒ—4.3: ç”»åƒã®è¡¨ç¤ºï¼ˆ45åˆ†ï¼‰

**app.py ã«è¿½åŠ **
```python
from flask import send_from_directory

@app.route('/uploads/<filename>')
def uploaded_file(filename):
    return send_from_directory(app.config['UPLOAD_FOLDER'], filename)
```

**templates/image_gallery.html**
```html
<!DOCTYPE html>
<html>
<head>
    <title>ç”»åƒã‚®ãƒ£ãƒ©ãƒªãƒ¼</title>
    <style>
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }
        .gallery img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”»åƒ</h1>
    <input type="file" id="fileInput" accept="image/*" multiple>
    <button onclick="uploadFiles()">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</button>
    
    <div class="gallery" id="gallery"></div>

    <script>
        async function uploadFiles() {
            const fileInput = document.getElementById('fileInput');
            const files = fileInput.files;
            
            for (const file of files) {
                const formData = new FormData();
                formData.append('file', file);
                
                try {
                    const response = await fetch('/api/upload', {
                        method: 'POST',
                        body: formData
                    });
                    
                    const data = await response.json();
                    
                    if (response.ok) {
                        addImageToGallery(data.filename);
                    }
                } catch (error) {
                    console.error('Error:', error);
                }
            }
            
            fileInput.value = '';
        }

        function addImageToGallery(filename) {
            const gallery = document.getElementById('gallery');
            const img = document.createElement('img');
            img.src = `/uploads/${filename}`;
            gallery.appendChild(img);
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«æ—¢å­˜ã®ç”»åƒã‚’è¡¨ç¤º
        async function loadGallery() {
            // å®Ÿè£…ã¯æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§
        }

        loadGallery();
    </script>
</body>
</html>
```

---

### ğŸ“ Day 4 ãƒãƒ£ãƒ¬ãƒ³ã‚¸

ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ã¿ã‚ˆã†ï¼š

1. ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸç”»åƒã®ãƒªã‚¹ãƒˆã‚’å–å¾—ã™ã‚‹API
2. ç”»åƒã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨æ‹¡å¤§è¡¨ç¤º
3. ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã§ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

---

## ğŸ“… Day 5: ç”»åƒç”ŸæˆAPIï¼ˆ2æ™‚é–“ï¼‰

### ğŸ¯ ç›®æ¨™
- fal.ai APIã‚’ä½¿ã£ã¦ç”»åƒç”Ÿæˆ
- éåŒæœŸå‡¦ç†ã®ç†è§£
- ç”Ÿæˆç”»åƒã®ä¿å­˜ã¨è¡¨ç¤º

### ã‚¹ãƒ†ãƒƒãƒ—5.1: fal.ai APIã®åŸºæœ¬ï¼ˆ30åˆ†ï¼‰

**APIã‚­ãƒ¼ã®å–å¾—**
1. [fal.ai](https://fal.ai/) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
3. Dashboard â†’ API Keys

**.env ã«è¿½åŠ **
```bash
FAL_KEY=ã‚ãªãŸã®fal.aiAPIã‚­ãƒ¼
```

**ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**
```bash
pip install fal-client requests
```

**test_fal.py**
```python
import os
from dotenv import load_dotenv
import fal_client

load_dotenv()
os.environ["FAL_KEY"] = os.getenv("FAL_KEY")

# ç”»åƒç”Ÿæˆ
result = fal_client.subscribe(
    "fal-ai/seedream",
    arguments={
        "prompt": "A beautiful sunset over mountains",
        "num_inference_steps": 20,
        "guidance_scale": 7.5,
        "num_images": 1
    }
)

print("ç”Ÿæˆã•ã‚ŒãŸç”»åƒURL:")
print(result['images'][0]['url'])
```

```bash
python test_fal.py
```

---

### ã‚¹ãƒ†ãƒƒãƒ—5.2: Flaskã‚¢ãƒ—ãƒªã§Aç”Ÿæˆï¼ˆ1æ™‚é–“ï¼‰

**app.py**
```python
import os
import requests
from flask import Flask, render_template, jsonify, request
from dotenv import load_dotenv
import fal_client

load_dotenv()
os.environ["FAL_KEY"] = os.getenv("FAL_KEY")

app = Flask(__name__)
app.config['UPLOAD_FOLDER'] = 'generated'
os.makedirs(app.config['UPLOAD_FOLDER'], exist_ok=True)

@app.route('/')
def index():
    return render_template('image_gen.html')

@app.route('/api/generate', methods=['POST'])
def generate_image():
    try:
        data = request.json
        prompt = data.get('prompt', '')
        
        # ç”»åƒç”Ÿæˆ
        result = fal_client.subscribe(
            "fal-ai/seedream",
            arguments={
                "prompt": prompt,
                "num_inference_steps": 20,
                "guidance_scale": 7.5,
                "num_images": 1
            }
        )
        
        image_url = result['images'][0]['url']
        
        # ç”»åƒã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ä¿å­˜
        response = requests.get(image_url)
        if response.status_code == 200:
            filename = f"img_{len(os.listdir(app.config['UPLOAD_FOLDER'])) + 1}.png"
            filepath = os.path.join(app.config['UPLOAD_FOLDER'], filename)
            
            with open(filepath, 'wb') as f:
                f.write(response.content)
            
            return jsonify({
                'success': True,
                'filename': filename,
                'url': f'/generated/{filename}'
            })
        
        return jsonify({'success': False, 'error': 'ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¤±æ•—'}), 500
    
    except Exception as e:
        print(f"Error: {e}")
        return jsonify({'success': False, 'error': str(e)}), 500

@app.route('/generated/<filename>')
def generated_file(filename):
    return send_from_directory(app.config['UPLOAD_FOLDER'], filename)

if __name__ == '__main__':
    app.run(debug=True)
```

**templates/image_gen.html**
```html
<!DOCTYPE html>
<html>
<head>
    <title>AIç”»åƒç”Ÿæˆ</title>
    <style>
        body {
            font-family: sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        #prompt {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
        }
        button {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:disabled {
            background: #ccc;
        }
        #result {
            margin-top: 20px;
        }
        #result img {
            max-width: 100%;
            border-radius: 10px;
        }
        .loading {
            color: #666;
            font-style: italic;
        }
    </style>
</head>
<body>
    <h1>AIç”»åƒç”Ÿæˆ</h1>
    <input type="text" id="prompt" placeholder="ç”Ÿæˆã—ãŸã„ç”»åƒã‚’èª¬æ˜...ï¼ˆä¾‹ï¼šå¤•æ—¥ã¨å±±ï¼‰">
    <button onclick="generateImage()" id="generateBtn">ç”»åƒã‚’ç”Ÿæˆ</button>
    
    <div id="result"></div>

    <script>
        async function generateImage() {
            const prompt = document.getElementById('prompt').value;
            const btn = document.getElementById('generateBtn');
            const resultDiv = document.getElementById('result');
            
            if (!prompt) {
                alert('ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            btn.disabled = true;
            resultDiv.innerHTML = '<p class="loading">ç”»åƒã‚’ç”Ÿæˆä¸­...</p>';
            
            try {
                const response = await fetch('/api/generate', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({prompt: prompt})
                });
                
                const data = await response.json();
                
                if (data.success) {
                    resultDiv.innerHTML = `
                        <h3>ç”Ÿæˆã•ã‚ŒãŸç”»åƒ:</h3>
                        <img src="${data.url}" alt="ç”Ÿæˆç”»åƒ">
                        <p>ãƒ•ã‚¡ã‚¤ãƒ«å: ${data.filename}</p>
                    `;
                } else {
                    resultDiv.innerHTML = `<p style="color: red;">ã‚¨ãƒ©ãƒ¼: ${data.error}</p>`;
                }
            } catch (error) {
                console.error('Error:', error);
                resultDiv.innerHTML = '<p style="color: red;">ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</p>';
            } finally {
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
```

---

### ğŸ“ Day 5 ãƒãƒ£ãƒ¬ãƒ³ã‚¸

ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ã¿ã‚ˆã†ï¼š

1. ç”Ÿæˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆnum_inference_steps, guidance_scaleï¼‰ã‚’èª¿æ•´å¯èƒ½ã«
2. ç”Ÿæˆå±¥æ­´ã‚’è¡¨ç¤º
3. ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚’è¿½åŠ 

---

## ğŸ“… Day 6: ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–ï¼ˆ2æ™‚é–“ï¼‰

### ğŸ¯ ç›®æ¨™
- CSVãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ãƒ‡ãƒ¼ã‚¿ä¿å­˜
- ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼æ§‹é€ ã®ç®¡ç†
- ä¼šè©±å±¥æ­´ã®èª­ã¿æ›¸ã

### ã‚¹ãƒ†ãƒƒãƒ—6.1: CSVæ“ä½œã®åŸºæœ¬ï¼ˆ30åˆ†ï¼‰

**test_csv.py**
```python
import csv
from datetime import datetime
from pathlib import Path

# ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆ
data_folder = Path('data')
data_folder.mkdir(exist_ok=True)

# CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
csv_file = data_folder / 'messages.csv'

# CSVã«æ›¸ãè¾¼ã¿
def save_message(role, content):
    with open(csv_file, 'a', newline='', encoding='utf-8') as f:
        writer = csv.writer(f)
        timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        writer.writerow([timestamp, role, content])

# CSVã‹ã‚‰èª­ã¿è¾¼ã¿
def load_messages():
    messages = []
    if csv_file.exists():
        with open(csv_file, 'r', encoding='utf-8') as f:
            reader = csv.reader(f)
            for row in reader:
                if len(row) == 3:
                    messages.append({
                        'timestamp': row[0],
                        'role': row[1],
                        'content': row[2]
                    })
    return messages

# ãƒ†ã‚¹ãƒˆ
save_message('user', 'ã“ã‚“ã«ã¡ã¯')
save_message('assistant', 'ã“ã‚“ã«ã¡ã¯ï¼å…ƒæ°—ã§ã™ã‹ï¼Ÿ')

messages = load_messages()
for msg in messages:
    print(f"[{msg['timestamp']}] {msg['role']}: {msg['content']}")
```

---

### ã‚¹ãƒ†ãƒƒãƒ—6.2: ä¼šè©±ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®ç®¡ç†ï¼ˆ45åˆ†ï¼‰

**conversation_manager.py**
```python
import csv
from datetime import datetime
from pathlib import Path

class ConversationManager:
    def __init__(self, base_folder='datas'):
        self.base_folder = Path(base_folder)
        self.base_folder.mkdir(exist_ok=True)
    
    def create_conversation(self):
        """æ–°ã—ã„ä¼šè©±ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ"""
        timestamp = datetime.now().strftime("%Y-%m-%d_%H-%M-%S")
        conv_folder = self.base_folder / timestamp
        conv_folder.mkdir(exist_ok=True)
        
        # imagesãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆ
        images_folder = conv_folder / 'images'
        images_folder.mkdir(exist_ok=True)
        
        # messages.csvä½œæˆ
        csv_file = conv_folder / 'messages.csv'
        with open(csv_file, 'w', newline='', encoding='utf-8') as f:
            writer = csv.writer(f)
            writer.writerow(['timestamp', 'role', 'content', 'image_refs'])
        
        return str(conv_folder)
    
    def save_message(self, conv_folder, role, content, image_refs=None):
        """ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿å­˜"""
        csv_file = Path(conv_folder) / 'messages.csv'
        with open(csv_file, 'a', newline='', encoding='utf-8') as f:
            writer = csv.writer(f)
            timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
            img_refs_str = ','.join(image_refs) if image_refs else ''
            writer.writerow([timestamp, role, content, img_refs_str])
    
    def load_messages(self, conv_folder):
        """ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã¿"""
        csv_file = Path(conv_folder) / 'messages.csv'
        messages = []
        
        if csv_file.exists():
            with open(csv_file, 'r', encoding='utf-8') as f:
                reader = csv.DictReader(f)
                for row in reader:
                    image_refs = row['image_refs'].split(',') if row['image_refs'] else []
                    messages.append({
                        'timestamp': row['timestamp'],
                        'role': row['role'],
                        'content': row['content'],
                        'image_refs': image_refs
                    })
        
        return messages
    
    def get_next_image_number(self, conv_folder):
        """æ¬¡ã®ç”»åƒç•ªå·ã‚’å–å¾—"""
        images_folder = Path(conv_folder) / 'images'
        existing = list(images_folder.glob('img*.png'))
        
        if not existing:
            return 1
        
        numbers = []
        for img in existing:
            try:
                num = int(img.stem.replace('img', ''))
                numbers.append(num)
            except ValueError:
                continue
        
        return max(numbers) + 1 if numbers else 1

# ãƒ†ã‚¹ãƒˆ
if __name__ == '__main__':
    manager = ConversationManager()
    
    # æ–°ã—ã„ä¼šè©±ã‚’ä½œæˆ
    conv_folder = manager.create_conversation()
    print(f"ä¼šè©±ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆ: {conv_folder}")
    
    # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿å­˜
    manager.save_message(conv_folder, 'user', 'ã“ã‚“ã«ã¡ã¯')
    manager.save_message(conv_folder, 'assistant', 'ã“ã‚“ã«ã¡ã¯ï¼', ['img1.png'])
    
    # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã¿
    messages = manager.load_messages(conv_folder)
    for msg in messages:
        print(msg)
    
    # æ¬¡ã®ç”»åƒç•ªå·
    next_num = manager.get_next_image_number(conv_folder)
    print(f"æ¬¡ã®ç”»åƒç•ªå·: {next_num}")
```

---

### ã‚¹ãƒ†ãƒƒãƒ—6.3: Flaskã‚¢ãƒ—ãƒªã«çµ±åˆï¼ˆ45åˆ†ï¼‰

**app.pyï¼ˆå®Œå…¨ç‰ˆï¼‰**
```python
import os
from flask import Flask, render_template, jsonify, request, send_from_directory
from dotenv import load_dotenv
from conversation_manager import ConversationManager

load_dotenv()

app = Flask(__name__)
manager = ConversationManager()

# ç¾åœ¨ã®ä¼šè©±IDï¼ˆæœ¬æ¥ã¯ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ãŒå¿…è¦ï¼‰
current_conversation = None

@app.route('/')
def index():
    return render_template('chat_app.html')

@app.route('/api/new_conversation', methods=['POST'])
def new_conversation():
    global current_conversation
    current_conversation = manager.create_conversation()
    return jsonify({
        'success': True,
        'conversation_id': current_conversation
    })

@app.route('/api/send_message', methods=['POST'])
def send_message():
    global current_conversation
    
    data = request.json
    message = data.get('message', '')
    
    # ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿å­˜
    manager.save_message(current_conversation, 'user', message)
    
    # ã“ã“ã§AIå¿œç­”ã‚’ç”Ÿæˆï¼ˆDay 3ã§å®Ÿè£…ã—ãŸGeminiã‚’ä½¿ç”¨ï¼‰
    ai_response = f"ã‚ãªãŸã¯ã€Œ{message}ã€ã¨è¨€ã„ã¾ã—ãŸ"
    
    # AIå¿œç­”ã‚’ä¿å­˜
    manager.save_message(current_conversation, 'assistant', ai_response)
    
    return jsonify({
        'success': True,
        'response': ai_response
    })

@app.route('/api/messages', methods=['GET'])
def get_messages():
    global current_conversation
    
    if not current_conversation:
        return jsonify({'success': False, 'error': 'ä¼šè©±ãŒé–‹å§‹ã•ã‚Œã¦ã„ã¾ã›ã‚“'})
    
    messages = manager.load_messages(current_conversation)
    return jsonify({
        'success': True,
        'messages': messages
    })

if __name__ == '__main__':
    app.run(debug=True)
```

---

### ğŸ“ Day 6 ãƒãƒ£ãƒ¬ãƒ³ã‚¸

ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ã¿ã‚ˆã†ï¼š

1. éå»ã®ä¼šè©±ãƒªã‚¹ãƒˆã‚’å–å¾—ã™ã‚‹API
2. ç‰¹å®šã®ä¼šè©±ã‚’èª­ã¿è¾¼ã‚€æ©Ÿèƒ½
3. ä¼šè©±ã‚’å‰Šé™¤ã™ã‚‹æ©Ÿèƒ½

---

## ğŸ“… Day 7: çµ±åˆã¨ãƒ‡ãƒãƒƒã‚°ï¼ˆ3æ™‚é–“ï¼‰

### ğŸ¯ ç›®æ¨™
- ã“ã‚Œã¾ã§ã®çŸ¥è­˜ã‚’çµ±åˆ
- å®Œå…¨ãªã‚¢ãƒ—ãƒªã‚’ä½œæˆ
- ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã‚’ä¿®æ­£

### ã‚¹ãƒ†ãƒƒãƒ—7.1: å…¨æ©Ÿèƒ½ã®çµ±åˆï¼ˆ1.5æ™‚é–“ï¼‰

ã“ã‚Œã¾ã§ã®ã‚³ãƒ¼ãƒ‰ã‚’çµ„ã¿åˆã‚ã›ã¦ã€å®Œå…¨ãªã‚¢ãƒ—ãƒªã‚’ä½œæˆã—ã¾ã™ã€‚

**æœ€çµ‚ç‰ˆ app.py**
```python
# Day 1-6ã§å­¦ã‚“ã ã“ã¨ã‚’å…¨ã¦çµ±åˆ
# - FlaskåŸºç¤
# - Gemini API
# - ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
# - ç”»åƒç”Ÿæˆ
# - CSVä¿å­˜

# å®Œå…¨ãªã‚³ãƒ¼ãƒ‰ã¯å‰ã«æä¾›ã—ãŸã‚‚ã®ã‚’å‚ç…§
```

---

### ã‚¹ãƒ†ãƒƒãƒ—7.2: ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨è§£æ±ºæ–¹æ³•ï¼ˆ1æ™‚é–“ï¼‰

**ã‚¨ãƒ©ãƒ¼1: ModuleNotFoundError**
```python
# ã‚¨ãƒ©ãƒ¼: ModuleNotFoundError: No module named 'flask'
# è§£æ±º:
pip install flask
```

**ã‚¨ãƒ©ãƒ¼2: KeyError in environment variables**
```python
# ã‚¨ãƒ©ãƒ¼: KeyError: 'GOOGLE_AI_API_KEY'
# è§£æ±º: .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
# - ãƒ•ã‚¡ã‚¤ãƒ«åãŒæ­£ã—ã„ã‹ï¼ˆ.env.txtã§ã¯ãªã„ï¼‰
# - APIã‚­ãƒ¼ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹
# - load_dotenv()ã‚’å‘¼ã³å‡ºã—ã¦ã„ã‚‹ã‹
```

**ã‚¨ãƒ©ãƒ¼3: CORS ã‚¨ãƒ©ãƒ¼**
```python
# ã‚¨ãƒ©ãƒ¼: Access to fetch has been blocked by CORS policy
# è§£æ±º:
from flask_cors import CORS
CORS(app)
```

**ã‚¨ãƒ©ãƒ¼4: ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„**
```python
# ã‚¨ãƒ©ãƒ¼: FileNotFoundError: templates/index.html
# è§£æ±º:
# - templatesãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª
# - ãƒ•ã‚¡ã‚¤ãƒ«åãŒæ­£ã—ã„ã‹ç¢ºèªï¼ˆå¤§æ–‡å­—å°æ–‡å­—ã‚‚ï¼‰
```

**ã‚¨ãƒ©ãƒ¼5: JSON parse error**
```javascript
// ã‚¨ãƒ©ãƒ¼: SyntaxError: Unexpected token < in JSON
// è§£æ±º: ã‚µãƒ¼ãƒãƒ¼ãŒHTMLã‚’è¿”ã—ã¦ã„ã‚‹å¯èƒ½æ€§
// - ãƒ«ãƒ¼ãƒˆãŒæ­£ã—ã„ã‹ç¢ºèª
// - ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é©åˆ‡ã«å‡¦ç†
```

---

### ã‚¹ãƒ†ãƒƒãƒ—7.3: ãƒ‡ãƒãƒƒã‚°ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ï¼ˆ30åˆ†ï¼‰

**1. printæ–‡ãƒ‡ãƒãƒƒã‚°**
```python
@app.route('/api/chat', methods=['POST'])
def api_chat():
    data = request.json
    print(f"å—ä¿¡ãƒ‡ãƒ¼ã‚¿: {data}")  # â† è¿½åŠ 
    
    message = data.get('message', '')
    print(f"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: {message}")  # â† è¿½åŠ 
    
    # ... å‡¦ç†
```

**2. ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«**
```javascript
// Chromeãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ãƒ„ãƒ¼ãƒ« (F12)
console.log('é€ä¿¡ãƒ‡ãƒ¼ã‚¿:', {message: message});

fetch('/api/chat', {...})
    .then(res => {
        console.log('ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:', res.status);
        return res.json();
    })
    .then(data => {
        console.log('å—ä¿¡ãƒ‡ãƒ¼ã‚¿:', data);
    });
```

**3. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¿ãƒ–**
```
F12 â†’ Network ã‚¿ãƒ–
- ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å†…å®¹ã‚’ç¢ºèª
- ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å†…å®¹ã‚’ç¢ºèª
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª
```

**4. try-catchã‚’æ´»ç”¨**
```python
try:
    # å‡¦ç†
    response = some_function()
except Exception as e:
    print(f"ã‚¨ãƒ©ãƒ¼è©³ç´°: {type(e).__name__}: {e}")
    import traceback
    traceback.print_exc()
```

---

### ğŸ“ Day 7 æœ€çµ‚ãƒãƒ£ãƒ¬ãƒ³ã‚¸

**å®Œå…¨ãªAIç”»åƒãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒªã‚’ä½œæˆ**

è¦ä»¶:
1. Gemini APIã§ä¼šè©±
2. ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦åˆ†æ
3. fal.aiã§ç”»åƒç”Ÿæˆ
4. ä¼šè©±ã‚’CSVã«ä¿å­˜
5. ç”»åƒã‚’img1.png, img2.png...ã¨ä¿å­˜
6. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

---

## ğŸ¯ ç·ã¾ã¨ã‚: ç†è§£åº¦ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### FlaskåŸºç¤
- [ ] ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ä»•çµ„ã¿ã‚’ç†è§£
- [ ] ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ä½¿ã„æ–¹ã‚’ç†è§£
- [ ] POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å‡¦ç†ã‚’ç†è§£
- [ ] JSONãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ç†è§£

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- [ ] HTML/CSS/JavaScriptã®åŸºæœ¬ã‚’ç†è§£
- [ ] Fetch APIã§ã‚µãƒ¼ãƒãƒ¼ã¨é€šä¿¡ã§ãã‚‹
- [ ] DOMã‚’æ“ä½œã§ãã‚‹
- [ ] ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’ä½¿ãˆã‚‹

### APIé€£æº
- [ ] ç’°å¢ƒå¤‰æ•°ã®ä½¿ã„æ–¹ã‚’ç†è§£
- [ ] Gemini APIã§æ–‡ç« ç”Ÿæˆã§ãã‚‹
- [ ] fal.aiã§ç”»åƒç”Ÿæˆã§ãã‚‹
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒã§ãã‚‹

### ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ
- [ ] ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚’å®Ÿè£…ã§ãã‚‹
- [ ] ç”»åƒã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºã§ãã‚‹
- [ ] CSVã®èª­ã¿æ›¸ããŒã§ãã‚‹
- [ ] ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼æ§‹é€ ã‚’ç®¡ç†ã§ãã‚‹

---

## ğŸ“š ã•ã‚‰ãªã‚‹å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹

### å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- Flask: https://flask.palletsprojects.com/
- MDN Web Docs (JavaScript): https://developer.mozilla.org/ja/
- Google Gemini API: https://ai.google.dev/

### ãŠã™ã™ã‚ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«
- Flask Mega-Tutorial: https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world
- JavaScript.info: https://javascript.info/
- fal.ai Docs: https://fal.ai/docs

---

## ğŸ‰ ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼

7æ—¥é–“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Œäº†ã™ã‚Œã°ã€ã‚ãªãŸã¯ï¼š
- âœ… Flaskã§æœ¬æ ¼çš„ãªWebã‚¢ãƒ—ãƒªã‚’ä½œã‚Œã‚‹
- âœ… ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’é€£æºã§ãã‚‹
- âœ… å¤–éƒ¨APIã‚’çµ±åˆã§ãã‚‹
- âœ… ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ‡ãƒ¼ã‚¿ã‚’é©åˆ‡ã«ç®¡ç†ã§ãã‚‹

**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:**
1. ã“ã®ã‚¢ãƒ—ãƒªã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¦è‡ªåˆ†ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚‹
2. ä»–ã®æ©Ÿèƒ½ã‚’è¿½åŠ ï¼ˆèªè¨¼ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€ãƒ‡ãƒ—ãƒ­ã‚¤ãªã©ï¼‰
3. å­¦ã‚“ã ã‚¹ã‚­ãƒ«ã§æ–°ã—ã„ã‚¢ãƒ—ãƒªã‚’ä½œã‚‹

é ‘å¼µã£ã¦ãã ã•ã„ï¼ ğŸš€

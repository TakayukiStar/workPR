# ğŸ¼ pandas DataFrame å®Œå…¨ãƒã‚¹ã‚¿ãƒ¼è¬›åº§ï¼šåˆå¿ƒè€…ã‹ã‚‰å®Ÿè·µãƒ¬ãƒ™ãƒ«ã¾ã§

> **å¯¾è±¡è€…**: Python æœªçµŒé¨“ãƒ»ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æœªçµŒé¨“ã®ç¤¾ä¼šäºº  
> **æœŸé–“**: 6 é€±é–“ã§åˆä¸­ç´šãƒ¬ãƒ™ãƒ«ã¾ã§  
> **é‡ç‚¹åˆ†é‡**: pandas åŸºç¤ã¨ DataFrame æ“ä½œï¼ˆ80%ï¼‰+ æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿åŸºæœ¬ï¼ˆ20%ï¼‰

---

## ğŸ“‹ å­¦ç¿’ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

### ğŸ¯ Week 1: pandas è¶…åŸºç¤ - DataFrame ã®ä½œæˆã¨åŸºæœ¬æ“ä½œ

### ğŸ¯ Week 2: ãƒ‡ãƒ¼ã‚¿é¸æŠãƒ»æŠ½å‡ºãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®å®Œå…¨æ”»ç•¥

### ğŸ¯ Week 3: ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã¨å¤‰æ›ã®å®Ÿè·µ

### ğŸ¯ Week 4: é›†è¨ˆãƒ»ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ãƒ»ãƒ‡ãƒ¼ã‚¿çµåˆã‚’ãƒã‚¹ã‚¿ãƒ¼

### ğŸ¯ Week 5: æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®åŸºæœ¬æ“ä½œ

### ğŸ¯ Week 6: å¯è¦–åŒ–ã¨å®Ÿè·µãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

---

## Week 1: pandas è¶…åŸºç¤ - DataFrame ã®ä½œæˆã¨åŸºæœ¬æ“ä½œ

### ğŸ¯ **ã“ã®é€±ã®ã‚´ãƒ¼ãƒ«**

- pandas ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®åŸºæœ¬ã‚’å®Œå…¨ç†è§£ã™ã‚‹
- DataFrame ã®æ§‹é€ ã‚’ç†è§£ã—ã€è‡ªåœ¨ã«ä½œæˆã§ãã‚‹
- åŸºæœ¬çš„ãªãƒ‡ãƒ¼ã‚¿æ“ä½œã‚’èº«ã«ã¤ã‘ã‚‹

---

### **Day 1-2: pandas ã®ä¸–ç•Œã¸ã‚ˆã†ã“ãï¼**

```python
# pandasã¨ã¯ä½•ã‹ï¼Ÿ
print("ğŸ¼ pandasã®ä¸–ç•Œã¸ã‚ˆã†ã“ãï¼")
print("=" * 50)

import pandas as pd
import numpy as np
from datetime import datetime

print("ğŸ“š pandasã¨ã¯ï¼Ÿ")
print("- Pythonã®ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ©ã‚¤ãƒ–ãƒ©ãƒª")
print("- è¡¨å½¢å¼ãƒ‡ãƒ¼ã‚¿ï¼ˆExcelã€CSVç­‰ï¼‰ã‚’ç°¡å˜ã«æ‰±ãˆã‚‹")
print("- ã€ŒPanel Dataã€ã®ç•¥")
print("- ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆå¿…é ˆã®ãƒ„ãƒ¼ãƒ«")

# ãªãœpandasãŒé‡è¦ãªã®ã‹ï¼Ÿ
print("\nğŸŒŸ pandasãŒé‡è¦ãªç†ç”±:")
print("âœ… Excelã‚ˆã‚Šã‚‚é«˜é€Ÿã§å¤§é‡ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†")
print("âœ… è¤‡é›‘ãªè¨ˆç®—ã‚„ãƒ‡ãƒ¼ã‚¿å¤‰æ›ãŒç°¡å˜")
print("âœ… ã‚°ãƒ©ãƒ•ä½œæˆã¨ã®é€£æºãŒç°¡å˜")
print("âœ… æ©Ÿæ¢°å­¦ç¿’ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã®ç›¸æ€§æŠœç¾¤")

# æœ€åˆã®DataFrame
print("\nğŸ“Š æœ€åˆã®DataFrameã‚’ä½œã£ã¦ã¿ã‚ˆã†ï¼")

# è¾æ›¸ã‹ã‚‰DataFrameã‚’ä½œæˆ
student_data = {
    "åå‰": ["ç”°ä¸­å¤ªéƒ", "ä½è—¤èŠ±å­", "éˆ´æœ¨æ¬¡éƒ", "é«˜æ©‹ç¾å’²"],
    "å¹´é½¢": [20, 22, 21, 23],
    "å­¦å¹´": [2, 4, 3, 4],
    "æˆç¸¾": [85, 92, 78, 88]
}

df = pd.DataFrame(student_data)
print("ğŸ‘¨â€ğŸ“ å­¦ç”Ÿãƒ‡ãƒ¼ã‚¿:")
print(df)

# DataFrameã®åŸºæœ¬æƒ…å ±ã‚’è¦‹ã‚‹
print("\nğŸ” DataFrameã®åŸºæœ¬æƒ…å ±:")
print(f"å½¢çŠ¶ï¼ˆè¡Œæ•°ã€åˆ—æ•°ï¼‰: {df.shape}")
print(f"è¡Œæ•°: {len(df)}")
print(f"åˆ—æ•°: {len(df.columns)}")
print(f"åˆ—å: {list(df.columns)}")

# ãƒ‡ãƒ¼ã‚¿å‹ã‚’ç¢ºèª
print("\nğŸ“‹ å„åˆ—ã®ãƒ‡ãƒ¼ã‚¿å‹:")
print(df.dtypes)

# åŸºæœ¬çµ±è¨ˆé‡
print("\nğŸ“ˆ æ•°å€¤åˆ—ã®åŸºæœ¬çµ±è¨ˆé‡:")
print(df.describe())
```

### **Day 3-4: DataFrame ã®æ§˜ã€…ãªä½œæˆæ–¹æ³•**

```python
print("\nğŸ› ï¸ DataFrameã®æ§˜ã€…ãªä½œæˆæ–¹æ³•")
print("=" * 40)

# 1. è¾æ›¸ã‹ã‚‰ä½œæˆï¼ˆæœ€ã‚‚åŸºæœ¬ï¼‰
print("1. è¾æ›¸ã‹ã‚‰DataFrameä½œæˆ")
sales_data = {
    "å•†å“å": ["ã‚Šã‚“ã”", "ãƒãƒŠãƒŠ", "ã‚ªãƒ¬ãƒ³ã‚¸", "ã¶ã©ã†"],
    "ä¾¡æ ¼": [100, 80, 120, 200],
    "åœ¨åº«": [50, 30, 25, 15]
}
sales_df = pd.DataFrame(sales_data)
print("ğŸ å•†å“ãƒ‡ãƒ¼ã‚¿:")
print(sales_df)

# 2. ãƒªã‚¹ãƒˆã®ãƒªã‚¹ãƒˆã‹ã‚‰ä½œæˆ
print("\n2. ãƒªã‚¹ãƒˆã®ãƒªã‚¹ãƒˆã‹ã‚‰ä½œæˆ")
employee_data = [
    ["ç”°ä¸­", "å–¶æ¥­", 350000],
    ["ä½è—¤", "é–‹ç™º", 420000],
    ["éˆ´æœ¨", "äººäº‹", 380000],
    ["é«˜æ©‹", "å–¶æ¥­", 360000]
]
employee_df = pd.DataFrame(employee_data, columns=["åå‰", "éƒ¨ç½²", "çµ¦ä¸"])
print("ğŸ‘¥ å¾“æ¥­å“¡ãƒ‡ãƒ¼ã‚¿:")
print(employee_df)

# 3. NumPyé…åˆ—ã‹ã‚‰ä½œæˆ
print("\n3. NumPyé…åˆ—ã‹ã‚‰ä½œæˆ")
np.random.seed(42)
random_data = np.random.randint(1, 100, size=(5, 3))
random_df = pd.DataFrame(random_data, columns=["A", "B", "C"])
print("ğŸ² ãƒ©ãƒ³ãƒ€ãƒ ãƒ‡ãƒ¼ã‚¿:")
print(random_df)

# 4. ç©ºã®DataFrameã‹ã‚‰ä½œæˆ
print("\n4. ç©ºã®DataFrameã‹ã‚‰é–‹å§‹")
empty_df = pd.DataFrame(columns=["æ—¥ä»˜", "å£²ä¸Š", "åˆ©ç›Š"])
print("ğŸ“„ ç©ºã®DataFrame:")
print(empty_df)
print(f"å½¢çŠ¶: {empty_df.shape}")

# ç©ºã®DataFrameã«ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ 
new_row = {"æ—¥ä»˜": "2024-01-01", "å£²ä¸Š": 150000, "åˆ©ç›Š": 45000}
empty_df = pd.concat([empty_df, pd.DataFrame([new_row])], ignore_index=True)
print("\nğŸ“„ ãƒ‡ãƒ¼ã‚¿è¿½åŠ å¾Œ:")
print(empty_df)

# 5. ç¯„å›²ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ
print("\n5. é€£ç¶šãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ")
range_df = pd.DataFrame({
    "ç•ªå·": range(1, 6),
    "å¹³æ–¹": [i**2 for i in range(1, 6)],
    "ç«‹æ–¹": [i**3 for i in range(1, 6)]
})
print("ğŸ”¢ é€£ç¶šãƒ‡ãƒ¼ã‚¿:")
print(range_df)

# 6. é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚€DataFrame
print("\n6. ç¾å®Ÿçš„ãªãƒ‡ãƒ¼ã‚¿ï¼ˆé‡è¤‡ã‚ã‚Šï¼‰")
customer_data = {
    "é¡§å®¢ID": ["C001", "C002", "C001", "C003", "C002"],
    "å•†å“": ["ãƒ‘ãƒ³", "ç‰›ä¹³", "åµ", "ãƒ‘ãƒ³", "ãƒã‚¿ãƒ¼"],
    "é‡‘é¡": [200, 150, 180, 200, 300],
    "è³¼å…¥æ—¥": ["2024-01-01", "2024-01-01", "2024-01-02", "2024-01-02", "2024-01-03"]
}
customer_df = pd.DataFrame(customer_data)
print("ğŸ›’ é¡§å®¢è³¼å…¥ãƒ‡ãƒ¼ã‚¿:")
print(customer_df)
```

### **Day 5-7: DataFrame ã®åŸºæœ¬æ“ä½œ**

```python
print("\nğŸ”§ DataFrameã®åŸºæœ¬æ“ä½œã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã‚ˆã†")
print("=" * 40)

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ
sample_data = {
    "å•†å“å": ["ãƒãƒ¼ãƒˆPC", "ãƒã‚¦ã‚¹", "ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰", "ãƒ¢ãƒ‹ã‚¿ãƒ¼", "ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼", "ãƒ˜ãƒƒãƒ‰ã‚»ãƒƒãƒˆ"],
    "ã‚«ãƒ†ã‚´ãƒª": ["PC", "å‘¨è¾ºæ©Ÿå™¨", "å‘¨è¾ºæ©Ÿå™¨", "PC", "éŸ³éŸ¿", "éŸ³éŸ¿"],
    "ä¾¡æ ¼": [80000, 2000, 5000, 30000, 15000, 8000],
    "åœ¨åº«": [5, 50, 30, 8, 12, 20],
    "è©•ä¾¡": [4.5, 4.2, 4.0, 4.8, 4.1, 4.3]
}
product_df = pd.DataFrame(sample_data)
print("ğŸ’» ã‚µãƒ³ãƒ—ãƒ«å•†å“ãƒ‡ãƒ¼ã‚¿:")
print(product_df)

# 1. ãƒ‡ãƒ¼ã‚¿ã®å…ˆé ­ãƒ»æœ«å°¾ã‚’è¦‹ã‚‹
print("\n1. ãƒ‡ãƒ¼ã‚¿ã®å…ˆé ­ãƒ»æœ«å°¾ç¢ºèª")
print("ğŸ“‹ å…ˆé ­3è¡Œ:")
print(product_df.head(3))
print("\nğŸ“‹ æœ«å°¾2è¡Œ:")
print(product_df.tail(2))

# 2. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨ã‚«ãƒ©ãƒ ã®æ“ä½œ
print("\n2. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨ã‚«ãƒ©ãƒ ")
print(f"ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹: {product_df.index.tolist()}")
print(f"ã‚«ãƒ©ãƒ å: {product_df.columns.tolist()}")

# ã‚«ãƒ©ãƒ åã®å¤‰æ›´
product_df_renamed = product_df.copy()
product_df_renamed.columns = ["è£½å“å", "åˆ†é¡", "å€¤æ®µ", "å€‹æ•°", "ç‚¹æ•°"]
print("\nğŸ“‹ ã‚«ãƒ©ãƒ åå¤‰æ›´å¾Œ:")
print(product_df_renamed.head())

# ç‰¹å®šã®ã‚«ãƒ©ãƒ åã ã‘å¤‰æ›´
product_df_partial = product_df.rename(columns={"å•†å“å": "è£½å“å", "ä¾¡æ ¼": "å€¤æ®µ"})
print("\nğŸ“‹ ä¸€éƒ¨ã‚«ãƒ©ãƒ åå¤‰æ›´:")
print(product_df_partial.head())

# 3. æ–°ã—ã„åˆ—ã®è¿½åŠ 
print("\n3. æ–°ã—ã„åˆ—ã®è¿½åŠ ")
# è¨ˆç®—ã«ã‚ˆã‚‹åˆ—è¿½åŠ 
product_df["ç·åœ¨åº«ä¾¡å€¤"] = product_df["ä¾¡æ ¼"] * product_df["åœ¨åº«"]
print("ğŸ’° ç·åœ¨åº«ä¾¡å€¤ã‚’è¿½åŠ :")
print(product_df[["å•†å“å", "ä¾¡æ ¼", "åœ¨åº«", "ç·åœ¨åº«ä¾¡å€¤"]])

# æ¡ä»¶ã«ã‚ˆã‚‹åˆ—è¿½åŠ 
product_df["ä¾¡æ ¼å¸¯"] = product_df["ä¾¡æ ¼"].apply(
    lambda x: "é«˜ä¾¡æ ¼" if x > 20000 else "ä¸­ä¾¡æ ¼" if x > 5000 else "ä½ä¾¡æ ¼"
)
print("\nğŸ·ï¸ ä¾¡æ ¼å¸¯ã‚’è¿½åŠ :")
print(product_df[["å•†å“å", "ä¾¡æ ¼", "ä¾¡æ ¼å¸¯"]])

# 4. è¡Œã®è¿½åŠ 
print("\n4. è¡Œã®è¿½åŠ ")
new_product = {
    "å•†å“å": "Webã‚«ãƒ¡ãƒ©",
    "ã‚«ãƒ†ã‚´ãƒª": "å‘¨è¾ºæ©Ÿå™¨",
    "ä¾¡æ ¼": 12000,
    "åœ¨åº«": 15,
    "è©•ä¾¡": 4.4,
    "ç·åœ¨åº«ä¾¡å€¤": 12000 * 15,
    "ä¾¡æ ¼å¸¯": "ä¸­ä¾¡æ ¼"
}

# è¾æ›¸ã‚’ä¸€è¡Œã®DataFrameã«å¤‰æ›ã—ã¦ã‹ã‚‰çµåˆ
product_df = pd.concat([product_df, pd.DataFrame([new_product])], ignore_index=True)
print("ğŸ“¦ æ–°å•†å“è¿½åŠ å¾Œ:")
print(product_df.tail(3))

# 5. ãƒ‡ãƒ¼ã‚¿ã®ä¸¦ã³æ›¿ãˆ
print("\n5. ãƒ‡ãƒ¼ã‚¿ã®ä¸¦ã³æ›¿ãˆ")
# ä¾¡æ ¼ã®é«˜ã„é †
price_sorted = product_df.sort_values("ä¾¡æ ¼", ascending=False)
print("ğŸ’° ä¾¡æ ¼ã®é«˜ã„é †:")
print(price_sorted[["å•†å“å", "ä¾¡æ ¼"]])

# è¤‡æ•°åˆ—ã§ã®ä¸¦ã³æ›¿ãˆï¼ˆã‚«ãƒ†ã‚´ãƒªâ†’ä¾¡æ ¼ï¼‰
multi_sorted = product_df.sort_values(["ã‚«ãƒ†ã‚´ãƒª", "ä¾¡æ ¼"], ascending=[True, False])
print("\nğŸ“‚ ã‚«ãƒ†ã‚´ãƒªåˆ¥ãƒ»ä¾¡æ ¼é †:")
print(multi_sorted[["å•†å“å", "ã‚«ãƒ†ã‚´ãƒª", "ä¾¡æ ¼"]])

# 6. åŸºæœ¬çš„ãªçµ±è¨ˆæ“ä½œ
print("\n6. åŸºæœ¬çµ±è¨ˆ")
print("ğŸ“Š æ•°å€¤åˆ—ã®çµ±è¨ˆ:")
print(product_df[["ä¾¡æ ¼", "åœ¨åº«", "è©•ä¾¡"]].describe())

print("\nğŸ“ˆ å€‹åˆ¥çµ±è¨ˆ:")
print(f"å¹³å‡ä¾¡æ ¼: {product_df['ä¾¡æ ¼'].mean():,.0f}å††")
print(f"æœ€é«˜ä¾¡æ ¼: {product_df['ä¾¡æ ¼'].max():,.0f}å††")
print(f"æœ€ä½ä¾¡æ ¼: {product_df['ä¾¡æ ¼'].min():,.0f}å††")
print(f"ä¾¡æ ¼ã®æ¨™æº–åå·®: {product_df['ä¾¡æ ¼'].std():,.0f}å††")

# 7. ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªå€¤ã®ç¢ºèª
print("\n7. ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªå€¤")
print("ğŸ·ï¸ ã‚«ãƒ†ã‚´ãƒªã®ç¨®é¡:")
print(product_df["ã‚«ãƒ†ã‚´ãƒª"].unique())
print(f"ã‚«ãƒ†ã‚´ãƒªæ•°: {product_df['ã‚«ãƒ†ã‚´ãƒª'].nunique()}ç¨®é¡")

print("\nğŸ“Š ã‚«ãƒ†ã‚´ãƒªåˆ¥å•†å“æ•°:")
print(product_df["ã‚«ãƒ†ã‚´ãƒª"].value_counts())

# 8. æƒ…å ±è¡¨ç¤º
print("\n8. DataFrameæƒ…å ±")
print("â„¹ï¸ DataFrameæƒ…å ±:")
print(product_df.info())

print("\nğŸ” æ¬ æå€¤ãƒã‚§ãƒƒã‚¯:")
print(product_df.isnull().sum())
```

**ğŸ›  Week 1 ã®å®Ÿç¿’èª²é¡Œ**

```python
print("\nğŸ“ Week 1 å®Ÿç¿’èª²é¡Œ")
print("=" * 50)

print("ğŸª ã‚ãªãŸã®åº—èˆ—ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã‚ˆã†ï¼")
print("""
èª²é¡Œ: ã‚³ãƒ³ãƒ“ãƒ‹ã‚¨ãƒ³ã‚¹ã‚¹ãƒˆã‚¢ã®å•†å“ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆ

ã€è¦ä»¶ã€‘
1. ä»¥ä¸‹ã®æƒ…å ±ã‚’å«ã‚€DataFrameã‚’ä½œæˆ
   - å•†å“åï¼ˆ10å€‹ä»¥ä¸Šï¼‰
   - ã‚«ãƒ†ã‚´ãƒªï¼ˆé£Ÿå“ã€é£²æ–™ã€é›‘è²¨ã€æ–‡å…·ãªã©ï¼‰
   - ä¾¡æ ¼
   - åœ¨åº«æ•°
   - ä»•å…¥å…ˆ

2. ä»¥ä¸‹ã®æ“ä½œã‚’å®Ÿè¡Œ
   - æ–°ã—ã„åˆ—ã€Œåˆ©ç›Šç‡ã€ã‚’è¿½åŠ ï¼ˆä¾¡æ ¼ã®30%ã¨ã™ã‚‹ï¼‰
   - ã€Œåœ¨åº«é‡‘é¡ã€åˆ—ã‚’è¿½åŠ ï¼ˆä¾¡æ ¼Ã—åœ¨åº«æ•°ï¼‰
   - ä¾¡æ ¼ã®é«˜ã„é †ã«ä¸¦ã³æ›¿ãˆ
   - ã‚«ãƒ†ã‚´ãƒªåˆ¥ã®å•†å“æ•°ã‚’é›†è¨ˆ
   - åŸºæœ¬çµ±è¨ˆé‡ã‚’è¡¨ç¤º

3. ãƒœãƒ¼ãƒŠã‚¹èª²é¡Œ
   - åœ¨åº«ãŒ10å€‹ä»¥ä¸‹ã®å•†å“ã‚’ã€Œè¦ç™ºæ³¨ã€ãƒ•ãƒ©ã‚°ã§è­˜åˆ¥
   - å¹³å‡ä¾¡æ ¼ã‚ˆã‚Šé«˜ã„å•†å“ã‚’ã€Œé«˜é¡å•†å“ã€ã¨ã—ã¦åˆ†é¡
""")

# è§£ç­”ä¾‹ã®ãƒ’ãƒ³ãƒˆ
print("\nğŸ’¡ è§£ç­”ã®ãƒ’ãƒ³ãƒˆ:")
print("""
# ãƒ‡ãƒ¼ã‚¿ä½œæˆä¾‹
convenience_data = {
    "å•†å“å": ["ãŠã«ãã‚Š", "ãƒšãƒƒãƒˆãƒœãƒˆãƒ«èŒ¶", "ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ", ...],
    "ã‚«ãƒ†ã‚´ãƒª": ["é£Ÿå“", "é£²æ–™", "è“å­", ...],
    "ä¾¡æ ¼": [120, 150, 200, ...],
    "åœ¨åº«æ•°": [30, 50, 15, ...],
    "ä»•å…¥å…ˆ": ["Aç¤¾", "Bç¤¾", "Cç¤¾", ...]
}

df = pd.DataFrame(convenience_data)

# åˆ©ç›Šç‡è¿½åŠ 
df["åˆ©ç›Šç‡"] = df["ä¾¡æ ¼"] * 0.3

# ä¸¦ã³æ›¿ãˆ
df_sorted = df.sort_values("ä¾¡æ ¼", ascending=False)

# ã‚«ãƒ†ã‚´ãƒªåˆ¥é›†è¨ˆ
category_count = df["ã‚«ãƒ†ã‚´ãƒª"].value_counts()
""")

# å®Ÿéš›ã«ä½œã£ã¦ã¿ã‚ˆã†
sample_convenience = {
    "å•†å“å": ["ãŠã«ãã‚Šæ¢…", "ãŠèŒ¶500ml", "ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ", "ãƒœãƒ¼ãƒ«ãƒšãƒ³", "å¼å½“ã®ã‚Š",
              "ã‚³ãƒ¼ãƒ’ãƒ¼ç¼¶", "ã‚¬ãƒ ", "ãƒãƒ¼ãƒˆ", "ã‚µãƒ³ãƒ‰ã‚¤ãƒƒãƒ", "ã‚¹ãƒãƒ¼ãƒ„ãƒ‰ãƒªãƒ³ã‚¯"],
    "ã‚«ãƒ†ã‚´ãƒª": ["é£Ÿå“", "é£²æ–™", "è“å­", "æ–‡å…·", "é£Ÿå“",
               "é£²æ–™", "è“å­", "æ–‡å…·", "é£Ÿå“", "é£²æ–™"],
    "ä¾¡æ ¼": [120, 150, 200, 100, 180, 130, 80, 150, 350, 180],
    "åœ¨åº«æ•°": [25, 40, 8, 50, 12, 30, 60, 20, 6, 35],
    "ä»•å…¥å…ˆ": ["Aç¤¾", "Bç¤¾", "Cç¤¾", "Dç¤¾", "Aç¤¾", "Bç¤¾", "Cç¤¾", "Dç¤¾", "Aç¤¾", "Bç¤¾"]
}

sample_df = pd.DataFrame(sample_convenience)
sample_df["åˆ©ç›Šç‡"] = sample_df["ä¾¡æ ¼"] * 0.3
sample_df["åœ¨åº«é‡‘é¡"] = sample_df["ä¾¡æ ¼"] * sample_df["åœ¨åº«æ•°"]

print("\nğŸ“Š ã‚µãƒ³ãƒ—ãƒ«è§£ç­”:")
print(sample_df)

print("\nğŸ“ˆ ã‚«ãƒ†ã‚´ãƒªåˆ¥å•†å“æ•°:")
print(sample_df["ã‚«ãƒ†ã‚´ãƒª"].value_counts())

print("\nğŸ† ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼")
```

---

## Week 2: ãƒ‡ãƒ¼ã‚¿é¸æŠãƒ»æŠ½å‡ºãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®å®Œå…¨æ”»ç•¥

### ğŸ¯ **ã“ã®é€±ã®ã‚´ãƒ¼ãƒ«**

- åˆ—ãƒ»è¡Œã®é¸æŠæ–¹æ³•ã‚’å®Œå…¨ãƒã‚¹ã‚¿ãƒ¼ã™ã‚‹
- æ¡ä»¶ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’è‡ªåœ¨ã«æ“ã‚‹
- è¤‡é›‘ãªæ¡ä»¶çµ„ã¿åˆã‚ã›ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹

---

### **Day 1-2: åˆ—ã®é¸æŠã¨æ“ä½œ**

```python
print("ğŸ“Š Week 2: ãƒ‡ãƒ¼ã‚¿é¸æŠãƒ»æŠ½å‡ºãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°")
print("=" * 50)

import pandas as pd
import numpy as np

# è±Šå¯Œãªã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
sales_data = {
    "æ—¥ä»˜": ["2024-01-01", "2024-01-02", "2024-01-03", "2024-01-04", "2024-01-05",
             "2024-01-06", "2024-01-07", "2024-01-08", "2024-01-09", "2024-01-10"],
    "å•†å“å": ["ãƒãƒ¼ãƒˆPC", "ãƒã‚¦ã‚¹", "ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰", "ãƒ¢ãƒ‹ã‚¿ãƒ¼", "ãƒãƒ¼ãƒˆPC",
              "ãƒ˜ãƒƒãƒ‰ã‚»ãƒƒãƒˆ", "ãƒã‚¦ã‚¹", "ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰", "ãƒ¢ãƒ‹ã‚¿ãƒ¼", "ãƒ˜ãƒƒãƒ‰ã‚»ãƒƒãƒˆ"],
    "ã‚«ãƒ†ã‚´ãƒª": ["PC", "å‘¨è¾ºæ©Ÿå™¨", "å‘¨è¾ºæ©Ÿå™¨", "PC", "PC",
               "éŸ³éŸ¿", "å‘¨è¾ºæ©Ÿå™¨", "å‘¨è¾ºæ©Ÿå™¨", "PC", "éŸ³éŸ¿"],
    "ä¾¡æ ¼": [85000, 2500, 4800, 32000, 89000, 12000, 2200, 5200, 35000, 8500],
    "æ•°é‡": [2, 5, 3, 1, 1, 2, 8, 4, 2, 3],
    "å£²ä¸Š": [170000, 12500, 14400, 32000, 89000, 24000, 17600, 20800, 70000, 25500],
    "é¡§å®¢å¹´é½¢": [28, 45, 35, 52, 31, 26, 38, 29, 48, 33],
    "åœ°åŸŸ": ["æ±äº¬", "å¤§é˜ª", "åå¤å±‹", "ç¦å²¡", "æ±äº¬", "å¤§é˜ª", "åå¤å±‹", "ç¦å²¡", "æ±äº¬", "å¤§é˜ª"]
}

df = pd.DataFrame(sales_data)
print("ğŸ›ï¸ è²©å£²ãƒ‡ãƒ¼ã‚¿:")
print(df)

print("\n1. åˆ—ã®é¸æŠæ–¹æ³•")
print("=" * 30)

# 1ã¤ã®åˆ—ã‚’é¸æŠ
print("ğŸ“‹ 1ã¤ã®åˆ—ã‚’é¸æŠ:")
product_names = df["å•†å“å"]
print(product_names)
print(f"ãƒ‡ãƒ¼ã‚¿å‹: {type(product_names)}")  # Series

# è¤‡æ•°ã®åˆ—ã‚’é¸æŠ
print("\nğŸ“‹ è¤‡æ•°ã®åˆ—ã‚’é¸æŠ:")
basic_info = df[["å•†å“å", "ä¾¡æ ¼", "æ•°é‡"]]
print(basic_info)
print(f"ãƒ‡ãƒ¼ã‚¿å‹: {type(basic_info)}")  # DataFrame

# åˆ—ã‚’ç¯„å›²ã§é¸æŠï¼ˆä½ç½®ãƒ™ãƒ¼ã‚¹ï¼‰
print("\nğŸ“‹ åˆ—ã‚’ç¯„å›²ã§é¸æŠ:")
range_selection = df.loc[:, "å•†å“å":"å£²ä¸Š"]
print(range_selection.head())

# ãƒ‰ãƒƒãƒˆè¨˜æ³•ã§ã®åˆ—é¸æŠï¼ˆã‚·ãƒ³ãƒ—ãƒ«ãªåˆ—åã®å ´åˆï¼‰
print("\nğŸ“‹ ãƒ‰ãƒƒãƒˆè¨˜æ³•:")
print("ä¾¡æ ¼ã®å¹³å‡:", df.ä¾¡æ ¼.mean())
print("æ•°é‡ã®åˆè¨ˆ:", df.æ•°é‡.sum())

# åˆ—ã®å­˜åœ¨ç¢ºèª
print("\nğŸ” åˆ—ã®å­˜åœ¨ç¢ºèª:")
print("'ä¾¡æ ¼'åˆ—ã¯å­˜åœ¨ã™ã‚‹ã‹:", "ä¾¡æ ¼" in df.columns)
print("'åˆ©ç›Š'åˆ—ã¯å­˜åœ¨ã™ã‚‹ã‹:", "åˆ©ç›Š" in df.columns)

# åˆ—åã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°
print("\nğŸ” åˆ—åãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°:")
# ç‰¹å®šã®æ–‡å­—ã‚’å«ã‚€åˆ—
category_cols = [col for col in df.columns if "ã‚«ãƒ†" in col]
print("'ã‚«ãƒ†'ã‚’å«ã‚€åˆ—:", category_cols)

# æ•°å€¤åˆ—ã®ã¿ã‚’é¸æŠ
numeric_columns = df.select_dtypes(include=[np.number]).columns
print("æ•°å€¤åˆ—:", numeric_columns.tolist())

# æ–‡å­—åˆ—åˆ—ã®ã¿ã‚’é¸æŠ
string_columns = df.select_dtypes(include=['object']).columns
print("æ–‡å­—åˆ—åˆ—:", string_columns.tolist())
```

### **Day 3-4: è¡Œã®é¸æŠã¨æŠ½å‡º**

```python
print("\n2. è¡Œã®é¸æŠæ–¹æ³•")
print("=" * 30)

# ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«ã‚ˆã‚‹è¡Œé¸æŠ
print("ğŸ“‹ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«ã‚ˆã‚‹è¡Œé¸æŠ:")
print("æœ€åˆã®è¡Œ:")
print(df.iloc[0])

print("\næœ€åˆã®3è¡Œ:")
print(df.iloc[0:3])

print("\næœ€å¾Œã®2è¡Œ:")
print(df.iloc[-2:])

# ç‰¹å®šã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
print("\nã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹1, 3, 5ã®è¡Œ:")
print(df.iloc[[1, 3, 5]])

# ãƒ©ãƒ™ãƒ«ã«ã‚ˆã‚‹è¡Œé¸æŠ
print("\nğŸ“‹ ãƒ©ãƒ™ãƒ«ã«ã‚ˆã‚‹è¡Œé¸æŠ:")
print("ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹0ã‹ã‚‰4ã¾ã§:")
print(df.loc[0:4, ["å•†å“å", "ä¾¡æ ¼"]])

# ãƒ–ãƒ¼ãƒ«ç´¢å¼•ã«ã‚ˆã‚‹è¡Œé¸æŠ
print("\nğŸ“‹ æ¡ä»¶ã«ã‚ˆã‚‹è¡Œé¸æŠ:")

# é«˜é¡å•†å“ï¼ˆä¾¡æ ¼50000å††ä»¥ä¸Šï¼‰
high_price = df[df["ä¾¡æ ¼"] >= 50000]
print("ğŸ”¥ é«˜é¡å•†å“:")
print(high_price[["å•†å“å", "ä¾¡æ ¼"]])

# ç‰¹å®šã®å•†å“
notebook_sales = df[df["å•†å“å"] == "ãƒãƒ¼ãƒˆPC"]
print("\nğŸ’» ãƒãƒ¼ãƒˆPCã®å£²ä¸Š:")
print(notebook_sales[["æ—¥ä»˜", "ä¾¡æ ¼", "å£²ä¸Š"]])

# æ±äº¬ã®å£²ä¸Š
tokyo_sales = df[df["åœ°åŸŸ"] == "æ±äº¬"]
print("\nğŸ—¼ æ±äº¬ã®å£²ä¸Š:")
print(tokyo_sales[["å•†å“å", "å£²ä¸Š"]])

# è¤‡æ•°æ¡ä»¶ã®çµ„ã¿åˆã‚ã›
print("\nğŸ“‹ è¤‡æ•°æ¡ä»¶ã®çµ„ã¿åˆã‚ã›:")

# ANDæ¡ä»¶ï¼ˆ&ï¼‰
tokyo_high = df[(df["åœ°åŸŸ"] == "æ±äº¬") & (df["ä¾¡æ ¼"] >= 30000)]
print("ğŸ—¼ğŸ’° æ±äº¬ã®é«˜é¡å•†å“:")
print(tokyo_high[["å•†å“å", "ä¾¡æ ¼", "å£²ä¸Š"]])

# ORæ¡ä»¶ï¼ˆ|ï¼‰
pc_or_monitor = df[(df["å•†å“å"] == "ãƒãƒ¼ãƒˆPC") | (df["å•†å“å"] == "ãƒ¢ãƒ‹ã‚¿ãƒ¼")]
print("\nğŸ’»ğŸ–¥ï¸ PCã¾ãŸã¯ãƒ¢ãƒ‹ã‚¿ãƒ¼:")
print(pc_or_monitor[["å•†å“å", "ä¾¡æ ¼"]])

# NOTæ¡ä»¶ï¼ˆ~ï¼‰
not_tokyo = df[~(df["åœ°åŸŸ"] == "æ±äº¬")]
print("\nğŸš«ğŸ—¼ æ±äº¬ä»¥å¤–:")
print(not_tokyo[["åœ°åŸŸ", "å£²ä¸Š"]].groupby("åœ°åŸŸ").sum())

# isin()ãƒ¡ã‚½ãƒƒãƒ‰ã®ä½¿ç”¨
target_products = ["ãƒãƒ¼ãƒˆPC", "ãƒ¢ãƒ‹ã‚¿ãƒ¼", "ãƒ˜ãƒƒãƒ‰ã‚»ãƒƒãƒˆ"]
target_sales = df[df["å•†å“å"].isin(target_products)]
print("\nğŸ¯ å¯¾è±¡å•†å“ã®å£²ä¸Š:")
print(target_sales[["å•†å“å", "å£²ä¸Š"]])

# ç¯„å›²æŒ‡å®š
age_range = df[(df["é¡§å®¢å¹´é½¢"] >= 30) & (df["é¡§å®¢å¹´é½¢"] <= 40)]
print("\nğŸ‘¥ 30-40æ­³ã®é¡§å®¢:")
print(age_range[["é¡§å®¢å¹´é½¢", "å•†å“å", "å£²ä¸Š"]])
```

### **Day 5-7: é«˜åº¦ãªãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã¨æ¡ä»¶æ“ä½œ**

```python
print("\n3. é«˜åº¦ãªãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°")
print("=" * 30)

# query()ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆSQLãƒ©ã‚¤ã‚¯ãªæ¡ä»¶æŒ‡å®šï¼‰
print("ğŸ“‹ query()ãƒ¡ã‚½ãƒƒãƒ‰:")
query_result = df.query("ä¾¡æ ¼ >= 30000 and åœ°åŸŸ == 'æ±äº¬'")
print("ğŸ” query()ã§é«˜é¡&æ±äº¬:")
print(query_result[["å•†å“å", "ä¾¡æ ¼", "åœ°åŸŸ"]])

# è¤‡é›‘ãªqueryæ¡ä»¶
complex_query = df.query("ä¾¡æ ¼ > ä¾¡æ ¼.mean() and æ•°é‡ >= 2")
print("\nğŸ” å¹³å‡ä¾¡æ ¼ä»¥ä¸Š&æ•°é‡2å€‹ä»¥ä¸Š:")
print(complex_query[["å•†å“å", "ä¾¡æ ¼", "æ•°é‡"]])

# æ–‡å­—åˆ—ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ãŸæ¤œç´¢
print("\nğŸ“‹ æ–‡å­—åˆ—ãƒ¡ã‚½ãƒƒãƒ‰ã§ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°:")

# å•†å“åã«ã€Œãƒãƒ¼ãƒˆã€ã‚’å«ã‚€
contains_note = df[df["å•†å“å"].str.contains("ãƒãƒ¼ãƒˆ")]
print("ğŸ“” 'ãƒãƒ¼ãƒˆ'ã‚’å«ã‚€å•†å“:")
print(contains_note[["å•†å“å", "ä¾¡æ ¼"]])

# å•†å“åãŒã€Œãƒã€ã§å§‹ã¾ã‚‹
starts_with_ma = df[df["å•†å“å"].str.startswith("ãƒ")]
print("\nğŸ“” 'ãƒ'ã§å§‹ã¾ã‚‹å•†å“:")
print(starts_with_ma[["å•†å“å", "ä¾¡æ ¼"]])

# å•†å“åãŒã€Œãƒƒãƒˆã€ã§çµ‚ã‚ã‚‹
ends_with_tto = df[df["å•†å“å"].str.endswith("ãƒƒãƒˆ")]
print("\nğŸ“” 'ãƒƒãƒˆ'ã§çµ‚ã‚ã‚‹å•†å“:")
print(ends_with_tto[["å•†å“å", "ä¾¡æ ¼"]])

# æ­£è¦è¡¨ç¾ã‚’ä½¿ã£ãŸæ¤œç´¢
import re
pattern_search = df[df["å•†å“å"].str.contains(r"PC|ãƒ¢ãƒ‹ã‚¿ãƒ¼")]
print("\nğŸ” æ­£è¦è¡¨ç¾ã§PCé–¢é€£å•†å“:")
print(pattern_search[["å•†å“å", "ã‚«ãƒ†ã‚´ãƒª"]])

# 4. nullå€¤ã€æ¬ æå€¤ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
print("\n4. nullå€¤ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°")
print("=" * 30)

# æ„å›³çš„ã«nullå€¤ã‚’ä½œæˆ
df_with_nulls = df.copy()
df_with_nulls.loc[2, "ä¾¡æ ¼"] = np.nan
df_with_nulls.loc[5, "åœ°åŸŸ"] = np.nan

print("ğŸ“‹ nullå€¤ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿:")
print(df_with_nulls[["å•†å“å", "ä¾¡æ ¼", "åœ°åŸŸ"]])

# nullå€¤ãŒã‚ã‚‹è¡Œ
has_nulls = df_with_nulls[df_with_nulls.isnull().any(axis=1)]
print("\nâŒ nullå€¤ãŒã‚ã‚‹è¡Œ:")
print(has_nulls)

# nullå€¤ãŒãªã„è¡Œ
no_nulls = df_with_nulls[df_with_nulls.notnull().all(axis=1)]
print("\nâœ… nullå€¤ãŒãªã„è¡Œ:")
print(no_nulls[["å•†å“å", "ä¾¡æ ¼", "åœ°åŸŸ"]])

# ç‰¹å®šåˆ—ã«nullå€¤ãŒãªã„è¡Œ
price_not_null = df_with_nulls[df_with_nulls["ä¾¡æ ¼"].notnull()]
print("\nğŸ’° ä¾¡æ ¼ã«nullå€¤ãŒãªã„è¡Œ:")
print(price_not_null[["å•†å“å", "ä¾¡æ ¼"]])

# 5. æ¡ä»¶ã«åŸºã¥ãå€¤ã®æ›´æ–°
print("\n5. æ¡ä»¶ã«åŸºã¥ãå€¤ã®æ›´æ–°")
print("=" * 30)

# ã‚³ãƒ”ãƒ¼ã‚’ä½œæˆã—ã¦æ“ä½œ
df_update = df.copy()

# æ¡ä»¶ã«åŸºã¥ãå€¤ã®ç½®æ›
df_update.loc[df_update["ä¾¡æ ¼"] >= 50000, "ä¾¡æ ¼å¸¯"] = "é«˜é¡"
df_update.loc[df_update["ä¾¡æ ¼"] < 50000, "ä¾¡æ ¼å¸¯"] = "æ¨™æº–"

print("ğŸ·ï¸ ä¾¡æ ¼å¸¯ã‚’è¿½åŠ :")
print(df_update[["å•†å“å", "ä¾¡æ ¼", "ä¾¡æ ¼å¸¯"]])

# è¤‡æ•°æ¡ä»¶ã§ã®æ›´æ–°
df_update["å£²ä¸Šãƒ©ãƒ³ã‚¯"] = "C"
df_update.loc[df_update["å£²ä¸Š"] >= 50000, "å£²ä¸Šãƒ©ãƒ³ã‚¯"] = "A"
df_update.loc[(df_update["å£²ä¸Š"] >= 20000) & (df_update["å£²ä¸Š"] < 50000), "å£²ä¸Šãƒ©ãƒ³ã‚¯"] = "B"

print("\nğŸ† å£²ä¸Šãƒ©ãƒ³ã‚¯ã‚’è¿½åŠ :")
print(df_update[["å•†å“å", "å£²ä¸Š", "å£²ä¸Šãƒ©ãƒ³ã‚¯"]])

# 6. ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
print("\n6. ãƒ‡ãƒ¼ã‚¿ã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°")
print("=" * 30)

# ãƒ©ãƒ³ãƒ€ãƒ ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
random_sample = df.sample(n=3, random_state=42)
print("ğŸ² ãƒ©ãƒ³ãƒ€ãƒ 3è¡Œ:")
print(random_sample[["å•†å“å", "ä¾¡æ ¼"]])

# å‰²åˆã§ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
percent_sample = df.sample(frac=0.3, random_state=42)
print(f"\nğŸ“Š 30%ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚° ({len(percent_sample)}è¡Œ):")
print(percent_sample[["å•†å“å", "ä¾¡æ ¼"]])

# æ¡ä»¶ã”ã¨ã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
by_category = df.groupby("ã‚«ãƒ†ã‚´ãƒª").apply(lambda x: x.sample(min(len(x), 2), random_state=42))
print("\nğŸ“‚ ã‚«ãƒ†ã‚´ãƒªåˆ¥ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°:")
print(by_category.reset_index(drop=True)[["ã‚«ãƒ†ã‚´ãƒª", "å•†å“å", "ä¾¡æ ¼"]])
```

**ğŸ›  Week 2 ã®å®Ÿç¿’èª²é¡Œ**

```python
print("\nğŸ“ Week 2 å®Ÿç¿’èª²é¡Œ")
print("=" * 50)

print("ğŸ¢ ä¼šç¤¾ã®å¾“æ¥­å“¡ãƒ‡ãƒ¼ã‚¿åˆ†æ")

# èª²é¡Œç”¨ãƒ‡ãƒ¼ã‚¿
employee_data = {
    "å¾“æ¥­å“¡ID": ["E001", "E002", "E003", "E004", "E005", "E006", "E007", "E008", "E009", "E010"],
    "åå‰": ["ç”°ä¸­å¤ªéƒ", "ä½è—¤èŠ±å­", "éˆ´æœ¨æ¬¡éƒ", "é«˜æ©‹ç¾å’²", "å±±ç”°ä¸€éƒ",
           "æ¸¡è¾ºç¾ç”±ç´€", "ä¸­æ‘å¥å¤ª", "å°æ—ç¾é¦™", "åŠ è—¤å¤§è¼”", "å‰ç”°éº»è¡£"],
    "éƒ¨ç½²": ["å–¶æ¥­", "é–‹ç™º", "å–¶æ¥­", "äººäº‹", "é–‹ç™º", "å–¶æ¥­", "äººäº‹", "é–‹ç™º", "å–¶æ¥­", "äººäº‹"],
    "å¹´é½¢": [28, 32, 45, 29, 38, 26, 51, 35, 33, 27],
    "çµ¦ä¸": [350000, 520000, 480000, 380000, 580000, 320000, 420000, 550000, 410000, 360000],
    "å‹¤ç¶šå¹´æ•°": [3, 8, 15, 4, 12, 2, 20, 9, 7, 3],
    "è©•ä¾¡": ["B", "A", "A", "B", "A", "C", "B", "A", "B", "B"],
    "åœ°åŸŸ": ["æ±äº¬", "å¤§é˜ª", "æ±äº¬", "åå¤å±‹", "å¤§é˜ª", "æ±äº¬", "åå¤å±‹", "å¤§é˜ª", "æ±äº¬", "åå¤å±‹"]
}

emp_df = pd.DataFrame(employee_data)

print("ğŸ‘¥ å¾“æ¥­å“¡ãƒ‡ãƒ¼ã‚¿:")
print(emp_df)

print("""
ğŸ“‹ å®Ÿç¿’èª²é¡Œ:

ã€åŸºæœ¬èª²é¡Œã€‘
1. é–‹ç™ºéƒ¨ã®å¾“æ¥­å“¡ã ã‘ã‚’æŠ½å‡º
2. å¹´é½¢ãŒ30æ­³ä»¥ä¸Šã®å¾“æ¥­å“¡ã‚’æŠ½å‡º
3. çµ¦ä¸ãŒ400000å††ä»¥ä¸Šã®å¾“æ¥­å“¡ã‚’æŠ½å‡º
4. è©•ä¾¡ãŒ'A'ã®å¾“æ¥­å“¡ã‚’æŠ½å‡º
5. æ±äº¬ã¾ãŸã¯å¤§é˜ªå‹¤å‹™ã®å¾“æ¥­å“¡ã‚’æŠ½å‡º

ã€å¿œç”¨èª²é¡Œã€‘
6. å–¶æ¥­éƒ¨ã§å¹´é½¢ãŒ30æ­³ä»¥ä¸‹ã®å¾“æ¥­å“¡
7. å‹¤ç¶šå¹´æ•°10å¹´ä»¥ä¸Šã‹ã¤è©•ä¾¡ãŒ'A'ã¾ãŸã¯'B'ã®å¾“æ¥­å“¡
8. çµ¦ä¸ãŒå…¨ä½“ã®å¹³å‡ä»¥ä¸Šã®å¾“æ¥­å“¡
9. åå‰ã«'ç”°'ãŒå«ã¾ã‚Œã‚‹å¾“æ¥­å“¡
10. å„éƒ¨ç½²ã§æœ€ã‚‚çµ¦ä¸ã®é«˜ã„å¾“æ¥­å“¡

ã€ãƒãƒ£ãƒ¬ãƒ³ã‚¸èª²é¡Œã€‘
11. éƒ¨ç½²åˆ¥ã®å¹³å‡çµ¦ä¸ã‚ˆã‚Šé«˜ã„çµ¦ä¸ã‚’ã‚‚ã‚‰ã£ã¦ã„ã‚‹å¾“æ¥­å“¡
12. å¹´é½¢å±¤åˆ¥ï¼ˆ20ä»£ã€30ä»£ã€40ä»£ã€50ä»£ï¼‰ã®åˆ†æ
13. çµ¦ä¸ãƒ©ãƒ³ã‚¯ã®ä½œæˆï¼ˆS: 500000ä»¥ä¸Š, A: 400000ä»¥ä¸Š, B: 350000ä»¥ä¸Š, C: ãã‚Œä»¥ä¸‹ï¼‰
""")

print("\nğŸ’¡ è§£ç­”ä¾‹:")

# åŸºæœ¬èª²é¡Œã®è§£ç­”ä¾‹
print("1. é–‹ç™ºéƒ¨ã®å¾“æ¥­å“¡:")
dev_employees = emp_df[emp_df["éƒ¨ç½²"] == "é–‹ç™º"]
print(dev_employees[["åå‰", "éƒ¨ç½²", "çµ¦ä¸"]])

print("\n6. å–¶æ¥­éƒ¨ã§å¹´é½¢30æ­³ä»¥ä¸‹:")
young_sales = emp_df[(emp_df["éƒ¨ç½²"] == "å–¶æ¥­") & (emp_df["å¹´é½¢"] <= 30)]
print(young_sales[["åå‰", "éƒ¨ç½²", "å¹´é½¢"]])

print("\n8. å¹³å‡çµ¦ä¸ä»¥ä¸Šã®å¾“æ¥­å“¡:")
avg_salary = emp_df["çµ¦ä¸"].mean()
above_avg = emp_df[emp_df["çµ¦ä¸"] >= avg_salary]
print(f"å¹³å‡çµ¦ä¸: {avg_salary:,.0f}å††")
print(above_avg[["åå‰", "çµ¦ä¸"]])

print("\nğŸ¯ å…¨ã¦ã®èª²é¡Œã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼")
```

---

## Week 3: ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã¨å¤‰æ›ã®å®Ÿè·µ

### ğŸ¯ **ã“ã®é€±ã®ã‚´ãƒ¼ãƒ«**

- æ¬ æå€¤ã®å‡¦ç†æ–¹æ³•ã‚’ãƒã‚¹ã‚¿ãƒ¼ã™ã‚‹
- ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›ãƒ»æ­£è¦åŒ–ã‚’ç†è§£ã™ã‚‹
- æ–‡å­—åˆ—ãƒ‡ãƒ¼ã‚¿ã®æ“ä½œã‚’ç¿’å¾—ã™ã‚‹

---

### **Day 1-2: æ¬ æå€¤ã®æ¤œå‡ºã¨å‡¦ç†**

```python
print("ğŸ§¹ Week 3: ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã¨å¤‰æ›")
print("=" * 50)

import pandas as pd
import numpy as np

print("1. æ¬ æå€¤ã®æ¤œå‡ºã¨å‡¦ç†")
print("=" * 30)

# ç¾å®Ÿçš„ãªå•é¡Œã®ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
messy_data = {
    "é¡§å®¢ID": ["C001", "C002", "C003", "C004", "C005", "C006", "C007", "C008", "C009", "C010"],
    "åå‰": ["ç”°ä¸­å¤ªéƒ", "ä½è—¤èŠ±å­", "", "é«˜æ©‹ç¾å’²", "å±±ç”°ä¸€éƒ", None, "ä¸­æ‘å¥å¤ª", "å°æ—ç¾é¦™", "åŠ è—¤å¤§è¼”", ""],
    "å¹´é½¢": [28, np.nan, 45, 29, np.nan, 26, 51, 35, 33, 27],
    "è·æ¥­": ["ä¼šç¤¾å“¡", "ä¸»å©¦", "ä¼šç¤¾å“¡", "", "è‡ªå–¶æ¥­", "å­¦ç”Ÿ", "ä¼šç¤¾å“¡", np.nan, "ä¼šç¤¾å“¡", "ä¸»å©¦"],
    "å¹´å": [400, 0, 650, 450, np.nan, 200, 700, 520, np.nan, 300],
    "è³¼å…¥é‡‘é¡": [12000, 8500, np.nan, 15000, 22000, 3500, np.nan, 18000, 12500, 9800],
    "ä¼šå“¡ãƒ©ãƒ³ã‚¯": ["ã‚´ãƒ¼ãƒ«ãƒ‰", "ã‚·ãƒ«ãƒãƒ¼", "ã‚´ãƒ¼ãƒ«ãƒ‰", "", "ãƒ—ãƒ©ãƒãƒŠ", "ãƒ–ãƒ­ãƒ³ã‚º", "ã‚´ãƒ¼ãƒ«ãƒ‰", "ã‚·ãƒ«ãƒãƒ¼", "ã‚´ãƒ¼ãƒ«ãƒ‰", ""]
}

df = pd.DataFrame(messy_data)
print("ğŸ“‹ å•é¡Œã®ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿:")
print(df)

# æ¬ æå€¤ã®ç¢ºèª
print("\nğŸ” æ¬ æå€¤ã®ç¢ºèª:")
print("å„åˆ—ã®æ¬ æå€¤æ•°:")
print(df.isnull().sum())

print("\næ¬ æå€¤ã®å‰²åˆ:")
missing_percentage = (df.isnull().sum() / len(df)) * 100
print(missing_percentage.round(1))

# ã‚ˆã‚Šè©³ç´°ãªæ¬ æå€¤ç¢ºèª
print("\nğŸ“Š è©³ç´°ãªæ¬ æå€¤æƒ…å ±:")
missing_info = pd.DataFrame({
    'æ¬ ææ•°': df.isnull().sum(),
    'æ¬ æç‡(%)': (df.isnull().sum() / len(df)) * 100,
    'ãƒ‡ãƒ¼ã‚¿å‹': df.dtypes
})
print(missing_info)

# æ¬ æå€¤ãŒã‚ã‚‹è¡Œã‚’ç‰¹å®š
print("\nâŒ æ¬ æå€¤ãŒã‚ã‚‹è¡Œ:")
rows_with_missing = df[df.isnull().any(axis=1)]
print(rows_with_missing)

# å®Œå…¨ãªãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹è¡Œ
print("\nâœ… å®Œå…¨ãªãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹è¡Œ:")
complete_rows = df[df.notnull().all(axis=1)]
print(complete_rows)

print("\n2. æ¬ æå€¤ã®å‡¦ç†æ–¹æ³•")
print("=" * 30)

# å‡¦ç†ç”¨ã®ã‚³ãƒ”ãƒ¼ã‚’ä½œæˆ
df_clean = df.copy()

# æ–¹æ³•1: æ¬ æå€¤ã®ã‚ã‚‹è¡Œã‚’å‰Šé™¤
print("æ–¹æ³•1: è¡Œå‰Šé™¤")
df_drop_rows = df.dropna()
print(f"å…ƒãƒ‡ãƒ¼ã‚¿: {len(df)}è¡Œ â†’ è¡Œå‰Šé™¤å¾Œ: {len(df_drop_rows)}è¡Œ")

# æ–¹æ³•2: æ¬ æå€¤ã®ã‚ã‚‹åˆ—ã‚’å‰Šé™¤
print("\næ–¹æ³•2: åˆ—å‰Šé™¤")
df_drop_cols = df.dropna(axis=1)
print(f"å…ƒãƒ‡ãƒ¼ã‚¿: {len(df.columns)}åˆ— â†’ åˆ—å‰Šé™¤å¾Œ: {len(df_drop_cols.columns)}åˆ—")
print("æ®‹ã£ãŸåˆ—:", df_drop_cols.columns.tolist())

# æ–¹æ³•3: ç‰¹å®šã®åˆ—ã§ã®æ¬ æå€¤å‰Šé™¤
print("\næ–¹æ³•3: ç‰¹å®šåˆ—ã§ã®å‰Šé™¤")
df_drop_specific = df.dropna(subset=['å¹´é½¢', 'å¹´å'])
print(f"å¹´é½¢ãƒ»å¹´åã§æ¬ æå‰Šé™¤å¾Œ: {len(df_drop_specific)}è¡Œ")

# æ–¹æ³•4: æ¬ æå€¤ã®ç½®æ›
print("\næ–¹æ³•4: æ¬ æå€¤ã®ç½®æ›")

# æ•°å€¤ãƒ‡ãƒ¼ã‚¿ã®æ¬ æå€¤ã‚’å¹³å‡å€¤ã§ç½®æ›
df_clean['å¹´é½¢'].fillna(df_clean['å¹´é½¢'].mean(), inplace=True)
print("å¹´é½¢ã®æ¬ æå€¤ã‚’å¹³å‡å€¤ã§ç½®æ›:")
print(f"å¹³å‡å¹´é½¢: {df['å¹´é½¢'].mean():.1f}æ­³")

# ä¸­å¤®å€¤ã§ç½®æ›
df_clean['å¹´å'].fillna(df_clean['å¹´å'].median(), inplace=True)
print(f"å¹´åã®æ¬ æå€¤ã‚’ä¸­å¤®å€¤({df['å¹´å'].median()}ä¸‡å††)ã§ç½®æ›")

# æ–‡å­—åˆ—ãƒ‡ãƒ¼ã‚¿ã®æ¬ æå€¤ã‚’æœ€é »å€¤ã§ç½®æ›
mode_job = df['è·æ¥­'].mode()[0] if not df['è·æ¥­'].mode().empty else "ä¸æ˜"
df_clean['è·æ¥­'].fillna(mode_job, inplace=True)
print(f"è·æ¥­ã®æ¬ æå€¤ã‚’æœ€é »å€¤('{mode_job}')ã§ç½®æ›")

# å›ºå®šå€¤ã§ç½®æ›
df_clean['ä¼šå“¡ãƒ©ãƒ³ã‚¯'].fillna("æœªè¨­å®š", inplace=True)
df_clean['åå‰'].fillna("ä¸æ˜", inplace=True)

print("\nğŸ› ï¸ ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å¾Œã®ãƒ‡ãƒ¼ã‚¿:")
print(df_clean)

# æ–¹æ³•5: å‰å¾Œã®å€¤ã§è£œé–“
print("\næ–¹æ³•5: è£œé–“")
time_series_data = pd.DataFrame({
    'æ—¥ä»˜': pd.date_range('2024-01-01', periods=10, freq='D'),
    'å£²ä¸Š': [100, 120, np.nan, 140, 135, np.nan, 160, 150, np.nan, 180]
})

print("è£œé–“å‰:")
print(time_series_data)

# ç·šå½¢è£œé–“
time_series_data['å£²ä¸Š_ç·šå½¢è£œé–“'] = time_series_data['å£²ä¸Š'].interpolate()

# å‰ã®å€¤ã§åŸ‹ã‚ã‚‹
time_series_data['å£²ä¸Š_å‰åŸ‹ã‚'] = time_series_data['å£²ä¸Š'].fillna(method='ffill')

# å¾Œã®å€¤ã§åŸ‹ã‚ã‚‹
time_series_data['å£²ä¸Š_å¾ŒåŸ‹ã‚'] = time_series_data['å£²ä¸Š'].fillna(method='bfill')

print("\nè£œé–“å¾Œ:")
print(time_series_data)
```

### **Day 3-4: ãƒ‡ãƒ¼ã‚¿å‹ã®å¤‰æ›ã¨æ­£è¦åŒ–**

```python
print("\n3. ãƒ‡ãƒ¼ã‚¿å‹ã®å¤‰æ›")
print("=" * 30)

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
conversion_data = {
    "ID": ["1", "2", "3", "4", "5"],
    "å£²ä¸Š": ["100000", "150000", "120000", "180000", "90000"],
    "æ—¥ä»˜": ["2024-01-01", "2024-01-02", "2024-01-03", "2024-01-04", "2024-01-05"],
    "å‰²å¼•ç‡": ["0.1", "0.15", "0.05", "0.2", "0.08"],
    "ã‚«ãƒ†ã‚´ãƒª": ["A", "B", "A", "C", "B"]
}

df_convert = pd.DataFrame(conversion_data)
print("ğŸ“‹ å¤‰æ›å‰ã®ãƒ‡ãƒ¼ã‚¿:")
print(df_convert)
print("\nãƒ‡ãƒ¼ã‚¿å‹:")
print(df_convert.dtypes)

# æ–‡å­—åˆ—ã‚’æ•°å€¤ã«å¤‰æ›
df_convert['ID'] = pd.to_numeric(df_convert['ID'])
df_convert['å£²ä¸Š'] = pd.to_numeric(df_convert['å£²ä¸Š'])
df_convert['å‰²å¼•ç‡'] = pd.to_numeric(df_convert['å‰²å¼•ç‡'])

# æ–‡å­—åˆ—ã‚’æ—¥ä»˜ã«å¤‰æ›
df_convert['æ—¥ä»˜'] = pd.to_datetime(df_convert['æ—¥ä»˜'])

# ã‚«ãƒ†ã‚´ãƒªå‹ã«å¤‰æ›
df_convert['ã‚«ãƒ†ã‚´ãƒª'] = df_convert['ã‚«ãƒ†ã‚´ãƒª'].astype('category')

print("\nğŸ“‹ å¤‰æ›å¾Œã®ãƒ‡ãƒ¼ã‚¿:")
print(df_convert)
print("\nãƒ‡ãƒ¼ã‚¿å‹:")
print(df_convert.dtypes)

# ã‚¨ãƒ©ãƒ¼ãŒèµ·ãã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹å¤‰æ›
problematic_data = pd.DataFrame({
    "æ•°å€¤": ["100", "200", "abc", "300", "def"]
})

print("\nâš ï¸ å•é¡Œã®ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿:")
print(problematic_data)

# ã‚¨ãƒ©ãƒ¼æ™‚ã®å‡¦ç†æ–¹æ³•
# errors='coerce': ã‚¨ãƒ©ãƒ¼å€¤ã‚’NaNã«ã™ã‚‹
numeric_coerce = pd.to_numeric(problematic_data['æ•°å€¤'], errors='coerce')
print("\nerrors='coerce':")
print(numeric_coerce)

# errors='ignore': ã‚¨ãƒ©ãƒ¼æ™‚ã¯å…ƒã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒ
numeric_ignore = pd.to_numeric(problematic_data['æ•°å€¤'], errors='ignore')
print("\nerrors='ignore':")
print(numeric_ignore)

print("\n4. ãƒ‡ãƒ¼ã‚¿ã®æ­£è¦åŒ–ãƒ»æ¨™æº–åŒ–")
print("=" * 30)

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
normalization_data = {
    "å•†å“": ["A", "B", "C", "D", "E"],
    "ä¾¡æ ¼": [100, 500, 1000, 2000, 5000],
    "å£²ä¸Šæ•°": [1000, 800, 500, 200, 50],
    "è©•ä¾¡": [4.2, 4.5, 4.8, 4.1, 4.6]
}

df_norm = pd.DataFrame(normalization_data)
print("ğŸ“Š æ­£è¦åŒ–å‰:")
print(df_norm)

# Min-Maxæ­£è¦åŒ–ï¼ˆ0-1ã®ç¯„å›²ã«å¤‰æ›ï¼‰
df_norm['ä¾¡æ ¼_æ­£è¦åŒ–'] = (df_norm['ä¾¡æ ¼'] - df_norm['ä¾¡æ ¼'].min()) / (df_norm['ä¾¡æ ¼'].max() - df_norm['ä¾¡æ ¼'].min())

# Z-scoreæ¨™æº–åŒ–ï¼ˆå¹³å‡0ã€æ¨™æº–åå·®1ï¼‰
df_norm['å£²ä¸Šæ•°_æ¨™æº–åŒ–'] = (df_norm['å£²ä¸Šæ•°'] - df_norm['å£²ä¸Šæ•°'].mean()) / df_norm['å£²ä¸Šæ•°'].std()

# ãƒ©ãƒ³ã‚¯ã‚¹ã‚³ã‚¢ï¼ˆé †ä½ï¼‰
df_norm['è©•ä¾¡_ãƒ©ãƒ³ã‚¯'] = df_norm['è©•ä¾¡'].rank()

print("\nğŸ“Š æ­£è¦åŒ–å¾Œ:")
print(df_norm)

# SKlearnä½¿ç”¨ç‰ˆ
from sklearn.preprocessing import MinMaxScaler, StandardScaler

scaler_minmax = MinMaxScaler()
scaler_standard = StandardScaler()

df_norm['ä¾¡æ ¼_sklearnæ­£è¦åŒ–'] = scaler_minmax.fit_transform(df_norm[['ä¾¡æ ¼']])
df_norm['å£²ä¸Šæ•°_sklearnæ¨™æº–åŒ–'] = scaler_standard.fit_transform(df_norm[['å£²ä¸Šæ•°']])

print("\nğŸ“Š Sklearnä½¿ç”¨ç‰ˆ:")
print(df_norm[['ä¾¡æ ¼', 'ä¾¡æ ¼_sklearnæ­£è¦åŒ–', 'å£²ä¸Šæ•°', 'å£²ä¸Šæ•°_sklearnæ¨™æº–åŒ–']])
```

### **Day 5-7: æ–‡å­—åˆ—ãƒ‡ãƒ¼ã‚¿ã®æ“ä½œã¨å¤‰æ›**

```python
print("\n5. æ–‡å­—åˆ—ãƒ‡ãƒ¼ã‚¿ã®æ“ä½œ")
print("=" * 30)

# å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã§ã‚ã‚Šãã†ãªæ–‡å­—åˆ—å•é¡Œ
text_data = {
    "é¡§å®¢å": ["  ç”°ä¸­å¤ªéƒ  ", "ä½è—¤ èŠ±å­", "SUZUKI Jiro", "ãŸã‹ã¯ã— ã¿ã•ã", "å±±ç”°ã€€ä¸€éƒ"],
    "é›»è©±ç•ªå·": ["090-1234-5678", "03(1234)5678", "0312345678", "090 1234 5678", ""],
    "ãƒ¡ãƒ¼ãƒ«": ["tanaka@email.com", "SATO@EMAIL.COM", "suzuki@", "takahashi@email", ""],
    "ä½æ‰€": ["æ±äº¬éƒ½æ–°å®¿åŒº1-2-3", "å¤§é˜ªåºœå¤§é˜ªå¸‚åŒ—åŒºï¼”ï¼ï¼•ï¼ï¼–", "æ„›çŸ¥çœŒåå¤å±‹å¸‚", "", "ç¦å²¡çœŒç¦å²¡å¸‚åšå¤šåŒº"],
    "å•†å“ã‚³ãƒ¼ãƒ‰": ["PC-001", "mouse-002", "KB_003", "monitor/004", "SP-005"]
}

df_text = pd.DataFrame(text_data)
print("ğŸ“ æ–‡å­—åˆ—ãƒ‡ãƒ¼ã‚¿:")
print(df_text)

# åŸºæœ¬çš„ãªæ–‡å­—åˆ—æ“ä½œ
print("\nğŸ”§ åŸºæœ¬çš„ãªæ–‡å­—åˆ—æ“ä½œ:")

# å‰å¾Œã®ç©ºç™½ã‚’å‰Šé™¤
df_text['é¡§å®¢å_trim'] = df_text['é¡§å®¢å'].str.strip()

# å¤§æ–‡å­—ãƒ»å°æ–‡å­—å¤‰æ›
df_text['ãƒ¡ãƒ¼ãƒ«_å°æ–‡å­—'] = df_text['ãƒ¡ãƒ¼ãƒ«'].str.lower()
df_text['ãƒ¡ãƒ¼ãƒ«_å¤§æ–‡å­—'] = df_text['ãƒ¡ãƒ¼ãƒ«'].str.upper()

# æ–‡å­—åˆ—ã®é•·ã•
df_text['ä½æ‰€_é•·ã•'] = df_text['ä½æ‰€'].str.len()

print("æ–‡å­—åˆ—å‡¦ç†çµæœ:")
print(df_text[['é¡§å®¢å', 'é¡§å®¢å_trim', 'ãƒ¡ãƒ¼ãƒ«', 'ãƒ¡ãƒ¼ãƒ«_å°æ–‡å­—']])

# æ–‡å­—åˆ—ã®åˆ†å‰²
print("\nâœ‚ï¸ æ–‡å­—åˆ—ã®åˆ†å‰²:")
df_text['é›»è©±ç•ªå·_clean'] = df_text['é›»è©±ç•ªå·'].str.replace(r'[()-\s]', '', regex=True)
print("é›»è©±ç•ªå·ã®æ­£è¦åŒ–:")
print(df_text[['é›»è©±ç•ªå·', 'é›»è©±ç•ªå·_clean']])

# ä½æ‰€ã®åˆ†å‰²
address_split = df_text['ä½æ‰€'].str.split('éƒ½|åºœ|çœŒ', expand=True)
df_text['éƒ½é“åºœçœŒ'] = address_split[0] + address_split[1].fillna('')
df_text['å¸‚åŒºç”ºæ‘ä»¥ä¸‹'] = address_split[2].fillna('')

print("\nğŸ  ä½æ‰€ã®åˆ†å‰²:")
print(df_text[['ä½æ‰€', 'éƒ½é“åºœçœŒ', 'å¸‚åŒºç”ºæ‘ä»¥ä¸‹']])

# æ–‡å­—åˆ—ã®ç½®æ›
print("\nğŸ”„ æ–‡å­—åˆ—ã®ç½®æ›:")
df_text['å•†å“ã‚³ãƒ¼ãƒ‰_çµ±ä¸€'] = df_text['å•†å“ã‚³ãƒ¼ãƒ‰'].str.replace(r'[-_/]', '-', regex=True)
print(df_text[['å•†å“ã‚³ãƒ¼ãƒ‰', 'å•†å“ã‚³ãƒ¼ãƒ‰_çµ±ä¸€']])

# ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°
print("\nğŸ” ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°:")

# ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®æ¤œè¨¼
email_pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
df_text['ãƒ¡ãƒ¼ãƒ«_æœ‰åŠ¹'] = df_text['ãƒ¡ãƒ¼ãƒ«'].str.match(email_pattern)

print("ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹æ¤œè¨¼:")
print(df_text[['ãƒ¡ãƒ¼ãƒ«', 'ãƒ¡ãƒ¼ãƒ«_æœ‰åŠ¹']])

# é›»è©±ç•ªå·ã®ãƒ‘ã‚¿ãƒ¼ãƒ³æŠ½å‡º
phone_pattern = r'(\d{2,4})-?(\d{4})-?(\d{4})'
phone_extract = df_text['é›»è©±ç•ªå·'].str.extract(phone_pattern)
phone_extract.columns = ['å¸‚å¤–å±€ç•ª', 'å±€ç•ª', 'ç•ªå·']

print("\nğŸ“ é›»è©±ç•ªå·ã®åˆ†è§£:")
print(phone_extract)

# æ–‡å­—åˆ—ã®æ¤œç´¢
print("\nğŸ” æ–‡å­—åˆ—ã®æ¤œç´¢:")
tokyo_customers = df_text[df_text['ä½æ‰€'].str.contains('æ±äº¬', na=False)]
print("æ±äº¬åœ¨ä½ã®é¡§å®¢:")
print(tokyo_customers[['é¡§å®¢å_trim', 'ä½æ‰€']])

# ã‚«ã‚¿ã‚«ãƒŠãƒ»ã²ã‚‰ãŒãªã®åˆ¤å®š
def has_hiragana(text):
    if pd.isna(text):
        return False
    return bool(re.search(r'[ã²ã‚‰ãŒãª]', text))

def has_katakana(text):
    if pd.isna(text):
        return False
    return bool(re.search(r'[ã‚«ã‚¿ã‚«ãƒŠ]', text))

import re

df_text['ã²ã‚‰ãŒãªå«ã‚€'] = df_text['é¡§å®¢å'].apply(has_hiragana)
df_text['ã‚«ã‚¿ã‚«ãƒŠå«ã‚€'] = df_text['é¡§å®¢å'].apply(has_katakana)

print("\nğŸ‡¯ğŸ‡µ æ—¥æœ¬èªæ–‡å­—ã®åˆ¤å®š:")
print(df_text[['é¡§å®¢å', 'ã²ã‚‰ãŒãªå«ã‚€', 'ã‚«ã‚¿ã‚«ãƒŠå«ã‚€']])

# 6. ãƒ‡ãƒ¼ã‚¿ã®çµåˆãƒ»é€£çµ
print("\n6. æ–‡å­—åˆ—ã®çµåˆ")
print("=" * 30)

# è¤‡æ•°åˆ—ã®çµåˆ
df_text['ãƒ•ãƒ«ãƒãƒ¼ãƒ _ä½æ‰€'] = df_text['é¡§å®¢å_trim'] + ' (' + df_text['ä½æ‰€'] + ')'

# æ¡ä»¶ä»˜ãçµåˆ
df_text['é€£çµ¡å…ˆ'] = df_text['é›»è©±ç•ªå·'].fillna('') + ' / ' + df_text['ãƒ¡ãƒ¼ãƒ«'].fillna('')

print("æ–‡å­—åˆ—çµåˆçµæœ:")
print(df_text[['é¡§å®¢å_trim', 'ä½æ‰€', 'ãƒ•ãƒ«ãƒãƒ¼ãƒ _ä½æ‰€']])
```

**ğŸ›  Week 3 ã®å®Ÿç¿’èª²é¡Œ**

```python
print("\nğŸ“ Week 3 å®Ÿç¿’èª²é¡Œ")
print("=" * 50)

print("ğŸ¥ ç—…é™¢ã®æ‚£è€…ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°")

# èª²é¡Œãƒ‡ãƒ¼ã‚¿ï¼ˆç¾å®Ÿçš„ãªå•é¡Œã‚’å«ã‚€ï¼‰
patient_data = {
    "æ‚£è€…ID": ["P001", "P002", "P003", "P004", "P005", "P006", "P007", "P008"],
    "æ°å": ["  ç”°ä¸­å¤ªéƒ  ", "ä½è—¤èŠ±å­", "", "é«˜æ©‹ç¾å’²", "å±±ç”°ä¸€éƒ", None, "ä¸­æ‘å¥å¤ª", "  å°æ—ç¾é¦™"],
    "å¹´é½¢": ["28", "45", "65", "", "38", "26", "51", "35"],
    "æ€§åˆ¥": ["ç”·", "å¥³", "Female", "å¥³", "ç”·", "M", "ç”·", "å¥³"],
    "è¡€æ¶²å‹": ["A", "B", "O", "", "AB", "a", "B", "O"],
    "èº«é•·": ["170.5", "158.0", "", "162.5", "175.0", "168", "172.8", "155.5"],
    "ä½“é‡": ["65.5", "52.0", "70.0", "55.5", "", "62.0", "80.5", "48.0"],
    "é›»è©±ç•ªå·": ["090-1234-5678", "03(5678)1234", "0661234567", "090 9876 5432", "", "0312345678", "090-5555-4444", ""],
    "è¨ºç™‚ç§‘": ["å†…ç§‘", "å¤–ç§‘", "å°å…ç§‘", "å†…ç§‘", "æ•´å½¢å¤–ç§‘", "çœ¼ç§‘", "å†…ç§‘", "çš®è†šç§‘"],
    "åˆè¨ºæ—¥": ["2024-01-15", "2024/01/20", "2024-1-25", "", "2024.02.01", "2024-02-05", "20240210", "2024-02-15"]
}

patient_df = pd.DataFrame(patient_data)
print("ğŸ¥ æ‚£è€…ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å‰ï¼‰:")
print(patient_df)

print("""
ğŸ“‹ èª²é¡Œå†…å®¹:

ã€ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°èª²é¡Œã€‘
1. æ¬ æå€¤ã®ç¢ºèªã¨å¯¾å‡¦
   - å„åˆ—ã®æ¬ æå€¤æ•°ã‚’è¡¨ç¤º
   - æ°åã®ç©ºç™½ã‚’ã€Œä¸æ˜ã€ã§ç½®æ›
   - å¹´é½¢ã®ç©ºæ–‡å­—ã‚’ä¸­å¤®å€¤ã§ç½®æ›
   - èº«é•·ãƒ»ä½“é‡ã®æ¬ æå€¤ã‚’å¹³å‡å€¤ã§ç½®æ›

2. ãƒ‡ãƒ¼ã‚¿å‹ã®å¤‰æ›
   - å¹´é½¢ã‚’æ•°å€¤å‹ã«å¤‰æ›
   - èº«é•·ãƒ»ä½“é‡ã‚’å°æ•°å‹ã«å¤‰æ›
   - åˆè¨ºæ—¥ã‚’æ—¥ä»˜å‹ã«å¤‰æ›

3. æ–‡å­—åˆ—ã®æ­£è¦åŒ–
   - æ°åã®å‰å¾Œç©ºç™½ã‚’å‰Šé™¤
   - æ€§åˆ¥ã‚’ã€Œç”·ã€ã€Œå¥³ã€ã«çµ±ä¸€
   - è¡€æ¶²å‹ã‚’å¤§æ–‡å­—ã«çµ±ä¸€
   - é›»è©±ç•ªå·ã®å½¢å¼ã‚’çµ±ä¸€ï¼ˆ090-1234-5678å½¢å¼ï¼‰

4. ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼
   - å¹´é½¢ã®å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯ï¼ˆ0-150æ­³ï¼‰
   - BMIã®è¨ˆç®—ã¨è¿½åŠ 
   - é›»è©±ç•ªå·ã®å½¢å¼ãƒã‚§ãƒƒã‚¯
   - åˆè¨ºæ—¥ã®å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯

ã€å¿œç”¨èª²é¡Œã€‘
5. å¹´é½¢å±¤ã®åˆ†é¡ï¼ˆå°å…ã€æˆäººã€é«˜é½¢è€…ï¼‰
6. BMIã‚«ãƒ†ã‚´ãƒªã®åˆ†é¡ï¼ˆä½ä½“é‡ã€æ™®é€šã€è‚¥æº€ãªã©ï¼‰
7. è¨ºç™‚ç§‘ã”ã¨ã®æ‚£è€…æ•°é›†è¨ˆ
8. æœˆåˆ¥åˆè¨ºæ‚£è€…æ•°ã®é›†è¨ˆ
""")

print("\nğŸ’¡ è§£ç­”ä¾‹ï¼ˆä¸€éƒ¨ï¼‰:")

# è§£ç­”ä¾‹ã®å®Ÿè£…
patient_clean = patient_df.copy()

# 1. æ¬ æå€¤å¯¾å¿œ
print("1. æ¬ æå€¤ç¢ºèª:")
print(patient_clean.isnull().sum())

# æ°åã®ç©ºç™½å¯¾å¿œ
patient_clean['æ°å'] = patient_clean['æ°å'].replace('', 'ä¸æ˜').fillna('ä¸æ˜').str.strip()

# 2. ãƒ‡ãƒ¼ã‚¿å‹å¤‰æ›
patient_clean['å¹´é½¢'] = pd.to_numeric(patient_clean['å¹´é½¢'], errors='coerce')
patient_clean['èº«é•·'] = pd.to_numeric(patient_clean['èº«é•·'], errors='coerce')
patient_clean['ä½“é‡'] = pd.to_numeric(patient_clean['ä½“é‡'], errors='coerce')

# æ¬ æå€¤ã‚’å¹³å‡å€¤ã§è£œå®Œ
patient_clean['å¹´é½¢'].fillna(patient_clean['å¹´é½¢'].median(), inplace=True)
patient_clean['èº«é•·'].fillna(patient_clean['èº«é•·'].mean(), inplace=True)
patient_clean['ä½“é‡'].fillna(patient_clean['ä½“é‡'].mean(), inplace=True)

# 3. æ€§åˆ¥ã®çµ±ä¸€
gender_map = {'M': 'ç”·', 'Female': 'å¥³'}
patient_clean['æ€§åˆ¥'] = patient_clean['æ€§åˆ¥'].replace(gender_map)

# BMIè¨ˆç®—
patient_clean['BMI'] = patient_clean['ä½“é‡'] / (patient_clean['èº«é•·'] / 100) ** 2

print("\nğŸ› ï¸ ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å¾Œï¼ˆä¸€éƒ¨ï¼‰:")
print(patient_clean[['æ°å', 'å¹´é½¢', 'æ€§åˆ¥', 'èº«é•·', 'ä½“é‡', 'BMI']].round(2))

print("\nğŸ¯ å…¨ã¦ã®èª²é¡Œã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼")
```

---

## Week 4: é›†è¨ˆãƒ»ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ãƒ»ãƒ‡ãƒ¼ã‚¿çµåˆã‚’ãƒã‚¹ã‚¿ãƒ¼

### ğŸ¯ **ã“ã®é€±ã®ã‚´ãƒ¼ãƒ«**

- groupby æ“ä½œã‚’å®Œå…¨ã«ãƒã‚¹ã‚¿ãƒ¼ã™ã‚‹
- è¤‡é›‘ãªé›†è¨ˆå‡¦ç†ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹
- ãƒ‡ãƒ¼ã‚¿çµåˆï¼ˆjoin, mergeï¼‰ã‚’ç†è§£ã™ã‚‹

---

### **Day 1-3: groupby æ“ä½œã®åŸºæœ¬ã‹ã‚‰å¿œç”¨**

```python
print("ğŸ‘¥ Week 4: é›†è¨ˆãƒ»ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ãƒ»ãƒ‡ãƒ¼ã‚¿çµåˆ")
print("=" * 50)

import pandas as pd
import numpy as np

print("1. groupbyæ“ä½œã®åŸºæœ¬")
print("=" * 30)

# è±Šå¯Œãªå£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
sales_data = {
    "æ—¥ä»˜": ["2024-01-01", "2024-01-01", "2024-01-02", "2024-01-02", "2024-01-03",
             "2024-01-03", "2024-01-04", "2024-01-04", "2024-01-05", "2024-01-05"] * 3,
    "åº—èˆ—": ["æ–°å®¿åº—", "æ¸‹è°·åº—", "æ–°å®¿åº—", "æ¸‹è°·åº—", "æ–°å®¿åº—", "æ¸‹è°·åº—", "æ–°å®¿åº—", "æ¸‹è°·åº—", "æ–°å®¿åº—", "æ¸‹è°·åº—"] * 3,
    "æ‹…å½“è€…": ["ç”°ä¸­", "ä½è—¤", "ç”°ä¸­", "éˆ´æœ¨", "ä½è—¤", "ä½è—¤", "ç”°ä¸­", "éˆ´æœ¨", "éˆ´æœ¨", "ç”°ä¸­"] * 3,
    "å•†å“ã‚«ãƒ†ã‚´ãƒª": ["é›»å­æ©Ÿå™¨", "è¡£æ–™å“", "é›»å­æ©Ÿå™¨", "é£Ÿå“", "è¡£æ–™å“", "é£Ÿå“", "é›»å­æ©Ÿå™¨", "è¡£æ–™å“", "é£Ÿå“", "é›»å­æ©Ÿå™¨"] * 3,
    "å£²ä¸Šé‡‘é¡": [50000, 30000, 45000, 15000, 25000, 20000, 60000, 35000, 18000, 55000] * 3,
    "åˆ©ç›Š": [15000, 9000, 13500, 4500, 7500, 6000, 18000, 10500, 5400, 16500] * 3,
    "é¡§å®¢æ•°": [3, 5, 2, 8, 4, 10, 4, 6, 12, 3] * 3
}

df = pd.DataFrame(sales_data)
print("ğŸ›ï¸ å£²ä¸Šãƒ‡ãƒ¼ã‚¿:")
print(df.head(10))
print(f"ç·ãƒ‡ãƒ¼ã‚¿æ•°: {len(df)}è¡Œ")

# åŸºæœ¬çš„ãªgroupby
print("\nğŸ“Š åŸºæœ¬çš„ãªgroupbyæ“ä½œ:")

# 1ã¤ã®åˆ—ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
store_summary = df.groupby('åº—èˆ—')['å£²ä¸Šé‡‘é¡'].sum()
print("åº—èˆ—åˆ¥å£²ä¸Šåˆè¨ˆ:")
print(store_summary)

# è¤‡æ•°ã®é›†è¨ˆé–¢æ•°
store_detail = df.groupby('åº—èˆ—')['å£²ä¸Šé‡‘é¡'].agg(['sum', 'mean', 'count', 'std'])
print("\nåº—èˆ—åˆ¥è©³ç´°çµ±è¨ˆ:")
print(store_detail.round(0))

# è¤‡æ•°åˆ—ã‚’åŒæ™‚ã«é›†è¨ˆ
multi_column_agg = df.groupby('åº—èˆ—').agg({
    'å£²ä¸Šé‡‘é¡': ['sum', 'mean'],
    'åˆ©ç›Š': ['sum', 'mean'],
    'é¡§å®¢æ•°': 'sum'
})
print("\nè¤‡æ•°åˆ—é›†è¨ˆ:")
print(multi_column_agg.round(0))

# ã‚«ãƒ©ãƒ åã‚’æ•´ç†
multi_column_agg.columns = ['å£²ä¸Šåˆè¨ˆ', 'å£²ä¸Šå¹³å‡', 'åˆ©ç›Šåˆè¨ˆ', 'åˆ©ç›Šå¹³å‡', 'ç·é¡§å®¢æ•°']
print("\nã‚«ãƒ©ãƒ åæ•´ç†å¾Œ:")
print(multi_column_agg)

print("\n2. è¤‡æ•°åˆ—ã§ã®ã‚°ãƒ«ãƒ¼ãƒ—åŒ–")
print("=" * 30)

# åº—èˆ—Ã—æ‹…å½“è€…ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
store_staff = df.groupby(['åº—èˆ—', 'æ‹…å½“è€…'])['å£²ä¸Šé‡‘é¡'].sum()
print("åº—èˆ—Ã—æ‹…å½“è€…åˆ¥å£²ä¸Š:")
print(store_staff)

# ã‚ˆã‚Šè¤‡é›‘ãªã‚°ãƒ«ãƒ¼ãƒ—åŒ–
category_staff = df.groupby(['å•†å“ã‚«ãƒ†ã‚´ãƒª', 'æ‹…å½“è€…']).agg({
    'å£²ä¸Šé‡‘é¡': ['sum', 'count'],
    'åˆ©ç›Š': 'sum'
})
category_staff.columns = ['å£²ä¸Šåˆè¨ˆ', 'å–å¼•æ•°', 'åˆ©ç›Šåˆè¨ˆ']
print("\nã‚«ãƒ†ã‚´ãƒªÃ—æ‹…å½“è€…åˆ¥:")
print(category_staff)

# ã‚°ãƒ«ãƒ¼ãƒ—åŒ–çµæœã®ä¸¦ã³æ›¿ãˆ
top_performers = category_staff.sort_values('å£²ä¸Šåˆè¨ˆ', ascending=False)
print("\nå£²ä¸Šä¸Šä½:")
print(top_performers.head())

print("\n3. é«˜åº¦ãªgroupbyæ“ä½œ")
print("=" * 30)

# ã‚«ã‚¹ã‚¿ãƒ é›†è¨ˆé–¢æ•°
def sales_analysis(group):
    """ã‚«ã‚¹ã‚¿ãƒ é›†è¨ˆé–¢æ•°"""
    return pd.Series({
        'å£²ä¸Šåˆè¨ˆ': group['å£²ä¸Šé‡‘é¡'].sum(),
        'å¹³å‡å£²ä¸Š': group['å£²ä¸Šé‡‘é¡'].mean(),
        'æœ€å¤§å£²ä¸Š': group['å£²ä¸Šé‡‘é¡'].max(),
        'å£²ä¸Šä»¶æ•°': len(group),
        'åˆ©ç›Šç‡': (group['åˆ©ç›Š'].sum() / group['å£²ä¸Šé‡‘é¡'].sum()) * 100,
        'é¡§å®¢å˜ä¾¡': group['å£²ä¸Šé‡‘é¡'].sum() / group['é¡§å®¢æ•°'].sum()
    })

# ã‚«ã‚¹ã‚¿ãƒ é–¢æ•°é©ç”¨
custom_analysis = df.groupby('åº—èˆ—').apply(sales_analysis)
print("ã‚«ã‚¹ã‚¿ãƒ é›†è¨ˆåˆ†æ:")
print(custom_analysis.round(2))

# æ¡ä»¶ä»˜ãã‚°ãƒ«ãƒ¼ãƒ—åŒ–
high_value_sales = df[df['å£²ä¸Šé‡‘é¡'] >= 30000]
high_value_summary = high_value_sales.groupby('å•†å“ã‚«ãƒ†ã‚´ãƒª')['å£²ä¸Šé‡‘é¡'].agg(['count', 'mean'])
high_value_summary.columns = ['é«˜é¡å–å¼•æ•°', 'å¹³å‡é‡‘é¡']
print("\né«˜é¡å–å¼•ï¼ˆ3ä¸‡å††ä»¥ä¸Šï¼‰:")
print(high_value_summary)

# ãƒ©ãƒ³ã‚­ãƒ³ã‚°æ©Ÿèƒ½
df['åº—èˆ—å†…å£²ä¸Šãƒ©ãƒ³ã‚¯'] = df.groupby('åº—èˆ—')['å£²ä¸Šé‡‘é¡'].rank(method='dense', ascending=False)
print("\nåº—èˆ—å†…å£²ä¸Šãƒ©ãƒ³ã‚­ãƒ³ã‚°:")
print(df[['åº—èˆ—', 'æ‹…å½“è€…', 'å£²ä¸Šé‡‘é¡', 'åº—èˆ—å†…å£²ä¸Šãƒ©ãƒ³ã‚¯']].head(10))

print("\n4. æ™‚ç³»åˆ—ã‚°ãƒ«ãƒ¼ãƒ—åŒ–")
print("=" * 30)

# æ—¥ä»˜ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
daily_summary = df.groupby('æ—¥ä»˜').agg({
    'å£²ä¸Šé‡‘é¡': 'sum',
    'åˆ©ç›Š': 'sum',
    'é¡§å®¢æ•°': 'sum'
})
print("æ—¥åˆ¥å£²ä¸Š:")
print(daily_summary)

# å‰æ—¥æ¯”è¨ˆç®—
daily_summary['å£²ä¸Šå‰æ—¥æ¯”'] = daily_summary['å£²ä¸Šé‡‘é¡'].pct_change() * 100
print("\nå‰æ—¥æ¯”ä»˜ã:")
print(daily_summary.round(2))

# ç´¯è¨ˆè¨ˆç®—
daily_summary['å£²ä¸Šç´¯è¨ˆ'] = daily_summary['å£²ä¸Šé‡‘é¡'].cumsum()
print("\nç´¯è¨ˆä»˜ã:")
print(daily_summary)
```

### **Day 4-5: ãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã¨é›†è¨ˆ**

```python
print("\n5. ãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«")
print("=" * 30)

# ãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã®åŸºæœ¬
basic_pivot = df.pivot_table(
    values='å£²ä¸Šé‡‘é¡',
    index='åº—èˆ—',
    columns='å•†å“ã‚«ãƒ†ã‚´ãƒª',
    aggfunc='sum',
    fill_value=0
)
print("åŸºæœ¬ãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«:")
print(basic_pivot)

# è¤‡æ•°ã®å€¤ã‚’æŒã¤ãƒ”ãƒœãƒƒãƒˆ
multi_value_pivot = df.pivot_table(
    values=['å£²ä¸Šé‡‘é¡', 'åˆ©ç›Š'],
    index='åº—èˆ—',
    columns='å•†å“ã‚«ãƒ†ã‚´ãƒª',
    aggfunc='sum',
    fill_value=0
)
print("\nè¤‡æ•°å€¤ãƒ”ãƒœãƒƒãƒˆ:")
print(multi_value_pivot)

# è¤‡æ•°ã®é›†è¨ˆé–¢æ•°
multi_func_pivot = df.pivot_table(
    values='å£²ä¸Šé‡‘é¡',
    index='åº—èˆ—',
    columns='å•†å“ã‚«ãƒ†ã‚´ãƒª',
    aggfunc=['sum', 'mean', 'count'],
    fill_value=0
)
print("\nè¤‡æ•°é–¢æ•°ãƒ”ãƒœãƒƒãƒˆ:")
print(multi_func_pivot)

# è¡Œãƒ»åˆ—ã®åˆè¨ˆã‚’è¿½åŠ 
pivot_with_margins = df.pivot_table(
    values='å£²ä¸Šé‡‘é¡',
    index='åº—èˆ—',
    columns='å•†å“ã‚«ãƒ†ã‚´ãƒª',
    aggfunc='sum',
    fill_value=0,
    margins=True,
    margins_name='åˆè¨ˆ'
)
print("\nåˆè¨ˆä»˜ããƒ”ãƒœãƒƒãƒˆ:")
print(pivot_with_margins)

# ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆè¨ˆç®—
percent_pivot = df.pivot_table(
    values='å£²ä¸Šé‡‘é¡',
    index='åº—èˆ—',
    columns='å•†å“ã‚«ãƒ†ã‚´ãƒª',
    aggfunc='sum',
    fill_value=0
)

# è¡Œã®åˆè¨ˆã«å¯¾ã™ã‚‹å‰²åˆ
row_percent = percent_pivot.div(percent_pivot.sum(axis=1), axis=0) * 100
print("\nåº—èˆ—åˆ¥ã‚«ãƒ†ã‚´ãƒªæ§‹æˆæ¯”(%):")
print(row_percent.round(1))

# åˆ—ã®åˆè¨ˆã«å¯¾ã™ã‚‹å‰²åˆ
col_percent = percent_pivot.div(percent_pivot.sum(axis=0), axis=1) * 100
print("\nã‚«ãƒ†ã‚´ãƒªåˆ¥åº—èˆ—ã‚·ã‚§ã‚¢(%):")
print(col_percent.round(1))

print("\n6. ã‚¯ãƒ­ã‚¹é›†è¨ˆ")
print("=" * 30)

# åŸºæœ¬çš„ãªã‚¯ãƒ­ã‚¹é›†è¨ˆ
cross_tab = pd.crosstab(df['åº—èˆ—'], df['å•†å“ã‚«ãƒ†ã‚´ãƒª'])
print("å–å¼•ä»¶æ•°ã®ã‚¯ãƒ­ã‚¹é›†è¨ˆ:")
print(cross_tab)

# å€¤ã‚’æŒ‡å®šã—ãŸã‚¯ãƒ­ã‚¹é›†è¨ˆ
cross_tab_values = pd.crosstab(
    df['åº—èˆ—'],
    df['å•†å“ã‚«ãƒ†ã‚´ãƒª'],
    values=df['å£²ä¸Šé‡‘é¡'],
    aggfunc='sum'
)
print("\nå£²ä¸Šé‡‘é¡ã®ã‚¯ãƒ­ã‚¹é›†è¨ˆ:")
print(cross_tab_values.fillna(0))

# å‰²åˆè¡¨ç¤º
cross_tab_percent = pd.crosstab(df['åº—èˆ—'], df['å•†å“ã‚«ãƒ†ã‚´ãƒª'], normalize='index') * 100
print("\nå‰²åˆã‚¯ãƒ­ã‚¹é›†è¨ˆ(%):")
print(cross_tab_percent.round(1))

# è¤‡æ•°æ¬¡å…ƒã‚¯ãƒ­ã‚¹é›†è¨ˆ
multi_cross = pd.crosstab(
    [df['åº—èˆ—'], df['æ‹…å½“è€…']],
    df['å•†å“ã‚«ãƒ†ã‚´ãƒª'],
    values=df['å£²ä¸Šé‡‘é¡'],
    aggfunc='sum'
)
print("\nåº—èˆ—Ã—æ‹…å½“è€…Ã—ã‚«ãƒ†ã‚´ãƒª ã‚¯ãƒ­ã‚¹é›†è¨ˆ:")
print(multi_cross.fillna(0))
```

### **Day 6-7: ãƒ‡ãƒ¼ã‚¿çµåˆï¼ˆjoin, mergeï¼‰**

```python
print("\n7. ãƒ‡ãƒ¼ã‚¿çµåˆ")
print("=" * 30)

# çµåˆç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’æº–å‚™
# å•†å“ãƒã‚¹ã‚¿
product_master = pd.DataFrame({
    "å•†å“ã‚³ãƒ¼ãƒ‰": ["P001", "P002", "P003", "P004", "P005"],
    "å•†å“å": ["ãƒãƒ¼ãƒˆPC", "ãƒã‚¦ã‚¹", "ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰", "ãƒ¢ãƒ‹ã‚¿ãƒ¼", "ãƒ˜ãƒƒãƒ‰ã‚»ãƒƒãƒˆ"],
    "ã‚«ãƒ†ã‚´ãƒª": ["PC", "å‘¨è¾ºæ©Ÿå™¨", "å‘¨è¾ºæ©Ÿå™¨", "PC", "éŸ³éŸ¿æ©Ÿå™¨"],
    "å®šä¾¡": [100000, 3000, 6000, 40000, 15000]
})

# å£²ä¸Šãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³
transaction_data = pd.DataFrame({
    "å–å¼•ID": ["T001", "T002", "T003", "T004", "T005", "T006"],
    "å•†å“ã‚³ãƒ¼ãƒ‰": ["P001", "P002", "P001", "P003", "P006", "P002"],  # P006ã¯å­˜åœ¨ã—ãªã„å•†å“
    "æ•°é‡": [2, 5, 1, 3, 2, 4],
    "å£²ä¸Šæ—¥": ["2024-01-01", "2024-01-01", "2024-01-02", "2024-01-02", "2024-01-03", "2024-01-03"],
    "åº—èˆ—": ["æ–°å®¿åº—", "æ¸‹è°·åº—", "æ–°å®¿åº—", "æ¸‹è°·åº—", "æ–°å®¿åº—", "æ¸‹è°·åº—"]
})

# åº—èˆ—ãƒã‚¹ã‚¿
store_master = pd.DataFrame({
    "åº—èˆ—": ["æ–°å®¿åº—", "æ¸‹è°·åº—", "æ± è¢‹åº—"],  # æ± è¢‹åº—ã¯å–å¼•ãŒãªã„
    "åº—èˆ—ã‚³ãƒ¼ãƒ‰": ["S001", "S002", "S003"],
    "ä½æ‰€": ["æ±äº¬éƒ½æ–°å®¿åŒº", "æ±äº¬éƒ½æ¸‹è°·åŒº", "æ±äº¬éƒ½è±Šå³¶åŒº"],
    "é–‹åº—æ—¥": ["2020-01-01", "2020-02-01", "2020-03-01"]
})

print("å•†å“ãƒã‚¹ã‚¿:")
print(product_master)
print("\nå£²ä¸Šãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³:")
print(transaction_data)
print("\nåº—èˆ—ãƒã‚¹ã‚¿:")
print(store_master)

print("\nğŸ“ å†…éƒ¨çµåˆï¼ˆinner joinï¼‰")
# å†…éƒ¨çµåˆï¼šä¸¡æ–¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«å­˜åœ¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ã¿
inner_join = pd.merge(transaction_data, product_master, on='å•†å“ã‚³ãƒ¼ãƒ‰', how='inner')
print("å•†å“ãƒã‚¹ã‚¿ã¨ã®å†…éƒ¨çµåˆ:")
print(inner_join)

print("\nğŸ“ å·¦çµåˆï¼ˆleft joinï¼‰")
# å·¦çµåˆï¼šå·¦ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’å…¨ã¦ä¿æŒ
left_join = pd.merge(transaction_data, product_master, on='å•†å“ã‚³ãƒ¼ãƒ‰', how='left')
print("å•†å“ãƒã‚¹ã‚¿ã¨ã®å·¦çµåˆ:")
print(left_join)

print("\nğŸ“ å³çµåˆï¼ˆright joinï¼‰")
# å³çµåˆï¼šå³ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’å…¨ã¦ä¿æŒ
right_join = pd.merge(transaction_data, product_master, on='å•†å“ã‚³ãƒ¼ãƒ‰', how='right')
print("å•†å“ãƒã‚¹ã‚¿ã¨ã®å³çµåˆ:")
print(right_join)

print("\nğŸ“ å¤–éƒ¨çµåˆï¼ˆouter joinï¼‰")
# å¤–éƒ¨çµåˆï¼šä¸¡æ–¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒ
outer_join = pd.merge(transaction_data, product_master, on='å•†å“ã‚³ãƒ¼ãƒ‰', how='outer')
print("å•†å“ãƒã‚¹ã‚¿ã¨ã®å¤–éƒ¨çµåˆ:")
print(outer_join)

print("\nğŸ“ è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ã®çµåˆ")
# æ®µéšçš„ã«çµåˆ
step1 = pd.merge(transaction_data, product_master, on='å•†å“ã‚³ãƒ¼ãƒ‰', how='left')
final_result = pd.merge(step1, store_master, on='åº—èˆ—', how='left')

print("3ãƒ†ãƒ¼ãƒ–ãƒ«çµåˆçµæœ:")
print(final_result[['å–å¼•ID', 'å•†å“å', 'ã‚«ãƒ†ã‚´ãƒª', 'æ•°é‡', 'åº—èˆ—', 'ä½æ‰€']])

print("\nğŸ“ ç•°ãªã‚‹åˆ—åã§ã®çµåˆ")
# åˆ—åãŒç•°ãªã‚‹å ´åˆã®çµåˆ
customer_data = pd.DataFrame({
    "é¡§å®¢ID": ["C001", "C002", "C003"],
    "customer_name": ["ç”°ä¸­", "ä½è—¤", "éˆ´æœ¨"],
    "å¹´é½¢": [30, 25, 35]
})

order_data = pd.DataFrame({
    "æ³¨æ–‡ID": ["O001", "O002", "O003"],
    "cust_id": ["C001", "C003", "C004"],  # åˆ—åãŒç•°ãªã‚‹
    "å•†å“": ["ãƒãƒ¼ãƒˆPC", "ãƒã‚¦ã‚¹", "ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰"],
    "é‡‘é¡": [100000, 3000, 6000]
})

# ç•°ãªã‚‹åˆ—åã§çµåˆ
different_columns_join = pd.merge(
    order_data,
    customer_data,
    left_on='cust_id',
    right_on='é¡§å®¢ID',
    how='left'
)
print("ç•°ãªã‚‹åˆ—åã§ã®çµåˆ:")
print(different_columns_join)

print("\nğŸ“ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§ã®çµåˆ")
# ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½¿ã£ãŸçµåˆ
df1 = pd.DataFrame({
    'å£²ä¸Š': [100, 200, 300]
}, index=['A', 'B', 'C'])

df2 = pd.DataFrame({
    'åˆ©ç›Š': [30, 60, 90],
    'åœ°åŸŸ': ['æ±äº¬', 'å¤§é˜ª', 'åå¤å±‹']
}, index=['A', 'B', 'D'])

index_join = df1.join(df2, how='outer')
print("ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹çµåˆ:")
print(index_join)

print("\nğŸ“ çµåˆã®æ¤œè¨¼")
# çµåˆçµæœã®æ¤œè¨¼
print("å…ƒã®å–å¼•ãƒ‡ãƒ¼ã‚¿æ•°:", len(transaction_data))
print("å†…éƒ¨çµåˆå¾Œ:", len(inner_join))
print("å·¦çµåˆå¾Œ:", len(left_join))

# çµåˆã§ããªã‹ã£ãŸãƒ‡ãƒ¼ã‚¿ã®ç¢ºèª
missing_products = left_join[left_join['å•†å“å'].isnull()]
if not missing_products.empty:
    print("\nãƒã‚¹ã‚¿ã«ãªã„å•†å“:")
    print(missing_products[['å–å¼•ID', 'å•†å“ã‚³ãƒ¼ãƒ‰']])

print("\n8. concatï¼ˆé€£çµï¼‰")
print("=" * 30)

# ãƒ‡ãƒ¼ã‚¿ã®ç¸¦é€£çµ
df1 = pd.DataFrame({
    'åº—èˆ—': ['æ–°å®¿åº—', 'æ¸‹è°·åº—'],
    'å£²ä¸Š': [100000, 120000]
})

df2 = pd.DataFrame({
    'åº—èˆ—': ['æ± è¢‹åº—', 'éŠ€åº§åº—'],
    'å£²ä¸Š': [90000, 150000]
})

vertical_concat = pd.concat([df1, df2], ignore_index=True)
print("ç¸¦é€£çµ:")
print(vertical_concat)

# ãƒ‡ãƒ¼ã‚¿ã®æ¨ªé€£çµ
df3 = pd.DataFrame({
    'åˆ©ç›Š': [30000, 36000, 27000, 45000]
})

horizontal_concat = pd.concat([vertical_concat, df3], axis=1)
print("\næ¨ªé€£çµ:")
print(horizontal_concat)

# ã‚­ãƒ¼ã«ã‚ˆã‚‹é€£çµ
df4 = pd.DataFrame({
    'åº—èˆ—': ['æ–°å®¿åº—', 'æ¸‹è°·åº—', 'æ± è¢‹åº—'],
    'å¾“æ¥­å“¡æ•°': [10, 12, 8]
})

df5 = pd.DataFrame({
    'åº—èˆ—': ['æ–°å®¿åº—', 'æ¸‹è°·åº—', 'éŠ€åº§åº—'],
    'é¢ç©': [100, 120, 80]
})

key_based_concat = pd.concat([df4.set_index('åº—èˆ—'), df5.set_index('åº—èˆ—')], axis=1, sort=True)
print("\nã‚­ãƒ¼ãƒ™ãƒ¼ã‚¹é€£çµ:")
print(key_based_concat)
```

**ğŸ›  Week 4 ã®å®Ÿç¿’èª²é¡Œ**

```python
print("\nğŸ“ Week 4 å®Ÿç¿’èª²é¡Œ")
print("=" * 50)

print("ğŸ¬ å°å£²ãƒã‚§ãƒ¼ãƒ³ã®å£²ä¸Šåˆ†æãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ")

# èª²é¡Œç”¨ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ
# åº—èˆ—ãƒã‚¹ã‚¿
stores = pd.DataFrame({
    "åº—èˆ—ID": ["S001", "S002", "S003", "S004", "S005"],
    "åº—èˆ—å": ["æ–°å®¿åº—", "æ¸‹è°·åº—", "æ± è¢‹åº—", "éŠ€åº§åº—", "åŸå®¿åº—"],
    "åœ°åŸŸ": ["æ±äº¬", "æ±äº¬", "æ±äº¬", "æ±äº¬", "æ±äº¬"],
    "é–‹åº—å¹´": [2018, 2019, 2020, 2015, 2021],
    "é¢ç©_ã¡": [200, 150, 180, 250, 120]
})

# å•†å“ãƒã‚¹ã‚¿
products = pd.DataFrame({
    "å•†å“ID": ["P001", "P002", "P003", "P004", "P005", "P006"],
    "å•†å“å": ["Tã‚·ãƒ£ãƒ„", "ã‚¸ãƒ¼ãƒ³ã‚º", "ã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼", "ãƒãƒƒã‚°", "å¸½å­", "ãƒ™ãƒ«ãƒˆ"],
    "ã‚«ãƒ†ã‚´ãƒª": ["ãƒˆãƒƒãƒ—ã‚¹", "ãƒœãƒˆãƒ ã‚¹", "ã‚·ãƒ¥ãƒ¼ã‚º", "ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼", "ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼", "ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼"],
    "åŸä¾¡": [1000, 3000, 4000, 2500, 800, 1200],
    "å®šä¾¡": [2000, 6000, 8000, 5000, 1600, 2400]
})

# å£²ä¸Šãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³
np.random.seed(42)
transactions = []
for i in range(200):
    transactions.append({
        "å–å¼•ID": f"T{i+1:03d}",
        "åº—èˆ—ID": np.random.choice(stores["åº—èˆ—ID"]),
        "å•†å“ID": np.random.choice(products["å•†å“ID"]),
        "æ•°é‡": np.random.randint(1, 6),
        "å£²ä¾¡": np.random.randint(1500, 8500),
        "å£²ä¸Šæ—¥": np.random.choice(pd.date_range("2024-01-01", "2024-03-31")),
        "é¡§å®¢å¹´é½¢": np.random.randint(18, 65),
        "æ€§åˆ¥": np.random.choice(["ç”·æ€§", "å¥³æ€§"])
    })

sales_df = pd.DataFrame(transactions)

print("åº—èˆ—ãƒã‚¹ã‚¿:")
print(stores.head())
print("\nå•†å“ãƒã‚¹ã‚¿:")
print(products.head())
print("\nå£²ä¸Šãƒ‡ãƒ¼ã‚¿:")
print(sales_df.head())

print("""
ğŸ“‹ åˆ†æèª²é¡Œ:

ã€åŸºæœ¬é›†è¨ˆèª²é¡Œã€‘
1. åº—èˆ—åˆ¥å£²ä¸Šåˆ†æ
   - åº—èˆ—åˆ¥ã®å£²ä¸Šåˆè¨ˆã€å¹³å‡ã€å–å¼•æ•°
   - åº—èˆ—åˆ¥ã®åˆ©ç›Šè¨ˆç®—ï¼ˆå£²ä¾¡ - åŸä¾¡ï¼‰

2. å•†å“åˆ†æ
   - å•†å“åˆ¥å£²ä¸Šãƒ©ãƒ³ã‚­ãƒ³ã‚°
   - ã‚«ãƒ†ã‚´ãƒªåˆ¥å£²ä¸Šåˆ†æ
   - å•†å“åˆ¥åˆ©ç›Šç‡åˆ†æ

3. æ™‚ç³»åˆ—åˆ†æ
   - æœˆåˆ¥å£²ä¸Šæ¨ç§»
   - æ›œæ—¥åˆ¥å£²ä¸Šãƒ‘ã‚¿ãƒ¼ãƒ³
   - å£²ä¸Šãƒˆãƒƒãƒ—3ã®åº—èˆ—ã®æ—¥åˆ¥æ¨ç§»

ã€ãƒ‡ãƒ¼ã‚¿çµåˆèª²é¡Œã€‘
4. ãƒã‚¹ã‚¿ã¨ã®çµåˆ
   - å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã«åº—èˆ—æƒ…å ±ã‚’çµåˆ
   - å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã«å•†å“æƒ…å ±ã‚’çµåˆ
   - 3ãƒ†ãƒ¼ãƒ–ãƒ«çµåˆã§å®Œå…¨ãªå£²ä¸Šæ˜ç´°ä½œæˆ

5. é¡§å®¢åˆ†æ
   - å¹´é½¢å±¤åˆ¥è³¼è²·åˆ†æï¼ˆ20ä»£ã€30ä»£ã€40ä»£ã€50ä»£ä»¥ä¸Šï¼‰
   - æ€§åˆ¥Ã—ã‚«ãƒ†ã‚´ãƒªåˆ¥ã®å£²ä¸Šåˆ†æ
   - åº—èˆ—é¢ç©ã¨å£²ä¸Šã®é–¢ä¿‚åˆ†æ

ã€é«˜åº¦ãªåˆ†æèª²é¡Œã€‘
6. ãƒ”ãƒœãƒƒãƒˆåˆ†æ
   - åº—èˆ—Ã—ã‚«ãƒ†ã‚´ãƒªã®å£²ä¸Šãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«
   - æœˆÃ—åº—èˆ—ã®å£²ä¸Šæ¨ç§»ãƒ”ãƒœãƒƒãƒˆ
   - å¹´é½¢å±¤Ã—æ€§åˆ¥Ã—ã‚«ãƒ†ã‚´ãƒªã®3æ¬¡å…ƒåˆ†æ

7. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ
   - åº—èˆ—é¢ç©ã‚ãŸã‚Šã®å£²ä¸ŠåŠ¹ç‡
   - å•†å“å›è»¢ç‡åˆ†æ
   - åˆ©ç›Šç‡ã®é«˜ã„åº—èˆ—Ã—å•†å“çµ„ã¿åˆã‚ã›

8. æ¯”è¼ƒåˆ†æ
   - å„åº—èˆ—ã®å£²ä¸Šæ§‹æˆæ¯”
   - å‰æœˆæ¯”åˆ†æ
   - åŒã‚«ãƒ†ã‚´ãƒªå†…ã§ã®å•†å“ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒ
""")

print("\nğŸ’¡ è§£ç­”ä¾‹ï¼ˆä¸€éƒ¨ï¼‰:")

# è§£ç­”ä¾‹
# 1. åŸºæœ¬çš„ãªåº—èˆ—åˆ¥åˆ†æ
store_sales = sales_df.groupby('åº—èˆ—ID').agg({
    'å£²ä¾¡': ['sum', 'mean', 'count'],
    'æ•°é‡': 'sum'
})
store_sales.columns = ['å£²ä¸Šåˆè¨ˆ', 'å¹³å‡å£²ä¾¡', 'å–å¼•æ•°', 'ç·è²©å£²æ•°']

# åº—èˆ—ãƒã‚¹ã‚¿ã¨çµåˆ
store_analysis = pd.merge(store_sales.reset_index(), stores, on='åº—èˆ—ID')
store_analysis['é¢ç©å½“å£²ä¸Š'] = store_analysis['å£²ä¸Šåˆè¨ˆ'] / store_analysis['é¢ç©_ã¡']

print("åº—èˆ—åˆ¥åˆ†æ:")
print(store_analysis[['åº—èˆ—å', 'å£²ä¸Šåˆè¨ˆ', 'å–å¼•æ•°', 'é¢ç©_ã¡', 'é¢ç©å½“å£²ä¸Š']].round(2))

# 2. å•†å“ã‚«ãƒ†ã‚´ãƒªåˆ†æç”¨ã®çµåˆ
product_sales = pd.merge(sales_df, products, on='å•†å“ID')
category_analysis = product_sales.groupby('ã‚«ãƒ†ã‚´ãƒª').agg({
    'å£²ä¾¡': 'sum',
    'æ•°é‡': 'sum'
})

print("\nã‚«ãƒ†ã‚´ãƒªåˆ¥å£²ä¸Š:")
print(category_analysis)

print("\nğŸ¯ å…¨ã¦ã®èª²é¡Œã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼")
```

---

## Week 5: æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®åŸºæœ¬æ“ä½œ

### ğŸ¯ **ã“ã®é€±ã®ã‚´ãƒ¼ãƒ«**

- datetime å‹ã®æ“ä½œã‚’ãƒã‚¹ã‚¿ãƒ¼ã™ã‚‹
- æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®åŸºæœ¬çš„ãªåˆ†æãŒã§ãã‚‹
- æ—¥ä»˜ãƒ»æ™‚é–“ã‚’ä½¿ã£ãŸãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’ç¿’å¾—ã™ã‚‹

---

### **Day 1-7: æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®æ“ä½œ**

```python
print("ğŸ“… Week 5: æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®åŸºæœ¬æ“ä½œ")
print("=" * 50)

import pandas as pd
import numpy as np
from datetime import datetime, timedelta
import matplotlib.pyplot as plt

print("1. datetimeå‹ã®åŸºæœ¬")
print("=" * 30)

# æ§˜ã€…ãªæ—¥ä»˜ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ
date_strings = [
    "2024-01-01",
    "01/15/2024",
    "2024å¹´2æœˆ20æ—¥",
    "March 15, 2024",
    "2024-04-01 14:30:00"
]

print("ğŸ“… æ§˜ã€…ãªæ—¥ä»˜å½¢å¼:")
for date_str in date_strings[:4]:  # æ—¥æœ¬èªã¯é™¤ã
    try:
        converted = pd.to_datetime(date_str)
        print(f"{date_str} â†’ {converted}")
    except:
        print(f"{date_str} â†’ å¤‰æ›å¤±æ•—")

# æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ
print("\nğŸ“Š æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ:")

# æ—¥ä»˜ç¯„å›²ã®ç”Ÿæˆ
date_range = pd.date_range(start='2024-01-01', end='2024-12-31', freq='D')
print(f"2024å¹´ã®æ—¥ä»˜ç¯„å›²: {len(date_range)}æ—¥")

# ãƒ“ã‚¸ãƒã‚¹æ—¥ï¼ˆå¹³æ—¥ã®ã¿ï¼‰
business_days = pd.date_range(start='2024-01-01', end='2024-12-31', freq='B')
print(f"2024å¹´ã®å–¶æ¥­æ—¥: {len(business_days)}æ—¥")

# æœˆæœ«æ—¥
month_ends = pd.date_range(start='2024-01-01', end='2024-12-31', freq='M')
print(f"æœˆæœ«æ—¥: {len(month_ends)}æ—¥")

# ã‚µãƒ³ãƒ—ãƒ«æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ
np.random.seed(42)
time_series_data = {
    "æ—¥ä»˜": pd.date_range('2024-01-01', periods=365, freq='D'),
    "å£²ä¸Š": np.random.normal(100000, 20000, 365),
    "é¡§å®¢æ•°": np.random.poisson(50, 365),
    "æ°—æ¸©": 15 + 10 * np.sin(2 * np.pi * np.arange(365) / 365) + np.random.normal(0, 3, 365)
}

# å£²ä¸Šã«å­£ç¯€æ€§ã‚’è¿½åŠ 
for i, date in enumerate(time_series_data["æ—¥ä»˜"]):
    # 12æœˆã¯å£²ä¸ŠUP
    if date.month == 12:
        time_series_data["å£²ä¸Š"][i] *= 1.5
    # é€±æœ«åŠ¹æœ
    if date.weekday() >= 5:
        time_series_data["å£²ä¸Š"][i] *= 1.2

ts_df = pd.DataFrame(time_series_data)
ts_df.set_index('æ—¥ä»˜', inplace=True)

print("\nğŸ” æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã‚µãƒ³ãƒ—ãƒ«:")
print(ts_df.head())

print("\n2. æ—¥ä»˜ãƒ»æ™‚é–“ã®æƒ…å ±æŠ½å‡º")
print("=" * 30)

# æ—¥ä»˜ã‹ã‚‰æƒ…å ±ã‚’æŠ½å‡º
ts_df['å¹´'] = ts_df.index.year
ts_df['æœˆ'] = ts_df.index.month
ts_df['æ—¥'] = ts_df.index.day
ts_df['æ›œæ—¥ç•ªå·'] = ts_df.index.weekday  # 0=æœˆæ›œæ—¥
ts_df['æ›œæ—¥å'] = ts_df.index.day_name()
ts_df['å››åŠæœŸ'] = ts_df.index.quarter
ts_df['å¹´é–“é€šç®—æ—¥'] = ts_df.index.dayofyear
ts_df['é€±ç•ªå·'] = ts_df.index.isocalendar().week

print("ğŸ“‹ æ—¥ä»˜æƒ…å ±ã®æŠ½å‡º:")
print(ts_df[['å£²ä¸Š', 'å¹´', 'æœˆ', 'æ›œæ—¥å', 'å››åŠæœŸ']].head(10))

# å¹³æ—¥ãƒ»é€±æœ«ã®åˆ¤å®š
ts_df['å¹³æ—¥ãƒ•ãƒ©ã‚°'] = ts_df.index.weekday < 5
ts_df['é€±æœ«ãƒ•ãƒ©ã‚°'] = ts_df.index.weekday >= 5

print(f"\nå¹³æ—¥: {ts_df['å¹³æ—¥ãƒ•ãƒ©ã‚°'].sum()}æ—¥")
print(f"é€±æœ«: {ts_df['é€±æœ«ãƒ•ãƒ©ã‚°'].sum()}æ—¥")

print("\n3. æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®é¸æŠãƒ»æŠ½å‡º")
print("=" * 30)

# ç‰¹å®šã®æœˆã®ãƒ‡ãƒ¼ã‚¿
january_data = ts_df[ts_df.index.month == 1]
print(f"1æœˆã®ãƒ‡ãƒ¼ã‚¿: {len(january_data)}æ—¥")
print("1æœˆã®å¹³å‡å£²ä¸Š:", january_data['å£²ä¸Š'].mean())

# ç‰¹å®šã®æœŸé–“
q1_data = ts_df['2024-01-01':'2024-03-31']
print(f"\nç¬¬1å››åŠæœŸ: {len(q1_data)}æ—¥")

# è¤‡æ•°æ¡ä»¶
summer_weekends = ts_df[
    (ts_df.index.month.isin([6, 7, 8])) &
    (ts_df['é€±æœ«ãƒ•ãƒ©ã‚°'] == True)
]
print(f"å¤ã®é€±æœ«: {len(summer_weekends)}æ—¥")

# æ–‡å­—åˆ—ã«ã‚ˆã‚‹æœŸé–“æŒ‡å®š
july_data = ts_df.loc['2024-07']
print(f"\n7æœˆã®ãƒ‡ãƒ¼ã‚¿: {len(july_data)}æ—¥")

print("\n4. æ™‚ç³»åˆ—é›†è¨ˆ")
print("=" * 30)

# æœˆåˆ¥é›†è¨ˆ
monthly_summary = ts_df.groupby(ts_df.index.to_period('M')).agg({
    'å£²ä¸Š': ['sum', 'mean'],
    'é¡§å®¢æ•°': 'sum',
    'æ°—æ¸©': 'mean'
})
monthly_summary.columns = ['æœˆé–“å£²ä¸Š', 'å¹³å‡æ—¥å£²ä¸Š', 'æœˆé–“é¡§å®¢æ•°', 'å¹³å‡æ°—æ¸©']
print("æœˆåˆ¥ã‚µãƒãƒªãƒ¼:")
print(monthly_summary.head())

# æ›œæ—¥åˆ¥ãƒ‘ã‚¿ãƒ¼ãƒ³
weekday_pattern = ts_df.groupby('æ›œæ—¥å')['å£²ä¸Š'].mean()
# æ›œæ—¥é †ã«ä¸¦ã³æ›¿ãˆ
weekday_order = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']
weekday_pattern = weekday_pattern.reindex(weekday_order)
weekday_pattern.index = ['æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ', 'æ—¥']

print("\nğŸ“… æ›œæ—¥åˆ¥å¹³å‡å£²ä¸Š:")
print(weekday_pattern.round(0))

# å››åŠæœŸåˆ¥é›†è¨ˆ
quarterly_summary = ts_df.groupby('å››åŠæœŸ').agg({
    'å£²ä¸Š': ['sum', 'mean'],
    'é¡§å®¢æ•°': 'sum',
    'æ°—æ¸©': 'mean'
})
quarterly_summary.columns = ['å››åŠæœŸå£²ä¸Š', 'å¹³å‡æ—¥å£²ä¸Š', 'å››åŠæœŸé¡§å®¢æ•°', 'å¹³å‡æ°—æ¸©']
print("å››åŠæœŸåˆ¥ã‚µãƒãƒªãƒ¼:")
print(quarterly_summary.round(0))

# é€±åˆ¥é›†è¨ˆ
weekly_summary = ts_df.groupby('é€±ç•ªå·')['å£²ä¸Š'].sum()
print(f"\né€±åˆ¥å£²ä¸Šï¼ˆæœ€åˆã®5é€±ï¼‰:")
print(weekly_summary.head())

print("\n5. ç§»å‹•å¹³å‡ã¨ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ")
print("=" * 30)

# ç§»å‹•å¹³å‡ã®è¨ˆç®—
ts_df['å£²ä¸Š_7æ—¥ç§»å‹•å¹³å‡'] = ts_df['å£²ä¸Š'].rolling(window=7).mean()
ts_df['å£²ä¸Š_30æ—¥ç§»å‹•å¹³å‡'] = ts_df['å£²ä¸Š'].rolling(window=30).mean()

# æŒ‡æ•°å¹³æ»‘ç§»å‹•å¹³å‡
ts_df['å£²ä¸Š_æŒ‡æ•°å¹³æ»‘'] = ts_df['å£²ä¸Š'].ewm(span=7).mean()

print("ğŸ“ˆ ç§»å‹•å¹³å‡ãƒ‡ãƒ¼ã‚¿:")
print(ts_df[['å£²ä¸Š', 'å£²ä¸Š_7æ—¥ç§»å‹•å¹³å‡', 'å£²ä¸Š_30æ—¥ç§»å‹•å¹³å‡']].head(10).round(0))

# å‰æ—¥æ¯”ã€å‰å¹´åŒæœˆæ¯”
ts_df['å‰æ—¥æ¯”'] = ts_df['å£²ä¸Š'].pct_change() * 100
ts_df['å‰é€±åŒæ›œæ—¥æ¯”'] = ts_df['å£²ä¸Š'].pct_change(periods=7) * 100

print("\nğŸ“Š å¤‰åŒ–ç‡åˆ†æ:")
print(ts_df[['å£²ä¸Š', 'å‰æ—¥æ¯”', 'å‰é€±åŒæ›œæ—¥æ¯”']].head(14).round(2))

print("\n6. å­£ç¯€æ€§åˆ†æ")
print("=" * 30)

# æœˆåˆ¥ã®å­£ç¯€æ€§
seasonal_analysis = ts_df.groupby('æœˆ').agg({
    'å£²ä¸Š': ['mean', 'std'],
    'é¡§å®¢æ•°': 'mean'
})
seasonal_analysis.columns = ['å¹³å‡å£²ä¸Š', 'å£²ä¸Šæ¨™æº–åå·®', 'å¹³å‡é¡§å®¢æ•°']

# å…¨ä½“å¹³å‡ã¨ã®æ¯”è¼ƒ
overall_avg = ts_df['å£²ä¸Š'].mean()
seasonal_analysis['å­£ç¯€æŒ‡æ•°'] = seasonal_analysis['å¹³å‡å£²ä¸Š'] / overall_avg

print("ğŸŒ¸ æœˆåˆ¥å­£ç¯€æ€§:")
print(seasonal_analysis.round(2))

# æ›œæ—¥åŠ¹æœã®åˆ†æ
weekday_effect = ts_df.groupby('æ›œæ—¥ç•ªå·').agg({
    'å£²ä¸Š': 'mean',
    'é¡§å®¢æ•°': 'mean'
})
weekday_effect.index = ['æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ', 'æ—¥']

# å¹³æ—¥å¹³å‡ã¨ã®æ¯”è¼ƒ
weekday_avg = ts_df[ts_df['å¹³æ—¥ãƒ•ãƒ©ã‚°']]['å£²ä¸Š'].mean()
weekday_effect['å¹³æ—¥æ¯”'] = weekday_effect['å£²ä¸Š'] / weekday_avg

print("\nğŸ“… æ›œæ—¥åŠ¹æœ:")
print(weekday_effect.round(2))

print("\n7. æ¬ æå€¤ã®æ™‚ç³»åˆ—è£œé–“")
print("=" * 30)

# æ„å›³çš„ã«æ¬ æå€¤ã‚’ä½œæˆ
ts_sample = ts_df['å£²ä¸Š'].copy()
missing_dates = pd.date_range('2024-02-10', '2024-02-15')
ts_sample.loc[missing_dates] = np.nan

print("ğŸ“‹ æ¬ æå€¤ã®ã‚ã‚‹æ™‚ç³»åˆ—:")
print(ts_sample['2024-02-08':'2024-02-18'])

# æ§˜ã€…ãªè£œé–“æ–¹æ³•
interpolated_data = pd.DataFrame({
    'å…ƒãƒ‡ãƒ¼ã‚¿': ts_sample,
    'ç·šå½¢è£œé–“': ts_sample.interpolate(method='linear'),
    'æ™‚é–“é‡ã¿è£œé–“': ts_sample.interpolate(method='time'),
    'å‰æ–¹åŸ‹ã‚': ts_sample.fillna(method='ffill'),
    'å¾Œæ–¹åŸ‹ã‚': ts_sample.fillna(method='bfill')
})

print("\nğŸ”§ å„ç¨®è£œé–“çµæœ:")
print(interpolated_data['2024-02-08':'2024-02-18'].round(0))

print("\n8. ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°")
print("=" * 30)

# é€±æ¬¡ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
weekly_resample = ts_df['å£²ä¸Š'].resample('W').agg(['sum', 'mean', 'std'])
weekly_resample.columns = ['é€±é–“å£²ä¸Š', 'é€±å¹³å‡', 'é€±æ¨™æº–åå·®']
print("ğŸ“Š é€±æ¬¡ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°:")
print(weekly_resample.head().round(0))

# æœˆæ¬¡ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
monthly_resample = ts_df.resample('M').agg({
    'å£²ä¸Š': ['sum', 'mean'],
    'é¡§å®¢æ•°': 'sum',
    'æ°—æ¸©': 'mean'
})
monthly_resample.columns = ['æœˆé–“å£²ä¸Š', 'æ—¥å¹³å‡å£²ä¸Š', 'æœˆé–“é¡§å®¢æ•°', 'å¹³å‡æ°—æ¸©']
print("\nğŸ“… æœˆæ¬¡ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°:")
print(monthly_resample.head().round(0))

# ã‚«ã‚¹ã‚¿ãƒ ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ï¼ˆå››åŠæœŸã®æœ€åˆã®æœˆï¼‰
quarterly_first = ts_df['å£²ä¸Š'].resample('QS').sum()
print("\nğŸ“ˆ å››åŠæœŸåˆæœˆå£²ä¸Š:")
print(quarterly_first)

print("\n9. æ™‚å·®ã¨ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³")
print("=" * 30)

# ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ä»˜ããƒ‡ãƒ¼ã‚¿
tz_data = pd.date_range('2024-01-01 09:00', periods=24, freq='H', tz='Asia/Tokyo')
sales_hourly = pd.DataFrame({
    'æ™‚åˆ»': tz_data,
    'å£²ä¸Š': np.random.normal(10000, 2000, 24)
})

print("ğŸŒ ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ä»˜ããƒ‡ãƒ¼ã‚¿:")
print(sales_hourly.head())

# ç•°ãªã‚‹ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã«å¤‰æ›
sales_hourly['NYæ™‚åˆ»'] = sales_hourly['æ™‚åˆ»'].dt.tz_convert('America/New_York')
sales_hourly['UTCæ™‚åˆ»'] = sales_hourly['æ™‚åˆ»'].dt.tz_convert('UTC')

print("\nğŸŒ ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å¤‰æ›:")
print(sales_hourly[['æ™‚åˆ»', 'NYæ™‚åˆ»', 'UTCæ™‚åˆ»']].head(3))

print("\n10. å–¶æ¥­æ—¥è¨ˆç®—")
print("=" * 30)

# å–¶æ¥­æ—¥ã®åˆ¤å®šï¼ˆåœŸæ—¥ç¥æ—¥ã‚’é™¤ãï¼‰
import pandas.tseries.offsets as offsets

# ã‚«ã‚¹ã‚¿ãƒ å–¶æ¥­æ—¥ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ï¼ˆæ—¥æœ¬ã®ç¥æ—¥ã¯ç°¡ç•¥åŒ–ï¼‰
holidays = ['2024-01-01', '2024-02-11', '2024-04-29', '2024-05-03', '2024-05-04', '2024-05-05']
holiday_dates = pd.to_datetime(holidays)

ts_df['å–¶æ¥­æ—¥ãƒ•ãƒ©ã‚°'] = (
    (ts_df.index.weekday < 5) &  # å¹³æ—¥
    (~ts_df.index.isin(holiday_dates))  # ç¥æ—¥ä»¥å¤–
)

business_days_count = ts_df['å–¶æ¥­æ—¥ãƒ•ãƒ©ã‚°'].sum()
print(f"2024å¹´ã®å–¶æ¥­æ—¥æ•°: {business_days_count}æ—¥")

# å–¶æ¥­æ—¥ã®ã¿ã®å£²ä¸Šåˆ†æ
business_only = ts_df[ts_df['å–¶æ¥­æ—¥ãƒ•ãƒ©ã‚°']]
print(f"å–¶æ¥­æ—¥å¹³å‡å£²ä¸Š: {business_only['å£²ä¸Š'].mean():,.0f}å††")
print(f"ä¼‘æ—¥å¹³å‡å£²ä¸Š: {ts_df[~ts_df['å–¶æ¥­æ—¥ãƒ•ãƒ©ã‚°']]['å£²ä¸Š'].mean():,.0f}å††")
```

**ğŸ›  Week 5 ã®å®Ÿç¿’èª²é¡Œ**

```python
print("\nğŸ“ Week 5 å®Ÿç¿’èª²é¡Œ")
print("=" * 50)

print("ğŸ“Š ECã‚µã‚¤ãƒˆã®æ™‚ç³»åˆ—å£²ä¸Šåˆ†æ")

# å®Ÿéš›çš„ãªæ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
np.random.seed(42)
ecommerce_data = []

for i in range(365):
    date = pd.Timestamp('2024-01-01') + pd.Timedelta(days=i)

    # åŸºæœ¬å£²ä¸Šï¼ˆå­£ç¯€æ€§ã‚’å«ã‚€ï¼‰
    base_sales = 50000 + 20000 * np.sin(2 * np.pi * i / 365)

    # æ›œæ—¥åŠ¹æœ
    if date.weekday() == 5:  # åœŸæ›œæ—¥
        base_sales *= 1.3
    elif date.weekday() == 6:  # æ—¥æ›œæ—¥
        base_sales *= 1.1
    elif date.weekday() < 5:  # å¹³æ—¥
        base_sales *= 0.9

    # ç‰¹åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆåŠ¹æœ
    if date.month == 12:  # 12æœˆï¼ˆå¹´æœ«å•†æˆ¦ï¼‰
        base_sales *= 1.8
    elif date.month in [3, 7]:  # 3æœˆã€7æœˆï¼ˆã‚»ãƒ¼ãƒ«æœˆï¼‰
        base_sales *= 1.4

    # ãƒ©ãƒ³ãƒ€ãƒ ãƒã‚¤ã‚º
    base_sales += np.random.normal(0, 5000)

    ecommerce_data.append({
        'æ—¥ä»˜': date,
        'å£²ä¸Š': max(0, base_sales),
        'æ³¨æ–‡æ•°': np.random.poisson(base_sales / 5000),
        'æ–°è¦é¡§å®¢': np.random.poisson(10),
        'ãƒšãƒ¼ã‚¸ãƒ“ãƒ¥ãƒ¼': np.random.poisson(base_sales / 100)
    })

ecommerce_df = pd.DataFrame(ecommerce_data)
ecommerce_df.set_index('æ—¥ä»˜', inplace=True)

print("ğŸ›’ ECã‚µã‚¤ãƒˆå£²ä¸Šãƒ‡ãƒ¼ã‚¿:")
print(ecommerce_df.head())

print("""
ğŸ“‹ åˆ†æèª²é¡Œ:

ã€åŸºæœ¬åˆ†æã€‘
1. æœˆåˆ¥å£²ä¸Šæ¨ç§»ã®åˆ†æ
   - æœˆåˆ¥å£²ä¸Šåˆè¨ˆã¨ã‚°ãƒ©ãƒ•åŒ–
   - å‰æœˆæ¯”æˆé•·ç‡ã®è¨ˆç®—
   - å­£ç¯€æŒ‡æ•°ã®ç®—å‡º

2. æ›œæ—¥åˆ¥ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ
   - æ›œæ—¥åˆ¥å¹³å‡å£²ä¸Š
   - å¹³æ—¥ vs é€±æœ«ã®æ¯”è¼ƒ
   - æœ€ã‚‚å£²ä¸Šã®é«˜ã„æ›œæ—¥ã®ç‰¹å®š

3. ç§»å‹•å¹³å‡åˆ†æ
   - 7æ—¥ç§»å‹•å¹³å‡ã§çŸ­æœŸãƒˆãƒ¬ãƒ³ãƒ‰æŠŠæ¡
   - 30æ—¥ç§»å‹•å¹³å‡ã§ä¸­æœŸãƒˆãƒ¬ãƒ³ãƒ‰æŠŠæ¡
   - ãƒˆãƒ¬ãƒ³ãƒ‰ã®å¤‰åŒ–ç‚¹ã®ç‰¹å®š

ã€å¿œç”¨åˆ†æã€‘
4. å­£ç¯€æ€§åˆ†è§£
   - ãƒˆãƒ¬ãƒ³ãƒ‰ã€å­£ç¯€æ€§ã€ãƒã‚¤ã‚ºã®åˆ†é›¢
   - å¹´é–“å£²ä¸Šã‚µã‚¤ã‚¯ãƒ«ã®ç†è§£
   - ç•°å¸¸å€¤ã®æ¤œå‡º

5. æˆé•·ç‡åˆ†æ
   - å‰å¹´åŒæœˆæ¯”ã®è¨ˆç®—ï¼ˆä»®æƒ³ï¼‰
   - é€±æ¬¡æˆé•·ç‡ã®æ¨ç§»
   - å››åŠæœŸåˆ¥æˆé•·ç‡

6. ç›¸é–¢åˆ†æ
   - å£²ä¸Šã¨æ³¨æ–‡æ•°ã®é–¢ä¿‚
   - ãƒšãƒ¼ã‚¸ãƒ“ãƒ¥ãƒ¼ã¨å£²ä¸Šã®é–¢ä¿‚
   - æ–°è¦é¡§å®¢ã¨å£²ä¸Šã®é–¢ä¿‚

ã€å®Ÿè·µåˆ†æã€‘
7. å£²ä¸Šäºˆæ¸¬ã®åŸºç¤
   - éå»30æ—¥ã®å¹³å‡ã‹ã‚‰ç¿Œæ—¥äºˆæ¸¬
   - åŒæ›œæ—¥ã®å¹³å‡ã‹ã‚‰äºˆæ¸¬
   - ç§»å‹•å¹³å‡ãƒ™ãƒ¼ã‚¹ã®äºˆæ¸¬

8. ãƒ“ã‚¸ãƒã‚¹æŒ‡æ¨™ã®è¨ˆç®—
   - å¹³å‡æ³¨æ–‡å˜ä¾¡ï¼ˆAOVï¼‰ã®æ¨ç§»
   - ã‚³ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç‡ã®æ¨ç§»
   - é¡§å®¢å½“ãŸã‚Šå£²ä¸Šã®æ¨ç§»

9. ç•°å¸¸æ¤œçŸ¥
   - å£²ä¸Šã®ç•°å¸¸ã«é«˜ã„/ä½ã„æ—¥ã®ç‰¹å®š
   - ç§»å‹•å¹³å‡ã‹ã‚‰ã®ä¹–é›¢åˆ†æ
   - çµ±è¨ˆçš„ç•°å¸¸å€¤ã®æ¤œå‡º
""")

print("\nğŸ’¡ è§£ç­”ä¾‹ï¼ˆä¸€éƒ¨ï¼‰:")

# 1. æœˆåˆ¥å£²ä¸Šåˆ†æ
monthly_sales = ecommerce_df.groupby(ecommerce_df.index.to_period('M')).agg({
    'å£²ä¸Š': ['sum', 'mean'],
    'æ³¨æ–‡æ•°': 'sum'
})
monthly_sales.columns = ['æœˆé–“å£²ä¸Š', 'æ—¥å¹³å‡å£²ä¸Š', 'æœˆé–“æ³¨æ–‡æ•°']
monthly_sales['å‰æœˆæ¯”'] = monthly_sales['æœˆé–“å£²ä¸Š'].pct_change() * 100

print("ğŸ“ˆ æœˆåˆ¥å£²ä¸Šåˆ†æ:")
print(monthly_sales.round(2))

# 2. æ›œæ—¥åˆ¥åˆ†æ
weekday_analysis = ecommerce_df.groupby(ecommerce_df.index.dayofweek).agg({
    'å£²ä¸Š': 'mean',
    'æ³¨æ–‡æ•°': 'mean'
})
weekday_analysis.index = ['æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ', 'æ—¥']
weekday_analysis['å£²ä¸ŠæŒ‡æ•°'] = weekday_analysis['å£²ä¸Š'] / weekday_analysis['å£²ä¸Š'].mean()

print("\nğŸ“… æ›œæ—¥åˆ¥åˆ†æ:")
print(weekday_analysis.round(2))

# 3. ç§»å‹•å¹³å‡
ecommerce_df['å£²ä¸Š_7æ—¥MA'] = ecommerce_df['å£²ä¸Š'].rolling(7).mean()
ecommerce_df['å£²ä¸Š_30æ—¥MA'] = ecommerce_df['å£²ä¸Š'].rolling(30).mean()

print("\nğŸ“Š ç§»å‹•å¹³å‡ã‚µãƒ³ãƒ—ãƒ«:")
print(ecommerce_df[['å£²ä¸Š', 'å£²ä¸Š_7æ—¥MA', 'å£²ä¸Š_30æ—¥MA']].tail().round(0))

# 4. å¹³å‡æ³¨æ–‡å˜ä¾¡
ecommerce_df['AOV'] = ecommerce_df['å£²ä¸Š'] / ecommerce_df['æ³¨æ–‡æ•°']
monthly_aov = ecommerce_df.groupby(ecommerce_df.index.to_period('M'))['AOV'].mean()

print("\nğŸ’° æœˆåˆ¥å¹³å‡æ³¨æ–‡å˜ä¾¡:")
print(monthly_aov.round(0))

print("\nğŸ¯ å…¨ã¦ã®èª²é¡Œã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼")
```

---

## Week 6: å¯è¦–åŒ–ã¨å®Ÿè·µãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

### ğŸ¯ **ã“ã®é€±ã®ã‚´ãƒ¼ãƒ«**

- pandas ã§ã®åŸºæœ¬çš„ãªå¯è¦–åŒ–ã‚’ãƒã‚¹ã‚¿ãƒ¼ã™ã‚‹
- å®Ÿéš›ã®ãƒ“ã‚¸ãƒã‚¹èª²é¡Œã‚’è§£æ±ºã™ã‚‹
- ç·åˆçš„ãªãƒ‡ãƒ¼ã‚¿åˆ†æãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å®Œæˆã•ã›ã‚‹

---

### **Day 1-3: pandas ã§ã®å¯è¦–åŒ–**

```python
print("ğŸ“Š Week 6: å¯è¦–åŒ–ã¨å®Ÿè·µãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ")
print("=" * 50)

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆè¨­å®š
plt.rcParams['font.family'] = 'DejaVu Sans'
sns.set_style("whitegrid")

print("1. pandasã§ã®åŸºæœ¬çš„ãªå¯è¦–åŒ–")
print("=" * 30)

# å¯è¦–åŒ–ç”¨ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ä½œæˆ
np.random.seed(42)
visualization_data = {
    "æœˆ": [f"{i}æœˆ" for i in range(1, 13)],
    "å£²ä¸Š": [100, 120, 140, 135, 160, 180, 200, 190, 170, 150, 220, 250],
    "åˆ©ç›Š": [30, 36, 42, 40, 48, 54, 60, 57, 51, 45, 66, 75],
    "é¡§å®¢æ•°": [500, 600, 700, 675, 800, 900, 1000, 950, 850, 750, 1100, 1250]
}

viz_df = pd.DataFrame(visualization_data)
viz_df.set_index('æœˆ', inplace=True)

print("ğŸ“‹ å¯è¦–åŒ–ç”¨ãƒ‡ãƒ¼ã‚¿:")
print(viz_df)

# 1. ç·šã‚°ãƒ©ãƒ•
print("\nğŸ“ˆ ç·šã‚°ãƒ©ãƒ•:")
fig, axes = plt.subplots(2, 2, figsize=(12, 8))

# å£²ä¸Šæ¨ç§»
viz_df['å£²ä¸Š'].plot(kind='line', ax=axes[0,0], title='æœˆåˆ¥å£²ä¸Šæ¨ç§»', color='blue', marker='o')
axes[0,0].set_ylabel('å£²ä¸Šï¼ˆä¸‡å††ï¼‰')

# è¤‡æ•°ç³»åˆ—
viz_df[['å£²ä¸Š', 'åˆ©ç›Š']].plot(kind='line', ax=axes[0,1], title='å£²ä¸Šãƒ»åˆ©ç›Šæ¨ç§»', marker='o')
axes[0,1].set_ylabel('é‡‘é¡ï¼ˆä¸‡å††ï¼‰')

# æ£’ã‚°ãƒ©ãƒ•
viz_df['é¡§å®¢æ•°'].plot(kind='bar', ax=axes[1,0], title='æœˆåˆ¥é¡§å®¢æ•°', color='green')
axes[1,0].set_ylabel('é¡§å®¢æ•°ï¼ˆäººï¼‰')
axes[1,0].tick_params(axis='x', rotation=45)

# æ•£å¸ƒå›³
viz_df.plot(kind='scatter', x='å£²ä¸Š', y='åˆ©ç›Š', ax=axes[1,1], title='å£²ä¸Š vs åˆ©ç›Š', alpha=0.7)

plt.tight_layout()
plt.show()

print("\n2. æ§˜ã€…ãªã‚°ãƒ©ãƒ•ç¨®é¡")
print("=" * 30)

# ã‚«ãƒ†ã‚´ãƒªåˆ¥ãƒ‡ãƒ¼ã‚¿
category_data = {
    "å•†å“ã‚«ãƒ†ã‚´ãƒª": ["é›»å­æ©Ÿå™¨", "è¡£æ–™å“", "é£Ÿå“", "æ›¸ç±", "ã‚¹ãƒãƒ¼ãƒ„", "ç¾å®¹"],
    "å£²ä¸Š": [850, 620, 380, 240, 450, 310],
    "åˆ©ç›Šç‡": [25, 45, 15, 35, 30, 50]
}

cat_df = pd.DataFrame(category_data)
cat_df.set_index('å•†å“ã‚«ãƒ†ã‚´ãƒª', inplace=True)

fig, axes = plt.subplots(2, 3, figsize=(15, 8))

# æ£’ã‚°ãƒ©ãƒ•ï¼ˆå‚ç›´ï¼‰
cat_df['å£²ä¸Š'].plot(kind='bar', ax=axes[0,0], title='ã‚«ãƒ†ã‚´ãƒªåˆ¥å£²ä¸Š', color='skyblue')
axes[0,0].tick_params(axis='x', rotation=45)

# æ£’ã‚°ãƒ©ãƒ•ï¼ˆæ°´å¹³ï¼‰
cat_df['å£²ä¸Š'].plot(kind='barh', ax=axes[0,1], title='ã‚«ãƒ†ã‚´ãƒªåˆ¥å£²ä¸Šï¼ˆæ¨ªï¼‰', color='lightcoral')

# å††ã‚°ãƒ©ãƒ•
cat_df['å£²ä¸Š'].plot(kind='pie', ax=axes[0,2], title='å£²ä¸Šæ§‹æˆæ¯”', autopct='%1.1f%%')

# ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ 
sales_dist = np.random.normal(100, 20, 1000)
pd.Series(sales_dist).plot(kind='hist', ax=axes[1,0], title='å£²ä¸Šåˆ†å¸ƒ', bins=30, alpha=0.7)

# ç®±ã²ã’å›³
box_data = pd.DataFrame({
    'åº—èˆ—A': np.random.normal(100, 15, 100),
    'åº—èˆ—B': np.random.normal(120, 20, 100),
    'åº—èˆ—C': np.random.normal(90, 10, 100)
})
box_data.plot(kind='box', ax=axes[1,1], title='åº—èˆ—åˆ¥å£²ä¸Šåˆ†å¸ƒ')

# é¢ã‚°ãƒ©ãƒ•
viz_df[['å£²ä¸Š', 'åˆ©ç›Š']].plot(kind='area', ax=axes[1,2], title='ç´¯ç©å£²ä¸Šãƒ»åˆ©ç›Š', alpha=0.7)

plt.tight_layout()
plt.show()

print("\n3. é«˜åº¦ãªå¯è¦–åŒ–")
print("=" * 30)

# æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ–
time_data = pd.DataFrame({
    'æ—¥ä»˜': pd.date_range('2024-01-01', periods=365, freq='D'),
    'å£²ä¸Š': 50000 + 10000 * np.sin(2 * np.pi * np.arange(365) / 365) + np.random.normal(0, 5000, 365)
})
time_data.set_index('æ—¥ä»˜', inplace=True)

# ç§»å‹•å¹³å‡ã‚’è¿½åŠ 
time_data['MA7'] = time_data['å£²ä¸Š'].rolling(7).mean()
time_data['MA30'] = time_data['å£²ä¸Š'].rolling(30).mean()

fig, axes = plt.subplots(2, 2, figsize=(15, 10))

# æ™‚ç³»åˆ—ãƒ—ãƒ­ãƒƒãƒˆ
time_data[['å£²ä¸Š', 'MA7', 'MA30']].plot(ax=axes[0,0], title='å£²ä¸Šæ¨ç§»ã¨ç§»å‹•å¹³å‡')
axes[0,0].legend(['å£²ä¸Š', '7æ—¥ç§»å‹•å¹³å‡', '30æ—¥ç§»å‹•å¹³å‡'])

# æœˆåˆ¥é›†è¨ˆ
monthly_sum = time_data.groupby(time_data.index.to_period('M'))['å£²ä¸Š'].sum()
monthly_sum.plot(kind='bar', ax=axes[0,1], title='æœˆåˆ¥å£²ä¸Š')
axes[0,1].tick_params(axis='x', rotation=45)

# ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ç”¨ãƒ‡ãƒ¼ã‚¿
heatmap_data = time_data.copy()
heatmap_data['æœˆ'] = heatmap_data.index.month
heatmap_data['æ—¥'] = heatmap_data.index.day
pivot_data = heatmap_data.pivot_table(values='å£²ä¸Š', index='æœˆ', columns='æ—¥', fill_value=0)

# ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ï¼ˆç°¡æ˜“ç‰ˆï¼‰
im = axes[1,0].imshow(pivot_data.values, cmap='YlOrRd', aspect='auto')
axes[1,0].set_title('æœˆåˆ¥æ—¥åˆ¥å£²ä¸Šãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—')
axes[1,0].set_xlabel('æ—¥')
axes[1,0].set_ylabel('æœˆ')

# æ•£å¸ƒå›³ãƒãƒˆãƒªãƒƒã‚¯ã‚¹ï¼ˆç›¸é–¢ï¼‰
correlation_data = pd.DataFrame({
    'å£²ä¸Š': np.random.normal(100, 20, 100),
    'åºƒå‘Šè²»': np.random.normal(10, 3, 100),
    'æ°—æ¸©': np.random.normal(20, 5, 100)
})
correlation_data['å£²ä¸Š'] = correlation_data['å£²ä¸Š'] + 0.7 * correlation_data['åºƒå‘Šè²»'] + 0.3 * correlation_data['æ°—æ¸©']

correlation_data.plot(kind='scatter', x='åºƒå‘Šè²»', y='å£²ä¸Š', ax=axes[1,1], title='åºƒå‘Šè²» vs å£²ä¸Š')

plt.tight_layout()
plt.show()

print("\n4. ã‚°ãƒ©ãƒ•ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º")
print("=" * 30)

# è©³ç´°ãªã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºä¾‹
fig, ax = plt.subplots(figsize=(10, 6))

# ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ­ãƒƒãƒˆ
viz_df['å£²ä¸Š'].plot(kind='line', ax=ax, color='#2E86AB', linewidth=3, marker='o', markersize=8)

# ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
ax.set_title('2024å¹´æœˆåˆ¥å£²ä¸Šæ¨ç§»', fontsize=16, fontweight='bold', pad=20)
ax.set_xlabel('æœˆ', fontsize=12)
ax.set_ylabel('å£²ä¸Šï¼ˆä¸‡å††ï¼‰', fontsize=12)
ax.grid(True, alpha=0.3)
ax.set_facecolor('#F8F9FA')

# æ³¨é‡ˆè¿½åŠ 
max_idx = viz_df['å£²ä¸Š'].idxmax()
max_value = viz_df['å£²ä¸Š'].max()
ax.annotate(f'æœ€é«˜å£²ä¸Š: {max_value}ä¸‡å††',
           xy=(max_idx, max_value),
           xytext=(max_idx, max_value + 20),
           arrowprops=dict(arrowstyle='->', color='red'),
           fontsize=10, color='red')

plt.tight_layout()
plt.show()

print("âœ… å¯è¦–åŒ–ã®åŸºæœ¬ã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã¾ã—ãŸï¼")
```

### **Day 4-7: ç·åˆå®Ÿè·µãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**

```python
print("\nğŸ¯ ç·åˆå®Ÿè·µãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: ECã‚µã‚¤ãƒˆå£²ä¸Šåˆ†æ")
print("=" * 50)

print("ğŸ“‹ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦:")
print("""
ã‚ãªãŸã¯ECã‚µã‚¤ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒŠãƒªã‚¹ãƒˆã§ã™ã€‚
ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã€ãƒ“ã‚¸ãƒã‚¹æ”¹å–„æ¡ˆã‚’ææ¡ˆã—ã¦ãã ã•ã„ã€‚

ã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã€‘
1. å£²ä¸Šãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆ1å¹´åˆ†ï¼‰
2. å•†å“ãƒã‚¹ã‚¿
3. é¡§å®¢ãƒã‚¹ã‚¿
4. ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æƒ…å ±

ã€åˆ†æç›®æ¨™ã€‘
- å£²ä¸Šå‚¾å‘ã®æŠŠæ¡
- å•†å“ãƒ»é¡§å®¢ã‚»ã‚°ãƒ¡ãƒ³ãƒˆåˆ†æ
- å­£ç¯€æ€§ãƒ»ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ
- æ”¹å–„ææ¡ˆã®ç­–å®š
""")

# å®Ÿè·µçš„ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆä½œæˆ
np.random.seed(42)

# 1. å•†å“ãƒã‚¹ã‚¿
products = pd.DataFrame({
    "å•†å“ID": [f"P{i:03d}" for i in range(1, 51)],
    "å•†å“å": [f"å•†å“{i}" for i in range(1, 51)],
    "ã‚«ãƒ†ã‚´ãƒª": np.random.choice(['é›»å­æ©Ÿå™¨', 'ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³', 'æœ¬ãƒ»é›‘èªŒ', 'ã‚¹ãƒãƒ¼ãƒ„', 'ç¾å®¹ãƒ»å¥åº·'], 50),
    "ä¾¡æ ¼": np.random.uniform(1000, 50000, 50).round(0),
    "åŸä¾¡": lambda x: x * np.random.uniform(0.4, 0.7, 50)
})
products['åŸä¾¡'] = (products['ä¾¡æ ¼'] * np.random.uniform(0.4, 0.7, 50)).round(0)
products['åˆ©ç›Šç‡'] = ((products['ä¾¡æ ¼'] - products['åŸä¾¡']) / products['ä¾¡æ ¼'] * 100).round(1)

# 2. é¡§å®¢ãƒã‚¹ã‚¿
customers = pd.DataFrame({
    "é¡§å®¢ID": [f"C{i:04d}" for i in range(1, 501)],
    "å¹´é½¢": np.random.randint(18, 70, 500),
    "æ€§åˆ¥": np.random.choice(['ç”·æ€§', 'å¥³æ€§'], 500),
    "åœ°åŸŸ": np.random.choice(['é–¢æ±', 'é–¢è¥¿', 'ä¸­éƒ¨', 'ä¹å·', 'æ±åŒ—'], 500),
    "ä¼šå“¡ãƒ©ãƒ³ã‚¯": np.random.choice(['ãƒ–ãƒ­ãƒ³ã‚º', 'ã‚·ãƒ«ãƒãƒ¼', 'ã‚´ãƒ¼ãƒ«ãƒ‰', 'ãƒ—ãƒ©ãƒãƒŠ'], 500, p=[0.4, 0.3, 0.2, 0.1]),
    "ç™»éŒ²æ—¥": pd.to_datetime(np.random.choice(pd.date_range('2023-01-01', '2024-12-31'), 500))
})

# 3. å£²ä¸Šãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆ1å¹´åˆ†ï¼‰
transactions = []
for i in range(3000):
    transaction_date = pd.Timestamp('2024-01-01') + pd.Timedelta(days=np.random.randint(0, 365))
    customer_id = np.random.choice(customers['é¡§å®¢ID'])
    product_id = np.random.choice(products['å•†å“ID'])
    quantity = np.random.randint(1, 5)

    # ä¾¡æ ¼ã«å¤šå°‘ã®å¤‰å‹•ã‚’åŠ ãˆã‚‹
    base_price = products[products['å•†å“ID'] == product_id]['ä¾¡æ ¼'].iloc[0]
    actual_price = base_price * np.random.uniform(0.8, 1.2)

    transactions.append({
        "å–å¼•ID": f"T{i+1:05d}",
        "æ—¥ä»˜": transaction_date,
        "é¡§å®¢ID": customer_id,
        "å•†å“ID": product_id,
        "æ•°é‡": quantity,
        "å˜ä¾¡": actual_price,
        "å£²ä¸Š": actual_price * quantity
    })

sales_df = pd.DataFrame(transactions)

# 4. ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æƒ…å ±
campaigns = pd.DataFrame({
    "ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³å": ["æ–°æ˜¥ã‚»ãƒ¼ãƒ«", "æ˜¥ã®ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ç¥­", "å¤ã®ãƒœãƒ¼ãƒŠã‚¹ã‚»ãƒ¼ãƒ«", "ç§‹ã®èª­æ›¸ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³", "å¹´æœ«å¤§æ„Ÿè¬ç¥­"],
    "é–‹å§‹æ—¥": ["2024-01-01", "2024-03-01", "2024-07-01", "2024-09-01", "2024-12-01"],
    "çµ‚äº†æ—¥": ["2024-01-31", "2024-03-31", "2024-07-31", "2024-09-30", "2024-12-31"],
    "å¯¾è±¡ã‚«ãƒ†ã‚´ãƒª": ["å…¨å•†å“", "ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³", "å…¨å•†å“", "æœ¬ãƒ»é›‘èªŒ", "å…¨å•†å“"],
    "å‰²å¼•ç‡": [20, 30, 25, 15, 40]
})

print("\nğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæ¦‚è¦:")
print(f"å•†å“æ•°: {len(products)}")
print(f"é¡§å®¢æ•°: {len(customers)}")
print(f"å–å¼•æ•°: {len(sales_df)}")
print(f"ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æ•°: {len(campaigns)}")

print("\nğŸ” Step 1: ãƒ‡ãƒ¼ã‚¿ã®çµåˆã¨åŸºæœ¬çµ±è¨ˆ")
print("=" * 40)

# ãƒ‡ãƒ¼ã‚¿çµåˆ
sales_detail = sales_df.merge(products, on='å•†å“ID', how='left')
sales_detail = sales_detail.merge(customers, on='é¡§å®¢ID', how='left')

# åŸºæœ¬çµ±è¨ˆ
print("ğŸ“ˆ åŸºæœ¬çµ±è¨ˆ:")
print(f"ç·å£²ä¸Š: {sales_detail['å£²ä¸Š'].sum():,.0f}å††")
print(f"å¹³å‡æ³¨æ–‡å˜ä¾¡: {sales_detail['å£²ä¸Š'].mean():,.0f}å††")
print(f"å–å¼•æœŸé–“: {sales_detail['æ—¥ä»˜'].min().strftime('%Y-%m-%d')} ã€œ {sales_detail['æ—¥ä»˜'].max().strftime('%Y-%m-%d')}")

# æœˆåˆ¥å£²ä¸Š
monthly_sales = sales_detail.groupby(sales_detail['æ—¥ä»˜'].dt.to_period('M')).agg({
    'å£²ä¸Š': 'sum',
    'å–å¼•ID': 'count'
})
monthly_sales.columns = ['æœˆé–“å£²ä¸Š', 'å–å¼•æ•°']
monthly_sales['å¹³å‡æ³¨æ–‡å˜ä¾¡'] = monthly_sales['æœˆé–“å£²ä¸Š'] / monthly_sales['å–å¼•æ•°']

print("\nğŸ“… æœˆåˆ¥å£²ä¸Šã‚µãƒãƒªãƒ¼:")
print(monthly_sales.round(0))

print("\nğŸ” Step 2: å•†å“åˆ†æ")
print("=" * 40)

# å•†å“åˆ¥å£²ä¸Š
product_analysis = sales_detail.groupby(['å•†å“ID', 'å•†å“å', 'ã‚«ãƒ†ã‚´ãƒª']).agg({
    'å£²ä¸Š': 'sum',
    'æ•°é‡': 'sum',
    'å–å¼•ID': 'count'
}).round(0)
product_analysis.columns = ['ç·å£²ä¸Š', 'ç·è²©å£²æ•°', 'å–å¼•æ•°']
product_analysis = product_analysis.sort_values('ç·å£²ä¸Š', ascending=False)

print("ğŸ† å£²ä¸ŠTOP10å•†å“:")
print(product_analysis.head(10))

# ã‚«ãƒ†ã‚´ãƒªåˆ¥åˆ†æ
category_analysis = sales_detail.groupby('ã‚«ãƒ†ã‚´ãƒª').agg({
    'å£²ä¸Š': ['sum', 'mean'],
    'å–å¼•ID': 'count'
})
category_analysis.columns = ['ç·å£²ä¸Š', 'å¹³å‡å£²ä¸Š', 'å–å¼•æ•°']
category_analysis['å£²ä¸Šæ§‹æˆæ¯”'] = (category_analysis['ç·å£²ä¸Š'] / category_analysis['ç·å£²ä¸Š'].sum() * 100).round(1)

print("\nğŸ“Š ã‚«ãƒ†ã‚´ãƒªåˆ¥åˆ†æ:")
print(category_analysis.sort_values('ç·å£²ä¸Š', ascending=False))

print("\nğŸ” Step 3: é¡§å®¢åˆ†æ")
print("=" * 40)

# é¡§å®¢åˆ¥å£²ä¸Š
customer_analysis = sales_detail.groupby(['é¡§å®¢ID', 'å¹´é½¢', 'æ€§åˆ¥', 'ä¼šå“¡ãƒ©ãƒ³ã‚¯']).agg({
    'å£²ä¸Š': 'sum',
    'å–å¼•ID': 'count'
})
customer_analysis.columns = ['ç·è³¼å…¥é¡', 'è³¼å…¥å›æ•°']
customer_analysis['å¹³å‡è³¼å…¥é¡'] = customer_analysis['ç·è³¼å…¥é¡'] / customer_analysis['è³¼å…¥å›æ•°']

# é¡§å®¢ã‚»ã‚°ãƒ¡ãƒ³ãƒˆåˆ†æ
print("ğŸ‘¥ ä¼šå“¡ãƒ©ãƒ³ã‚¯åˆ¥åˆ†æ:")
rank_analysis = customer_analysis.groupby('ä¼šå“¡ãƒ©ãƒ³ã‚¯').agg({
    'ç·è³¼å…¥é¡': ['mean', 'sum'],
    'è³¼å…¥å›æ•°': 'mean'
})
rank_analysis.columns = ['å¹³å‡è³¼å…¥é¡', 'ç·å£²ä¸Š', 'å¹³å‡è³¼å…¥å›æ•°']
print(rank_analysis.round(0))

print("\nğŸ‘« æ€§åˆ¥ãƒ»å¹´é½¢å±¤åˆ¥åˆ†æ:")
# å¹´é½¢å±¤ã®ä½œæˆ
customer_analysis['å¹´é½¢å±¤'] = pd.cut(customer_analysis['å¹´é½¢'],
                                bins=[0, 30, 40, 50, 100],
                                labels=['20ä»£', '30ä»£', '40ä»£', '50ä»£ä»¥ä¸Š'])

age_gender_analysis = customer_analysis.groupby(['æ€§åˆ¥', 'å¹´é½¢å±¤'])['ç·è³¼å…¥é¡'].agg(['count', 'mean', 'sum'])
age_gender_analysis.columns = ['é¡§å®¢æ•°', 'å¹³å‡è³¼å…¥é¡', 'ç·å£²ä¸Š']
print(age_gender_analysis.round(0))

print("\nğŸ” Step 4: æ™‚ç³»åˆ—åˆ†æ")
print("=" * 40)

# æ—¥åˆ¥å£²ä¸Š
daily_sales = sales_detail.groupby('æ—¥ä»˜')['å£²ä¸Š'].sum()

# æ›œæ—¥åˆ¥ãƒ‘ã‚¿ãƒ¼ãƒ³
sales_detail['æ›œæ—¥'] = sales_detail['æ—¥ä»˜'].dt.day_name()
weekday_pattern = sales_detail.groupby('æ›œæ—¥')['å£²ä¸Š'].mean()
weekday_order = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']
weekday_pattern = weekday_pattern.reindex(weekday_order)
weekday_pattern.index = ['æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ', 'æ—¥']

print("ğŸ“… æ›œæ—¥åˆ¥å£²ä¸Šãƒ‘ã‚¿ãƒ¼ãƒ³:")
print(weekday_pattern.round(0))

# å­£ç¯€æ€§åˆ†æ
sales_detail['æœˆ'] = sales_detail['æ—¥ä»˜'].dt.month
seasonal_analysis = sales_detail.groupby('æœˆ')['å£²ä¸Š'].sum()
seasonal_analysis.index = [f"{i}æœˆ" for i in seasonal_analysis.index]

print("\nğŸŒ¸ æœˆåˆ¥å£²ä¸Šï¼ˆå­£ç¯€æ€§ï¼‰:")
print(seasonal_analysis)

print("\nğŸ” Step 5: æ”¹å–„ææ¡ˆ")
print("=" * 40)

print("ğŸ’¡ åˆ†æçµæœã«åŸºã¥ãæ”¹å–„ææ¡ˆ:")
print("""
ã€å£²ä¸Šå‘ä¸Šæ–½ç­–ã€‘
1. é«˜åç›Šå•†å“ã®è²©ä¿ƒå¼·åŒ–
   - åˆ©ç›Šç‡ã®é«˜ã„å•†å“ã‚’å„ªå…ˆçš„ã«ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³
   - å£²ä¸ŠTOP10å•†å“ã®ã‚¯ãƒ­ã‚¹ã‚»ãƒ«æ–½ç­–

2. é¡§å®¢ã‚»ã‚°ãƒ¡ãƒ³ãƒˆåˆ¥ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
   - ãƒ—ãƒ©ãƒãƒŠä¼šå“¡å‘ã‘é™å®šå•†å“ã®é–‹ç™º
   - 20-30ä»£å¥³æ€§å‘ã‘ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ã‚«ãƒ†ã‚´ãƒªå¼·åŒ–

3. å­£ç¯€æ€§ã‚’æ´»ã‹ã—ãŸå•†å“å±•é–‹
   - 12æœˆã®å¹´æœ«éœ€è¦ã«å‚™ãˆãŸåœ¨åº«èª¿æ•´
   - æ˜¥ãƒ»å¤ã®ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æ™‚æœŸæœ€é©åŒ–

ã€åç›Šæ€§æ”¹å–„ã€‘
4. ä¾¡æ ¼æˆ¦ç•¥ã®è¦‹ç›´ã—
   - ä½åˆ©ç›Šç‡å•†å“ã®ä¾¡æ ¼èª¿æ•´
   - äººæ°—å•†å“ã®å€¤ä¸Šã’æ¤œè¨

5. åœ¨åº«ç®¡ç†æœ€é©åŒ–
   - å£²ã‚Œç­‹å•†å“ã®æ¬ å“é˜²æ­¢
   - å£²ã‚Œè¡Œãä¸è‰¯å•†å“ã®æ—©æœŸå‡¦åˆ†

ã€é¡§å®¢æº€è¶³åº¦å‘ä¸Šã€‘
6. ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³
   - é¡§å®¢ã®è³¼è²·å±¥æ­´ã«åŸºã¥ããƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰
   - ä¼šå“¡ãƒ©ãƒ³ã‚¯åˆ¥ã®ç‰¹å…¸å……å®Ÿ

7. åˆ©ä¾¿æ€§å‘ä¸Š
   - é€±æœ«ã®é…é€ä½“åˆ¶å¼·åŒ–
   - ãƒ¢ãƒã‚¤ãƒ«è³¼å…¥ä½“é¨“ã®æœ€é©åŒ–
""")

print("\nğŸ“Š åˆ†æå®Œäº†ï¼")
print("ğŸ¯ ã“ã®åˆ†æã‚’å‚è€ƒã«ã€ãƒ‡ãƒ¼ã‚¿ãƒ‰ãƒªãƒ–ãƒ³ãªæ„æ€æ±ºå®šã‚’è¡Œã„ã¾ã—ã‚‡ã†ï¼")
```

**ğŸ† æœ€çµ‚èª²é¡Œ: å®Œå…¨ã‚ªãƒªã‚¸ãƒŠãƒ«åˆ†æãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**

```python
print("\nğŸ“ å’æ¥­ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ")
print("=" * 50)

print("""
ğŸ¯ æœ€çµ‚èª²é¡Œ: ã‚ªãƒªã‚¸ãƒŠãƒ«åˆ†æãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

ã€èª²é¡Œå†…å®¹ã€‘
ã“ã‚Œã¾ã§å­¦ã‚“ã pandasã®ã‚¹ã‚­ãƒ«ã‚’ç·å‹•å“¡ã—ã¦ã€
ä»¥ä¸‹ã®ãƒ†ãƒ¼ãƒã‹ã‚‰1ã¤é¸ã‚“ã§å®Œå…¨ã‚ªãƒªã‚¸ãƒŠãƒ«ã®åˆ†æã‚’è¡Œã£ã¦ãã ã•ã„ã€‚

ã€ãƒ†ãƒ¼ãƒé¸æŠã€‘
A. æ¶ç©ºã®ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ãƒã‚§ãƒ¼ãƒ³ã®å£²ä¸Šåˆ†æ
B. ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å­¦ç¿’ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®å­¦ç¿’è€…è¡Œå‹•åˆ†æ
C. ä¸å‹•ç”£å¸‚å ´ã®ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ
D. ã‚¹ãƒãƒ¼ãƒ„ãƒãƒ¼ãƒ ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ
E. å®Œå…¨ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ†ãƒ¼ãƒ

ã€å¿…é ˆè¦ç´ ã€‘
âœ… ãƒ‡ãƒ¼ã‚¿ä½œæˆï¼ˆç¾å®Ÿçš„ãªå•é¡Œè¨­å®šï¼‰
âœ… ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ï¼ˆæ¬ æå€¤ãƒ»ç•°å¸¸å€¤å‡¦ç†ï¼‰
âœ… åŸºæœ¬çµ±è¨ˆã¨å¯è¦–åŒ–
âœ… groupby ã‚’ä½¿ã£ãŸé›†è¨ˆåˆ†æ
âœ… æ™‚ç³»åˆ—åˆ†æï¼ˆãƒˆãƒ¬ãƒ³ãƒ‰ãƒ»å­£ç¯€æ€§ï¼‰
âœ… ãƒ‡ãƒ¼ã‚¿çµåˆï¼ˆè¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
âœ… ãƒ“ã‚¸ãƒã‚¹æ”¹å–„ææ¡ˆ

ã€æå‡ºå½¢å¼ã€‘
- Jupyter Notebook ã¾ãŸã¯ Python ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
- åˆ†æçµæœã®ã‚µãƒãƒªãƒ¼ï¼ˆ1-2ãƒšãƒ¼ã‚¸ï¼‰
- æ”¹å–„ææ¡ˆï¼ˆå…·ä½“çš„ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³å«ã‚€ï¼‰

ã€è©•ä¾¡ãƒã‚¤ãƒ³ãƒˆã€‘
- pandasæ“ä½œã®æ­£ç¢ºæ€§ã¨åŠ¹ç‡æ€§
- åˆ†æã®æ·±ã•ã¨æ´å¯Ÿã®è³ª
- å¯è¦–åŒ–ã®åˆ†ã‹ã‚Šã‚„ã™ã•
- å®Ÿå‹™ã«æ´»ã‹ã›ã‚‹ææ¡ˆå†…å®¹
""")

print("\nğŸ’ª é ‘å¼µã£ã¦å–ã‚Šçµ„ã‚“ã§ãã ã•ã„ï¼")
print("è³ªå•ãŒã‚ã‚Œã°ã€ã“ã‚Œã¾ã§ã®Week 1-5ã®å†…å®¹ã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚")

print("\nğŸ‰ pandas DataFrame å®Œå…¨ãƒã‚¹ã‚¿ãƒ¼è¬›åº§ å®Œäº†ï¼")
print("=" * 50)
print("""
ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ğŸŠ

ã‚ãªãŸã¯ä»¥ä¸‹ã®ã‚¹ã‚­ãƒ«ã‚’èº«ã«ã¤ã‘ã¾ã—ãŸï¼š
âœ… DataFrameã®ä½œæˆã¨åŸºæœ¬æ“ä½œ
âœ… ãƒ‡ãƒ¼ã‚¿ã®é¸æŠãƒ»æŠ½å‡ºãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
âœ… ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã¨å¤‰æ›
âœ… groupby ã«ã‚ˆã‚‹é›†è¨ˆãƒ»åˆ†æ
âœ… æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®æ“ä½œ
âœ… ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–
âœ… å®Ÿè·µçš„ãªãƒ“ã‚¸ãƒã‚¹åˆ†æ

æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼š
ğŸš€ ã‚ˆã‚Šé«˜åº¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆscikit-learnã€plotlyç­‰ï¼‰ã®å­¦ç¿’
ğŸš€ æ©Ÿæ¢°å­¦ç¿’ã¸ã®æŒ‘æˆ¦
ğŸš€ å®Ÿéš›ã®ãƒ“ã‚¸ãƒã‚¹èª²é¡Œã¸ã®é©ç”¨

ç¶™ç¶šçš„ãªå­¦ç¿’ã¨å®Ÿè·µã§ã€ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆã¨ã—ã¦ã®ã‚¹ã‚­ãƒ«ã‚’
ã•ã‚‰ã«å‘ä¸Šã•ã›ã¦ã„ãã¾ã—ã‚‡ã†ï¼

Happy Pandas! ğŸ¼ğŸ“Š
""")
```

---

## ğŸ“š å‚è€ƒè³‡æ–™ã¨ Next Steps

### **è¿½åŠ å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹**

1. **å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**

   - [pandas Documentation](https://pandas.pydata.org/docs/)
   - [pandas Cheat Sheet](https://pandas.pydata.org/Pandas_Cheat_Sheet.pdf)

2. **å®Ÿè·µçš„ãªå­¦ç¿’**

   - Kaggle Learn ã® Pandas ã‚³ãƒ¼ã‚¹
   - å®Ÿéš›ã®ã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿ã§ã®ç·´ç¿’

3. **ç™ºå±•çš„ãªãƒˆãƒ”ãƒƒã‚¯**
   - pandas ã®æ€§èƒ½æœ€é©åŒ–
   - Dask ã§ã®å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿å‡¦ç†
   - pandas ã¨ SQL ã®é€£æº

### **ç¶™ç¶šçš„ãªæˆé•·ã®ãŸã‚ã«**

- **æ¯æ—¥ã®ç·´ç¿’**: å°ã•ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§æ¯æ—¥ç·´ç¿’
- **ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£å‚åŠ **: Stack Overflowã€pandas ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ**: å€‹äººãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã‚¹ã‚­ãƒ«å‘ä¸Š
- **æœ€æ–°æƒ…å ±**: pandas ã®æ–°æ©Ÿèƒ½ã‚„ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

**ğŸ“ˆ ãƒ‡ãƒ¼ã‚¿åˆ†æã®æ—…ã¯å§‹ã¾ã£ãŸã°ã‹ã‚Šã§ã™ï¼**
**ç¶™ç¶šçš„ãªå­¦ç¿’ã¨å®Ÿè·µã§ã€ã‚ˆã‚Šé«˜ã„ãƒ¬ãƒ™ãƒ«ã‚’ç›®æŒ‡ã—ã¾ã—ã‚‡ã†ï¼ ğŸ¯**
